{"version":3,"sources":["webpack:///webpack/bootstrap eb310abba3bc068fa889","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/server/app.js","webpack:///external \"react\"","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/pages/Base.jsx","webpack:///external \"immutable\"","webpack:///external \"react-redux\"","webpack:///external \"fs\"","webpack:///external \"react-immutable-proptypes\"","webpack:///external \"redux\"","webpack:///./server/config/config.json","webpack:///external \"express\"","webpack:///external \"react-router\"","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/App.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/actions/async.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/actions/todo.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/server/middlewares/renderReactMiddleware.jsx","webpack:///external \"ejs\"","webpack:///external \"events\"","webpack:///external \"isomorphic-fetch\"","webpack:///external \"react-dom/server\"","webpack:///external \"redux-immutablejs\"","webpack:///external \"redux-thunk\"","webpack:///external \"secure-filters\"","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/actions/vote.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/async/Picker.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/async/Posts.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/chat/ChangeNameForm.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/chat/Messages.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/chat/UsersList.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/common/Tab.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/todo/AddTodo.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/todo/Footer.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/todo/Todo.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/todo/TodoList.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/fetchList/serverFetch.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/pages/App/About.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/pages/App/App.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/pages/async/Page.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/pages/chat/Page.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/pages/todo/Todo.jsx","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/reducers/about.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/reducers/async.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/reducers/spaReducers.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/reducers/todo.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/reducers/vote.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/routes.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/store/index.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/store/spaStore.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/utils/connectDataFetchers.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/common/utils/shallowEqual.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/server/apis/index.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/server/controllers/async.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/server/controllers/chat.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/server/controllers/todo.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/server/middlewares/allowCrossDomain.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/server/middlewares/spaRenderMatch.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/server/routes/index.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/server/sockets/socket.js","webpack:///./D:/workspace/javascript/isomorphic-react-redux-starter/server/utils/preRender.js","webpack:///external \"body-parser\"","webpack:///external \"classnames\"","webpack:///external \"compression\"","webpack:///external \"cookie-parser\"","webpack:///external \"csurf\"","webpack:///external \"express-session\"","webpack:///external \"helmet\"","webpack:///external \"http\"","webpack:///external \"morgan\"","webpack:///external \"socket.io\""],"names":["app","set","IP","PORT","disable","use","contentSecurityPolicy","frameguard","noSniff","xssFilter","hsts","json","urlencoded","extended","resave","secret","key","saveUninitialized","cookie","httpOnly","static","__dirname","maxAge","req","res","next","locals","csrftoken","csrfToken","transformer","data","fromJS","err","console","dir","status","error","stack","render","message","process","on","reason","p","warn","server","createServer","io","require","listen","sockets","get","address","port","log","serverName","eventMatchReg","getEventMethodsProps","instance","methods","Object","getOwnPropertyNames","filter","prop","test","instancePrototype","getPrototypeOf","prototype","concat","Base","constructor","props","context","__eventNames","__bindFunctions","funcBinded","bind","eventName","fn","Error","push","$eventBus","addListener","emit","args","off","events","index","indexOf","removeListener","splice","length","_reactInternalInstance","getName","name","shouldComponentUpdate","nextProps","nextState","shouldUpdate","state","componentWillUnmount","hasOwnProperty","contextTypes","instanceOf","mediator","App","getChildContext","$appConfig","appConfig","componentDidMount","componentDidUpdate","Children","only","children","defaultProps","propTypes","object","childContextTypes","selectReddit","invalidateReddit","fetchPostsIfNeeded","REQUEST_POSTS","RECEIVE_POSTS","SELECT_REDDIT","INVALIDATE_REDDIT","reddit","type","requestPosts","receivePosts","posts","map","child","receivedAt","Date","now","fetchPosts","dispatch","response","method","timeout","then","ex","shouldFetchPosts","getState","addTodo","completeTodo","setVisibilityFilter","ADD_TODO","COMPLETE_TODO","SET_VISIBILITY_FILTER","VisibilityFilters","SHOW_ALL","SHOW_COMPLETED","SHOW_ACTIVE","text","getDefaultJSVersion","reactRender","defaultTemplate","readFileSync","webpackAssets","JSON","parse","middlewareConfig","renderReactHTML","opts","template","component","rootReducer","pageConfig","needTransform","transformedData","store","html","assign","debug","query","application","debugName","version","jsVersion","js","appName","finalLocals","title","css","pageStr","compileDebug","send","loadData","LOAD_VOTE_SUCCESS","LOAD_VOTE_FAILED","getVote","resp","payload","catch","Picker","onChange","e","target","value","options","option","arrayOf","string","isRequired","func","Posts","post","i","list","ChangeNameForm","newName","onKey","setState","onSubmit","preventDefault","onChangeName","Message","user","MessageList","messages","MessageForm","onMessageSubmit","UsersList","users","Tabs","selectedTab","defaultSelectedTab","firstTabLabel","onSelect","activeStyle","activeLinkStyle","defaultActiveStyle","tab","rest","findFirstTabLabel","forEach","label","className","style","fontWeight","TabTitle","isActive","clsNames","active","styles","visible","display","hidden","TabPanel","displayStyle","for","AddTodo","onClick","node","refs","input","trim","onAddClick","Footer","renderFilter","onFilterChange","oneOf","completed","textDecoration","cursor","uncompleted","Todo","bool","TodoList","todos","todo","onTodoClick","listOf","contains","Promise","resolve","reject","setTimeout","mapStateToProps","about","About","pageId","AsyncPage","selectedReddit","componentWillReceiveProps","onHandleChange","nextReddit","onHandleRefreshClick","isFetching","lastUpdated","isEmpty","size","defaultOptions","toLocaleTimeString","hour12","opacity","List","number","postsByReddit","Map","items","browser","socket","connect","Page","initialize","messageRecieve","userJoined","userLeft","userChangedName","oldName","result","alert","visibleTodos","visibilityFilter","nextFilter","selectTodos","select","action","didInvalidate","merge","vote","update","item","todoApp","Vote","ACTIONS","ensure","requireModule","deps","callback","prevState","replace","cb","lastRoute","routes","WrappedComponent","location","pageComponent","OriginalPage","window","__APP_CONFIG__","requireAuth","authenticated","pathname","nextPathname","redirectAuth","default","configureStore","createLogger","middlewareBuilder","middleware","devToolsExtension","allComposeElements","finalCreateStore","initialState","history","f","module","hot","accept","nextReducer","replaceReducer","connectDataFetchers","IS_FIRST_MOUNT_AFTER_LOAD","FIRST_PAGE_ID","actionCreators","cache","DataFetchersWrapper","fetchData","params","all","actionCreator","prevProps","prevLocation","isUrlChanged","search","slice","_fetchDataOnClient","DATA_LOADED","shape","required","is","x","y","toString","shallowEqual","objA","objB","keysA","keys","keysB","call","exports","router","fakeData","allowCrossDomain","allowedOrigins","origin","headers","header","renderMatch","time","originalUrl","redirect","componentHTML","errorMsg","content","userNames","getGuestName","broadcast","claim","free","names","nextUserId","preRenderMiddleware","components","promises","current","lastComponent"],"mappings":";;;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;ACtCA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,KAAIA,MAAM,wBAAV;;AAEAA,KAAIC,GAAJ,CAAQ,MAAR,EAAgB,4BAAYC,EAAZ,IAAkB,WAAlC;AACAF,KAAIC,GAAJ,CAAQ,MAAR,EAAgB,4BAAYE,IAAZ,IAAoB,IAApC;AACAH,KAAII,OAAJ,CAAY,cAAZ;;AAEAJ,KAAIK,GAAJ,CAAQ,iBAAOC,qBAAP,EAAR;AACAN,KAAIK,GAAJ,CAAQ,iBAAOE,UAAP,EAAR;AACAP,KAAIK,GAAJ,CAAQ,iBAAOG,OAAP,EAAR;AACAR,KAAIK,GAAJ,CAAQ,iBAAOI,SAAP,EAAR;AACAT,KAAIK,GAAJ,CAAQ,iBAAOK,IAAP,EAAR;AACAV,KAAIK,GAAJ,CAAQ,4BAAR;AACAL,KAAIK,GAAJ,CAAQ,sBAAO,KAAP,CAAR;AACAL,KAAIK,GAAJ,CAAQ,qBAAWM,IAAX,EAAR;AACAX,KAAIK,GAAJ,CAAQ,qBAAWO,UAAX,CAAsB,EAAEC,UAAU,IAAZ,EAAtB,CAAR;AACAb,KAAIK,GAAJ,CAAQ,6BAAR;AACAL,KAAIK,GAAJ,CAAQ,8BAAQ;AACZS,aAAQ,IADI;AAEZC,aAAQ,oBAFI;AAGZC,UAAK,mBAHO;AAIZC,wBAAmB,IAJP;AAKZC,aAAQ;AACJC,mBAAU;AADN;AALI,EAAR,CAAR;;AAUA;AACAnB,KAAIK,GAAJ,CAAQ,SAAR,EAAmB,kBAAQe,MAAR,CAAeC,YAAY,YAA3B,EAAyC;AACxDC,aAAQ;AADgD,EAAzC,CAAnB;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAtB,KAAIK,GAAJ;;AAEAL,KAAIK,GAAJ,CAAQ,sBAAR;AACAL,KAAIK,GAAJ,CAAQ,UAAUkB,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC9BD,SAAIE,MAAJ,CAAWC,SAAX,GAAuBJ,IAAIK,SAAJ,EAAvB;AACAH;AACH,EAHD;AAIAzB,KAAIK,GAAJ,CAAQ,qCAAY;AAChBwB,kBAAa,UAASC,IAAT,EAAc;AACvB,gBAAO,oBAAUC,MAAV,CAAiBD,IAAjB,CAAP;AACH;AAHe,EAAZ,CAAR;;AAMA9B,KAAIK,GAAJ,CAAQ,MAAR;AACAL,KAAIK,GAAJ,CAAQ,GAAR;AACAL,KAAIK,GAAJ,CAAQ,GAAR;;AAEA;AACA;AACAL,KAAIK,GAAJ,CAAQ,UAAS2B,GAAT,EAAcT,GAAd,EAAmBC,GAAnB,EAAwBC,IAAxB,EAA8B;AAClCQ,aAAQC,GAAR,CAAYF,GAAZ;AACAR,SAAIW,MAAJ,CAAWH,IAAIG,MAAJ,IAAc,GAAzB;AACA,SAAGH,IAAIG,MAAJ,KAAe,GAAlB,EAAuB;AACnBF,iBAAQG,KAAR,CAAcJ,IAAIK,KAAlB;AACAb,aAAIb,IAAJ,CAAS,EAACyB,OAAO,uBAAR,EAAT;AACH,MAHD,MAIK,IAAGJ,IAAIG,MAAJ,KAAe,GAAlB,EAAuB;AACxBX,aAAIc,MAAJ,CAAW,OAAX,EADwB,CACA;AAC3B,MAFI,MAEE;AACHd,aAAIb,IAAJ,CAAS,EAACyB,OAAOJ,IAAIO,OAAZ,EAAT;AACH;AACJ,EAZD;;AAeAC,SAAQC,EAAR,CAAW,mBAAX,EAAgCT,OAAO;AACnCC,aAAQG,KAAR,CAAcJ,IAAIO,OAAJ,GAAc,IAAd,GAAqBP,IAAIK,KAAvC;AACH,EAFD;AAGAG,SAAQC,EAAR,CAAW,oBAAX,EAAiC,CAACC,MAAD,EAASC,CAAT,KAAe;AAC5CV,aAAQG,KAAR,CAAc,kCAAd,EAAkDO,CAAlD,EAAqD,WAArD,EAAkED,MAAlE;AACH,EAFD;AAGAF,SAAQC,EAAR,CAAW,kBAAX,EAA+B,CAACC,MAAD,EAASC,CAAT,KAAe;AAC1CV,aAAQW,IAAR,CAAa,+BAAb,EAA8CD,CAA9C,EAAiD,WAAjD,EAA8DD,MAA9D;AACH,EAFD;;AAIA,KAAIG,SAAS,eAAKC,YAAL,CAAkB9C,GAAlB,CAAb;;AAEA;AACA,KAAI+C,KAAK,mBAAAC,CAAQ,mBAAR,EAAqBC,MAArB,CAA4BJ,MAA5B,CAAT;AACAE,IAAGG,OAAH,CAAWT,EAAX,CAAc,YAAd;;AAEAI,QAAOI,MAAP,CAAcjD,IAAImD,GAAJ,CAAQ,MAAR,CAAd,EAA+BnD,IAAImD,GAAJ,CAAQ,MAAR,CAA/B,EAAgD,YAAW;AACvD,SAAI,EAAEC,OAAF,EAAWC,IAAX,KAAoBR,OAAOO,OAAP,EAAxB;AACAnB,aAAQqB,GAAR,CAAa,IAAG,iBAAOC,UAAY,oCAAnC,EAAuEH,OAAvE,EAAgFC,IAAhF;AACH,EAHD,E;;;;;;;;;;AC7GA,mC;;;;;;;;;;;;;;;;ACAA;;;;AACA;;;;AACA;;;;;;AAEA,OAAMG,gBAAgB,UAAtB;AACA,UAASC,oBAAT,CAA8BC,QAA9B,EAAuC;AACnC,SAAIC,UAAUC,OAAOC,mBAAP,CAA2BH,QAA3B,EACTI,MADS,CACDC,IAAD,IAAU;AACd,gBAAOP,cAAcQ,IAAd,CAAmBD,IAAnB,KACA,OAAOL,SAASK,IAAT,CAAP,KAA0B,UADjC;AAEH,MAJS,CAAd;;AAMA,SAAIE,oBAAoBL,OAAOM,cAAP,CAAsBR,QAAtB,CAAxB;AACA,SAAGO,sBAAsBL,OAAOO,SAAhC,EAA2C;AACvCR,mBAAUA,QAAQS,MAAR,CAAeX,qBAAqBQ,iBAArB,CAAf,CAAV;AACH;;AAED,YAAON,OAAP;AACH;;KAGoBU,I,GAAN,MAAMA,IAAN,0BAA6B;AACxCC,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA2B;AACvB,eAAMD,KAAN,EAAaC,OAAb;;AAEA,cAAKC,YAAL,GAAoB,EAApB;;AAEA,cAAKC,eAAL;AACH;;AAEDA,uBAAiB;AACb,aAAIH,QAAQd,qBAAqB,IAArB,CAAZ;AACA,cAAI,IAAIM,IAAR,IAAgBQ,KAAhB,EAAsB;AAClB,iBAAG,CAAC,KAAKR,IAAL,EAAWY,UAAf,EAA0B;AACtB,sBAAKZ,IAAL,IAAa,KAAKA,IAAL,EAAWa,IAAX,CAAgB,IAAhB,CAAb;AACA,sBAAKb,IAAL,EAAWY,UAAX,GAAwB,IAAxB;AACH;AACJ;AACJ;;AAEDlC,QAAGoC,SAAH,EAAcC,EAAd,EAAiB;AACb,aAAG,OAAOA,EAAP,KAAc,UAAjB,EAA6B,MAAM,IAAIC,KAAJ,CAAU,yBAAV,CAAN;;AAE7B,aAAG,CAAC,KAAKN,YAAL,CAAkBI,SAAlB,CAAJ,EAAiC;AAC7B,kBAAKJ,YAAL,CAAkBI,SAAlB,IAA+B,CAACC,EAAD,CAA/B;AACH,UAFD,MAEO;AACH,kBAAKL,YAAL,CAAkBI,SAAlB,EAA6BG,IAA7B,CAAkCF,EAAlC;AACH;;AAED,gBAAO,KAAKN,OAAL,CAAaS,SAAb,CAAuBC,WAAvB,CAAmCL,SAAnC,EAA8CC,EAA9C,CAAP;AACH;;AAEDK,UAAKN,SAAL,EAAgB,GAAGO,IAAnB,EAAwB;AACpB,gBAAO,KAAKZ,OAAL,CAAaS,SAAb,CAAuBE,IAAvB,CAA4BN,SAA5B,EAAuC,GAAGO,IAA1C,CAAP;AACH;;AAEDC,SAAIR,SAAJ,EAAeC,EAAf,EAAkB;AACd,aAAIQ,SAAS,KAAKb,YAAL,CAAkBI,SAAlB,CAAb;AACA,aAAGS,MAAH,EAAU;AACN,iBAAIC,QAAQD,OAAOE,OAAP,CAAeV,EAAf,CAAZ;;AAEA,iBAAGS,SAAS,CAAZ,EAAe;AACX,sBAAKf,OAAL,CAAaS,SAAb,CAAuBQ,cAAvB,CAAsCZ,SAAtC,EAAiDC,EAAjD;;AAEAQ,wBAAOI,MAAP,CAAcH,KAAd,EAAqB,CAArB;;AAEA,qBAAG,CAACD,OAAOK,MAAX,EAAmB;AACf,4BAAO,KAAKlB,YAAL,CAAkBI,SAAlB,CAAP;AACH;AACJ,cARD,MAQO;AACH5C,yBAAQW,IAAR,CAAa,YAAYiC,SAAZ,GAAwB,wBAAxB,GAAmD,KAAKe,sBAAL,CAA4BC,OAA5B,EAAnD,GAA2F,YAAxG;AACH;;AAED,oBAAO,IAAP;AACH,UAhBD,MAgBO;AACH5D,qBAAQW,IAAR,CAAa,YAAYiC,SAAZ,GAAwB,wBAAxB,GAAmD,KAAKP,WAAL,CAAiBwB,IAApE,GAA2E,YAAxF;;AAEA,oBAAO,KAAP;AACH;AACJ;;AAGD;;;;;;AAMAC,2BAAsBC,SAAtB,EAAiCC,SAAjC,EAA2C;AACvC,aAAIC,eAAe,CAAC,4BAAa,KAAK3B,KAAlB,EAAyByB,SAAzB,CAAD,IAAwC,CAAC,4BAAa,KAAKG,KAAlB,EAAyBF,SAAzB,CAA5D;;AAEA,aAAGC,gBAAgB,mBAAyB,YAA5C,EAA0D;AACtDjE,qBAAQqB,GAAR,CAAY,gBAAgB,KAAKgB,WAAL,CAAiBwB,IAAjC,GAAwC,cAApD;AACH;;AAED,gBAAOI,YAAP;AACH;;AAEDE,4BAAsB;AAClB,cAAI,IAAIvB,SAAR,IAAqB,KAAKJ,YAA1B,EAAuC;AACnC,iBAAG,KAAKA,YAAL,CAAkB4B,cAAlB,CAAiCxB,SAAjC,CAAH,EAA+C;AAC3C,sBAAI,IAAIC,EAAR,IAAc,KAAKL,YAAL,CAAkBI,SAAlB,CAAd,EAA2C;AACvC,0BAAKQ,GAAL,CAASR,SAAT,EAAoBC,EAApB;AACH;AACJ;AACJ;AACJ;AArFuC,E;mBAAvBT,I;;AAuFrBA,MAAKiC,YAAL,GAAoB;AAChBrB,gBAAW,iBAAUsB,UAAV;AADK,EAApB,C;;;;;;;;;AC5GA,uC;;;;;;;;;ACAA,yC;;;;;;;;;ACAA,gC;;;;;;;;;ACAA,uD;;;;;;;;;ACAA,mC;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,GAAE;AACF;AACA,G;;;;;;;;;ACTA,qC;;;;;;;;;ACAA,0C;;;;;;;;;;;;;;;ACAA;;;;AACA;;;;;;AAEA,KAAIC,WAAW,sBAAf;;KAEMC,G,GAAN,MAAMA,GAAN,0BAA4B;AACxBnC,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AACxB,eAAMD,KAAN,EAAaC,OAAb;AACH;;AAEDkC,uBAAiB;AACb,gBAAO;AACHzB,wBAAWuB,QADR;AAEHG,yBAAY,KAAKpC,KAAL,CAAWqC;AAFpB,UAAP;AAIH;;AAEDC,yBAAmB,CAClB;;AAEDC,0BAAoB,CACnB;;AAEDV,4BAAsB,CACrB;;AAED9D,cAAS;AACL,gBAAO,gBAAMyE,QAAN,CAAeC,IAAf,CAAoB,KAAKzC,KAAL,CAAW0C,QAA/B,CAAP;AACH;AAvBuB,E;;AAyB5BR,KAAIS,YAAJ,GAAmB;AACfN,gBAAW;AADI,EAAnB;AAGAH,KAAIU,SAAJ,GAAgB;AACZP,gBAAW,iBAAUQ;AADT,EAAhB;AAGAX,KAAIY,iBAAJ,GAAwB;AACpBpC,gBAAW,iBAAUsB,UAAV,kBADS;AAEpBI,iBAAY,iBAAUS;AAFF,EAAxB;;mBAKeX,G;;;;;;;;;;;;;;;SCjCCa,Y,GAAAA,Y;SAOAC,gB,GAAAA,gB;SAiDAC,kB,GAAAA,kB;;AAhEhB;;;;AACA;;;;;;;;AAEO,OAAMC,wCAAgB,eAAtB;AACA,OAAMC,wCAAgB,eAAtB;AACA,OAAMC,wCAAgB,eAAtB;AACA,OAAMC,gDAAoB,mBAA1B;;AAEA,UAASN,YAAT,CAAsBO,MAAtB,EAA8B;AACjC,YAAO;AACHC,eAAMH,aADH;AAEHE;AAFG,MAAP;AAIH;;AAEM,UAASN,gBAAT,CAA0BM,MAA1B,EAAkC;AACrC,YAAO;AACHC,eAAMF,iBADH;AAEHC;AAFG,MAAP;AAIH;;AAED,UAASE,YAAT,CAAsBF,MAAtB,EAA8B;AAC1B,YAAO;AACHC,eAAML,aADH;AAEHI;AAFG,MAAP;AAIH;;AAED,UAASG,YAAT,CAAsBH,MAAtB,EAA8BlH,IAA9B,EAAoC;AAChC,YAAO;AACHmH,eAAMJ,aADH;AAEHG,eAFG;AAGHI,gBAAO,oBAAUlG,MAAV,CAAiBpB,KAAKmB,IAAL,CAAUmF,QAAV,CAAmBiB,GAAnB,CAAuBC,SAASA,MAAMrG,IAAtC,CAAjB,CAHJ;AAIHsG,qBAAYC,KAAKC,GAAL;AAJT,MAAP;AAMH;;AAED,UAASC,UAAT,CAAoBV,MAApB,EAA4B;AACxB;AAAA,sCAAO,WAAeW,QAAf,EAAyB;AAC5BA,sBAAST,aAAaF,MAAb,CAAT;AACA,iBAAI;AACA,qBAAIY,WAAW,MAAM,+BAAO,6BAA2BZ,MAAO,QAAzC,EAAiD;AAClEa,6BAAQ,KAD0D;AAElEC,8BAAS;AAFyD,kBAAjD,EAGlBC,IAHkB,CAGb;AAAA,4BAAYH,SAAS9H,IAAT,EAAZ;AAAA,kBAHa,CAArB;AAIA6H,0BAASR,aAAaH,MAAb,EAAqBY,QAArB,CAAT;AACH,cAND,CAME,OAAMI,EAAN,EAAS;AACP5G,yBAAQG,KAAR,CAAcyG,EAAd;AACH;AACJ,UAXD;;AAAA;AAAA;AAAA;AAAA;AAYH;;AAED,UAASC,gBAAT,CAA0B3C,KAA1B,EAAiC0B,MAAjC,EAAyC;AACrC,WAAMI,QAAQ9B,MAAMhD,GAAN,CAAU,eAAV,EAA2BA,GAA3B,CAA+B0E,MAA/B,CAAd;AACA,SAAI,CAACI,KAAL,EAAY;AACR,gBAAO,IAAP;AACH;AACD,SAAIA,MAAM9E,GAAN,CAAU,YAAV,CAAJ,EAA6B;AACzB,gBAAO,KAAP;AACH;AACD,YAAO8E,MAAM9E,GAAN,CAAU,eAAV,CAAP;AACH;;AAEM,UAASqE,kBAAT,CAA4BK,MAA5B,EAAoC;AACvC,YAAO,CAACW,QAAD,EAAWO,QAAX,KAAwB;AAC3B,aAAID,iBAAiBC,UAAjB,EAA6BlB,MAA7B,CAAJ,EAA0C;AACtC,oBAAOW,SAASD,WAAWV,MAAX,CAAT,CAAP;AACH;AACJ,MAJD;AAKH,E;;;;;;;;;;;;;;SChDemB,O,GAAAA,O;SAIAC,Y,GAAAA,Y;SAIAC,mB,GAAAA,mB;AA9BhB;;;;AAIO,OAAMC,8BAAW,UAAjB;AACA,OAAMC,wCAAgB,eAAtB;AACA,OAAMC,wDAAwB,uBAA9B;;AAEP;;;;AAIO,OAAMC,gDAAoB;AAC7BC,eAAU,UADmB;AAE7BC,qBAAgB,gBAFa;AAG7BC,kBAAa;AAHgB,EAA1B;;AAMP;;;;AAIO,UAAST,OAAT,CAAiBU,IAAjB,EAAuB;AAC1B,YAAO,EAAE5B,MAAMqB,QAAR,EAAkBO,IAAlB,EAAP;AACH;;AAEM,UAAST,YAAT,CAAsB1D,KAAtB,EAA6B;AAChC,YAAO,EAAEuC,MAAMsB,aAAR,EAAuB7D,KAAvB,EAAP;AACH;;AAEM,UAAS2D,mBAAT,CAA6BpF,MAA7B,EAAqC;AACxC,YAAO,EAAEgE,MAAMuB,qBAAR,EAA+BvF,MAA/B,EAAP;AACH,E;;;;;;;;;;;;;;SCnBe6F,mB,GAAAA,mB;mBAYQC,W;;AAzBxB;;;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;AAEA;;;;AACA;;;;AACA;;;;;;AAEA,OAAMC,kBAAkB,aAAGC,YAAH,CAAgBzI,YAAY,sBAA5B,EAAoD,MAApD,CAAxB;;AAEO,UAASsI,mBAAT,CAA6B7D,IAA7B,EAAmC;AACtC,SAAIiE,gBAAgB,aAAGD,YAAH,CAAgBzI,YAAY,4BAA5B,EAA0D,MAA1D,CAApB;;AAEA,SAAI;AACA0I,yBAAgBC,KAAKC,KAAL,CAAWF,aAAX,CAAhB;AACH,MAFD,CAEE,OAAOlB,EAAP,EAAW;AACT5G,iBAAQqB,GAAR,CAAY,kCAAZ;AACAyG,yBAAgB,EAAhB;AACH;AACD,YAAOA,cAAcjE,IAAd,CAAP;AACH;;AAEc,UAAS8D,WAAT,CAAqBM,mBAAmB,EAAxC,EAA4C;AACvD,YAAO,UAAU3I,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC7BD,aAAI2I,eAAJ,GAAsB,UAAUC,OAAO,EAAjB,EAAqB;AACvC,iBAAI;AACAC,4BAAW,EADX;AAEAC,6BAAY,EAFZ;AAGAxI,wBAAO,EAHP;AAIAyI,+BAAe,MAAM,CACpB,CALD;AAMA7I,0BAAS,EANT;AAOA8I,8BAAa,EAPb;AAQAC,iCAAgB;AARhB,iBASAL,IATJ;AAUA,iBAAIM,kBAAmB,OAAOR,iBAAiBrI,WAAxB,KAAwC,UAAxC,IAAsD4I,aAAvD,GAChBP,iBAAiBrI,WAAjB,CAA6BC,IAA7B,CADgB,GACqBA,IAD3C;AAEA,iBAAI6I,QAAQ,qBAAeD,eAAf,EAAgCH,WAAhC,CAAZ;AACA,iBAAIK,OAAO,EAAX;AACAJ,0BAAa5G,OAAOiH,MAAP,CAAc,OAAOX,iBAAiBtD,SAAxB,KAAsC,QAAtC,GACrBsD,iBAAiBtD,SADI,GACQ,EADtB,EAC0B4D,UAD1B,CAAb;;AAGA,iBAAI;AACAI,wBAAO,4BACH;AAAA;AAAA,uBAAU,OAAQD,KAAlB;AACI;AAAA;AAAA,2BAAK,WAAYH,UAAjB;AACMF;AADN;AADJ,kBADG,CAAP;AAOH,cARD,CAQE,OAAOzB,EAAP,EAAW;AACT+B,wBAAO,8BAA8B/B,GAAGtG,OAAxC;AACAN,yBAAQG,KAAR,CAAcyG,GAAGtG,OAAjB;AACH;;AAED,iBAAIuI,QAAQvJ,IAAIwJ,KAAJ,CAAUD,KAAV,IAAoBvJ,IAAIwJ,KAAJ,CAAUD,KAAV,KAAoB,iBAAOE,WAAP,CAAmBC,SAAvE;AACA,iBAAIC,UAAU,iBAAOF,WAAP,CAAmBE,OAAjC;AACA,iBAAIC,YAAY,EAAhB;AACA;AACA,iBAAI,IAAJ,EAA2C;AACvCA,6BAAYD,WAAWA,QAAQE,EAA/B;AACH,cAFD,MAEO;AACHD,6BAAYxB,oBAAoBjI,OAAO2J,OAAP,IAAkB,OAAtC,CAAZ;AACH;AACDhB,wBAAWA,YAAYH,iBAAiBL,eAA7B,IAAgDA,eAA3D;;AAEA,iBAAIyB,cAAc1H,OAAOiH,MAAP,CAAc;AAC5BD,qBAD4B;AAE5BzE,wBAAO,0BAASrE,IAAT,CAFqB;AAG5BuJ,0BAAS,OAHmB;AAI5BE,wBAAO,EAJqB;AAK5BvH,uBAAM,mBAAyB,YALH;AAM5B8G,sBAN4B;AAO5BlE,4BAAW,0BAAS4D,UAAT,CAPiB;AAQ5BU,0BAAS;AACLE,yBAAID,SADC;AAELK,0BAAKN,WAAWA,QAAQM;AAFnB;AARmB,cAAd,EAYfhK,IAAIE,MAZW,EAYHA,MAZG,CAAlB;;AAcA,iBAAI+J,UAAU,cAAInJ,MAAJ,CAAW+H,QAAX,EAAqBiB,WAArB,EAAkC;AAC5CI,+BAAc;AAD8B,cAAlC,CAAd;;AAIAlK,iBAAIW,MAAJ,CAAW,GAAX,EAAgBwJ,IAAhB,CAAqBF,OAArB;AACH,UA7DD;;AA+DAhK;AACH,MAjED;AAkEH,E;;;;;;;;;;AC5FD,iC;;;;;;;;;ACAA,oC;;;;;;;;;ACAA,8C;;;;;;;;;ACAA,8C;;;;;;;;;ACAA,+C;;;;;;;;;ACAA,yC;;;;;;;;;ACAA,4C;;;;;;;;;;;;;;;SCKgBmK,Q,GAAAA,Q;;AALhB;;;;;;AAEO,OAAMC,gDAAoB,mBAA1B;AACA,OAAMC,8CAAmB,kBAAzB;;AAEA,UAASF,QAAT,CAAkBxB,IAAlB,EAAwB7I,GAAxB,EAA4B;AAC/B,YAAQiH,QAAD,IAAc;AACjB,gBAAO,oBAAUuD,OAAV,CAAkB3B,IAAlB,EAAwB7I,GAAxB,EAA6BqH,IAA7B,CAAmCoD,IAAD,IAAU;AAC/CxD,sBAAS;AACLV,uBAAM+D,iBADD;AAELI,0BAASD,KAAKlK;AAFT,cAAT;AAIH,UALM,EAKJoK,KALI,CAKE,MAAM;AACX1D,sBAAS;AACLV,uBAAMgE;AADD,cAAT;AAGH,UATM,CAAP;AAUH,MAXD;AAYH,E;;;;;;;;;;;;;;;;AClBD;;;;AACA;;;;AACA;;;;AACA;;;;;;KAEqBK,M,GAAN,MAAMA,MAAN,wBAA0B;AACvC7H,eAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AAC1B,WAAMD,KAAN,EAAaC,OAAb;AACD;;AAED4H,YAASC,CAAT,EAAY;AACV,UAAK9H,KAAL,CAAW6H,QAAX,CAAoBC,EAAEC,MAAF,CAASC,KAA7B;AACD;;AAEDjK,YAAS;AACP,WAAM,EAAEiK,KAAF,EAASH,QAAT,EAAmBI,OAAnB,KAA+B,KAAKjI,KAA1C;;AAEA,YACE;AAAA;AAAA;AACE;AAAA;AAAA;AAAKgI;AAAL,QADF;AAEE;AAAA;AAAA,WAAQ,UAAW,KAAKH,QAAxB;AACE,kBAAOG,KADT;AAEGC,iBAAQtE,GAAR,CAAYuE,UACX;AAAA;AAAA,aAAQ,OAAOA,MAAf,EAAuB,KAAKA,MAA5B;AACGA;AADH,UADD;AAFH;AAFF,MADF;AAaD;AAzBsC,E;mBAApBN,M;;;AA4BrBA,QAAOhF,SAAP,GAAmB;AACjBqF,YAAS,iBAAUE,OAAV,CACP,iBAAUC,MAAV,CAAiBC,UADV,EAEPA,UAHe;AAIjBL,UAAO,iBAAUI,MAAV,CAAiBC,UAJP;AAKjBR,aAAU,iBAAUS,IAAV,CAAeD;AALR,EAAnB,C;;;;;;;;;;;;;;;;ACjCA;;;;AACA;;;;AACA;;;;;;KAEqBE,K,GAAN,MAAMA,KAAN,wBAAyB;AACtCxK,YAAS;AACP,YACE;AAAA;AAAA;AACG,YAAKiC,KAAL,CAAW0D,KAAX,CAAiBC,GAAjB,CAAqB,CAAC6E,IAAD,EAAOC,CAAP,KACpB;AAAA;AAAA,WAAI,KAAKA,CAAT;AAAaD,cAAK5J,GAAL,CAAS,OAAT;AAAb,QADD;AADH,MADF;AAOD;AATqC,E;mBAAnB2J,K;;;AAYrBA,OAAM3F,SAAN,GAAkB;AAChBc,UAAO,kCAAmBgF,IAAnB,CAAwBL;AADf,EAAlB,C;;;;;;;;;;;;;;;;AChBA;;;;AACA;;;;;;KAGqBM,c,GAAN,MAAMA,cAAN,wBAAkC;AAC7C5I,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AACxB,eAAMD,KAAN,EAAaC,OAAb;;AAEA,cAAK2B,KAAL,GAAa,EAACgH,SAAS,EAAV,EAAb;AACH;;AAEDC,WAAMf,CAAN,EAAS;AACL,cAAKgB,QAAL,CAAc,EAAEF,SAAUd,EAAEC,MAAF,CAASC,KAArB,EAAd;AACH;;AAEDe,cAASjB,CAAT,EAAY;AACRA,WAAEkB,cAAF;AACA,aAAIJ,UAAU,KAAKhH,KAAL,CAAWgH,OAAzB;AACA,cAAK5I,KAAL,CAAWiJ,YAAX,CAAwBL,OAAxB;AACA,cAAKE,QAAL,CAAc,EAAEF,SAAS,EAAX,EAAd;AACH;;AAED7K,cAAS;AACL,gBACI;AAAA;AAAA,eAAK,WAAU,kBAAf;AACI;AAAA;AAAA;AAAA;AAAA,cADJ;AAEI;AAAA;AAAA,mBAAM,UAAU,KAAKgL,QAArB;AACI;AACI,+BAAU,KAAKF,KADnB;AAEI,4BAAO,KAAKjH,KAAL,CAAWgH;AAFtB;AADJ;AAFJ,UADJ;AAWH;AA9B4C,E;mBAA5BD,c;;;;;;;;;;;;;;;;ACJrB;;;;AACA;;;;;;KAEaO,O,WAAAA,O,GAAN,MAAMA,OAAN,wBAA2B;AAC9BnJ,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AACxB,eAAMD,KAAN,EAAaC,OAAb;AACH;;AAEDlC,cAAS;AACL,gBACI;AAAA;AAAA,eAAK,WAAU,SAAf;AACI;AAAA;AAAA;AAAS,sBAAKiC,KAAL,CAAWmJ,IAApB;AAAA;AAAA,cADJ;AAEI;AAAA;AAAA;AAAO,sBAAKnJ,KAAL,CAAWmF;AAAlB;AAFJ,UADJ;AAMH;AAZ6B,E;;AAclC+D,SAAQvG,YAAR,GAAuB;AACnBwG,WAAM,EADa;AAEnBhE,WAAM;AAFa,EAAvB;AAIA+D,SAAQtG,SAAR,GAAoB;AAChBuG,WAAM,iBAAUf,MAAV,CAAiBC,UADP;AAEhBlD,WAAM,iBAAUiD,MAAV,CAAiBC;AAFP,EAApB;;KAKae,W,WAAAA,W,GAAN,MAAMA,WAAN,wBAA+B;AAClCrJ,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AACxB,eAAMD,KAAN,EAAaC,OAAb;AACH;;AAEDlC,cAAS;AACL,gBACI;AAAA;AAAA,eAAK,WAAU,UAAf;AACI;AAAA;AAAA;AAAA;AAAA,cADJ;AAGQ,kBAAKiC,KAAL,CAAWqJ,QAAX,CAAoB1F,GAApB,CAAwB,CAAC3F,OAAD,EAAUyK,CAAV,KAAgB;AACpC,wBACI,8BAAC,OAAD;AACI,0BAAKA,CADT;AAEI,2BAAMzK,QAAQmL,IAFlB;AAGI,2BAAMnL,QAAQmH;AAHlB,mBADJ;AAOH,cARD;AAHR,UADJ;AAgBH;AAtBiC,E;KA0BzBmE,W,WAAAA,W,GAAN,MAAMA,WAAN,wBAA+B;AAClCvJ,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AACxB,eAAMD,KAAN,EAAaC,OAAb;;AAEA,cAAK2B,KAAL,GAAa,EAACuD,MAAM,EAAP,EAAb;AACH;;AAED4D,cAASjB,CAAT,EAAY;AACRA,WAAEkB,cAAF;AACA,aAAG,CAAC,KAAKpH,KAAL,CAAWuD,IAAf,EAAqB;;AAErB,aAAInH,UAAU;AACVmL,mBAAO,KAAKnJ,KAAL,CAAWmJ,IADR;AAEVhE,mBAAO,KAAKvD,KAAL,CAAWuD;AAFR,UAAd;AAIA,cAAKnF,KAAL,CAAWuJ,eAAX,CAA2BvL,OAA3B;AACA,cAAK8K,QAAL,CAAc,EAAE3D,MAAM,EAAR,EAAd;AACH;;AAED0C,cAASC,CAAT,EAAY;AACR,cAAKgB,QAAL,CAAc,EAAE3D,MAAO2C,EAAEC,MAAF,CAASC,KAAlB,EAAd;AACH;;AAEDjK,cAAS;AACL,gBACI;AAAA;AAAA,eAAK,WAAU,cAAf;AACI;AAAA;AAAA;AAAA;AAAA,cADJ;AAEI;AAAA;AAAA,mBAAM,UAAU,KAAKgL,QAArB;AACI;AACI,+BAAU,KAAKlB,QADnB;AAEI,4BAAO,KAAKjG,KAAL,CAAWuD;AAFtB;AADJ;AAFJ,UADJ;AAWH;AAnCiC,E;;;;;;;;;;;;;;;;ACpDtC;;;;AACA;;;;;;KAEqBqE,S,GAAN,MAAMA,SAAN,wBAA6B;AACxCzJ,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AACxB,eAAMD,KAAN,EAAaC,OAAb;AACH;;AAEDlC,cAAS;AACL,gBACI;AAAA;AAAA,eAAK,WAAU,OAAf;AACI;AAAA;AAAA;AAAA;AAAA,cADJ;AAEI;AAAA;AAAA;AAEQ,sBAAKiC,KAAL,CAAWyJ,KAAX,CAAiB9F,GAAjB,CAAqB,CAACwF,IAAD,EAAOV,CAAP,KAAa;AAC9B,4BACI;AAAA;AAAA,2BAAI,KAAKA,CAAT;AACKU;AADL,sBADJ;AAKH,kBAND;AAFR;AAFJ,UADJ;AAgBH;AAtBuC,E;mBAAvBK,S;;;;;;;;;;;;;;;;ACHrB;;;;AACA;;;;AACA;;;;;;KAEqBE,I,GAAN,MAAMA,IAAN,wBAAwB;AACnC3J,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AACxB,eAAMD,KAAN,EAAaC,OAAb;;AAEA,cAAK2B,KAAL,GAAa;AACT+H,0BAAa3J,MAAM4J,kBAAN,IAA4B;AADhC,UAAb;;AAIA,cAAKC,aAAL,GAAqB,IAArB;AACH;;AAED1H,uBAAiB;AACb,gBAAO;AACH2H,uBAAU,KAAKA,QAAL,CAAczJ,IAAd,CAAmB,IAAnB,CADP;AAEHsJ,0BAAa,KAAK/H,KAAL,CAAW+H,WAAX,IAA0B,KAAK3J,KAAL,CAAW4J,kBAF/C;AAGHG,0BAAa,KAAK/J,KAAL,CAAWgK,eAAX,IAA8BC,kBAHxC;AAIHJ,4BAAe,KAAKA;AAJjB,UAAP;AAMH;;AAEDC,cAASI,GAAT,EAAc,GAAGC,IAAjB,EAAuB;AACnB,aAAG,KAAKvI,KAAL,CAAW+H,WAAX,KAA2BO,GAA9B,EAAmC;;AAEnC,cAAKpB,QAAL,CAAc;AACVa,0BAAaO;AADH,UAAd;;AAIA,aAAG,OAAO,KAAKlK,KAAL,CAAW8J,QAAlB,KAA+B,UAAlC,EAA8C;AAC1C,kBAAK9J,KAAL,CAAW8J,QAAX,CAAoBI,GAApB,EAAyB,GAAGC,IAA5B;AACH;AACJ;;AAEDC,uBAAkB1H,QAAlB,EAA2B;AACvB,aAAI,OAAOA,QAAP,KAAoB,QAApB,IAAgC,KAAKmH,aAAzC,EAAwD;AACpD;AACH;;AAED,yBAAMrH,QAAN,CAAe6H,OAAf,CAAuB3H,QAAvB,EAAkCkB,KAAD,IAAW;AACxC,iBAAGA,MAAM5D,KAAN,IAAe4D,MAAM5D,KAAN,CAAYsK,KAA9B,EAAqC;AACjC,qBAAG,KAAKT,aAAL,IAAsB,IAAzB,EAA8B;AAC1B,0BAAKA,aAAL,GAAqBjG,MAAM5D,KAAN,CAAYsK,KAAjC;AACA;AACH;AACJ;;AAED,kBAAKF,iBAAL,CAAuBxG,MAAM5D,KAAN,IAAe4D,MAAM5D,KAAN,CAAY0C,QAAlD;AACH,UATD;AAUH;;AAED3E,cAAS;AACL,cAAKqM,iBAAL,CAAuB,KAAKpK,KAAL,CAAW0C,QAAlC;;AAEA,gBACI;AAAA;AAAA,eAAK,WAAY,KAAK1C,KAAL,CAAWuK,SAA5B,EAAwC,OAAQ,KAAKvK,KAAL,CAAWwK,KAA3D;AACK,kBAAKxK,KAAL,CAAW0C;AADhB,UADJ;AAKH;AAzDkC,E;mBAAlBgH,I;;AA2DrBA,MAAK/G,YAAL,GAAoB;AAChBmH,eAAU,IADM;AAEhBE,sBAAiB,IAFD;AAGhBJ,yBAAoB,EAHJ;AAIhBW,gBAAW,EAJK;AAKhBC,YAAO;AALS,EAApB;AAOAd,MAAK9G,SAAL,GAAiB;AACbkH,eAAU,iBAAUxB,IADP;AAEb0B,sBAAiB,iBAAUnH,MAFd;AAGb+G,yBAAoB,iBAAUxB,MAHjB;AAIbmC,gBAAW,iBAAUnC,MAJR;AAKboC,YAAO,iBAAU3H;AALJ,EAAjB;AAOA6G,MAAK5G,iBAAL,GAAyB;AACrBgH,eAAU,iBAAUxB,IADC;AAErBqB,kBAAa,iBAAUvB,MAFF;AAGrB2B,kBAAa,iBAAUlH,MAHF;AAIrBgH,oBAAe,iBAAUzB;AAJJ,EAAzB;;AAOA,OAAM6B,qBAAqB;AACvBQ,iBAAY;AADW,EAA3B;;KAIaC,Q,WAAAA,Q,GAAN,MAAMA,QAAN,0BAAiC;AACpC3K,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA2B;AACvB,eAAMD,KAAN,EAAaC,OAAb;;AAEA,cAAK6J,QAAL,GAAgB,KAAKA,QAAL,CAAczJ,IAAd,CAAmB,IAAnB,CAAhB;AACH;;AAEDyJ,gBAAU;AACN,cAAK7J,OAAL,CAAa6J,QAAb,CAAsB,KAAK9J,KAAL,CAAWsK,KAAjC;AACH;;AAEDhI,yBAAoB;AAChB,aAAI,KAAKrC,OAAL,CAAa0J,WAAb,KAA6B,KAAK3J,KAAL,CAAWsK,KAAxC,IAAkD,CAAC,KAAKrK,OAAL,CAAa0J,WAAd,IAA6B,KAAK1J,OAAL,CAAa4J,aAAb,KAA+B,KAAK7J,KAAL,CAAWsK,KAA7H,EAAqI;AACjI,kBAAKrK,OAAL,CAAa6J,QAAb,CAAsB,KAAK9J,KAAL,CAAWsK,KAAjC;AACH;AACJ;;AAEDvM,cAAS;AACL,aAAIyM,QAAQ,IAAZ;AACA,aAAIG,WAAW,KAAK1K,OAAL,CAAa0J,WAAb,KAA6B,KAAK3J,KAAL,CAAWsK,KAAvD;AACA,aAAIK,QAAJ,EAAc;AACVH,qBAAQ,KAAKvK,OAAL,CAAa8J,WAArB;AACH;AACD,aAAIa,WAAW,0BAAW,KAAK5K,KAAL,CAAWuK,SAAtB,EAAiC,EAAEM,QAAQF,QAAV,EAAjC,CAAf;;AAEA,gBACI;AAAA;AAAA;AACI,4BAAYC,QADhB;AAEI,wBAAOJ,KAFX;AAGI,0BAAU,KAAKV;AAHnB;AAKK,kBAAK9J,KAAL,CAAW0C;AALhB,UADJ;AASH;AAlCmC,E;;AAoCxCgI,UAAS/H,YAAT,GAAwB;AACpB2H,YAAO,EADa;AAEpBC,gBAAW;AAFS,EAAxB;AAIAG,UAAS9H,SAAT,GAAqB;AACjB0H,YAAO,iBAAUlC,MAAV,CAAiBC,UADP;AAEjBkC,gBAAW,iBAAUnC;AAFJ,EAArB;AAIAsC,UAAS3I,YAAT,GAAwB;AACpB+H,eAAU,iBAAUxB,IADA;AAEpBuB,oBAAe,iBAAUzB,MAFL;AAGpB2B,kBAAa,iBAAUlH,MAHH;AAIpB8G,kBAAa,iBAAUvB;AAJH,EAAxB;;AAOA,OAAM0C,SAAS;AACXC,cAAS;AACLC,kBAAS;AADJ,MADE;AAIXC,aAAQ;AACJD,kBAAS;AADL;AAJG,EAAf;;KASaE,Q,WAAAA,Q,GAAN,MAAMA,QAAN,0BAAiC;AACpCnL,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA2B;AACvB,eAAMD,KAAN,EAAaC,OAAb;;AAEA,cAAI,IAAIuK,KAAR,IAAiBM,MAAjB,EAAwB;AACpB,iBAAGA,OAAOhJ,cAAP,CAAsB0I,KAAtB,CAAH,EAAgC;AAC5BnL,wBAAOiH,MAAP,CAAcwE,OAAON,KAAP,CAAd,EAA6B,KAAKxK,KAAL,CAAWwK,KAAxC;AACH;AACJ;AACJ;;AAEDzM,cAAS;AACL,aAAIoN,eAAe,KAAKlL,OAAL,CAAa0J,WAAb,KAA6B,KAAK3J,KAAL,CAAWoL,GAAxC,GACbN,OAAOC,OADM,GACID,OAAOG,MAD9B;;AAGA,gBACI;AAAA;AAAA;AACI,4BAAY,KAAKjL,KAAL,CAAWuK,SAD3B;AAEI,wBAAQY,YAFZ;AAGK,kBAAKnL,KAAL,CAAW0C;AAHhB,UADJ;AAOH;AAtBmC,E;;AAwBxCwI,UAASvI,YAAT,GAAwB;AACpByI,UAAK,EADe;AAEpBb,gBAAW,aAFS;AAGpBC,YAAO;AAHa,EAAxB;AAKAU,UAAStI,SAAT,GAAqB;AACjBwI,UAAK,iBAAUhD,MAAV,CAAiBC,UADL;AAEjBkC,gBAAW,iBAAUnC,MAFJ;AAGjBoC,YAAO,iBAAU3H;AAHA,EAArB;AAKAqI,UAASnJ,YAAT,GAAwB;AACpB4H,kBAAa,iBAAUvB;AADH,EAAxB,C;;;;;;;;;;;;;;;;ACtLA;;;;AACA;;;;;;KAEqBiD,O,GAAN,MAAMA,OAAN,wBAA2B;AACtCtL,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AACxB,eAAMD,KAAN,EAAaC,OAAb;AACH;;AAEDlC,cAAS;AACL,gBACI;AAAA;AAAA;AACI,sDAAO,MAAK,MAAZ,EAAmB,KAAI,OAAvB,GADJ;AAEI;AAAA;AAAA,mBAAQ,SAAU,KAAKuN,OAAL,CAAajL,IAAb,CAAkB,IAAlB,CAAlB;AAAA;AAAA;AAFJ,UADJ;AAMH;;AAEDiL,aAAQxD,CAAR,EAAW;AACP,eAAMyD,OAAO,KAAKC,IAAL,CAAUC,KAAvB;AACA,eAAMtG,OAAOoG,KAAKvD,KAAL,CAAW0D,IAAX,EAAb;AACA,cAAK1L,KAAL,CAAW2L,UAAX,CAAsBxG,IAAtB;AACAoG,cAAKvD,KAAL,GAAa,EAAb;AACH;AAnBqC,E;mBAArBqD,O;;;AAsBrBA,SAAQzI,SAAR,GAAoB;AAChB+I,iBAAY,iBAAUrD,IAAV,CAAeD;AADX,EAApB,C;;;;;;;;;;;;;;;;ACzBA;;;;AACA;;;;;;KAEqBuD,M,GAAN,MAAMA,MAAN,wBAA0B;AACrC7L,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AACxB,eAAMD,KAAN,EAAaC,OAAb;AACH;;AAED4L,kBAAatM,MAAb,EAAqBgC,IAArB,EAA2B;AACvB,aAAIhC,WAAW,KAAKS,KAAL,CAAWT,MAA1B,EAAkC;AAC9B,oBAAOgC,IAAP;AACH;;AAED,gBACI;AAAA;AAAA,eAAG,MAAK,GAAR,EAAY,SAASuG,KAAK;AACtBA,uBAAEkB,cAAF;AACA,0BAAKhJ,KAAL,CAAW8L,cAAX,CAA0BvM,MAA1B;AACH,kBAHD;AAIKgC;AAJL,UADJ;AAQH;;AAEDxD,cAAS;AACL,gBACI;AAAA;AAAA;AAAA;AAEK,gBAFL;AAGK,kBAAK8N,YAAL,CAAkB,UAAlB,EAA8B,KAA9B,CAHL;AAIK,iBAJL;AAKK,kBAAKA,YAAL,CAAkB,gBAAlB,EAAoC,WAApC,CALL;AAMK,iBANL;AAOK,kBAAKA,YAAL,CAAkB,aAAlB,EAAiC,QAAjC,CAPL;AAAA;AAAA,UADJ;AAYH;AAjCoC,E;mBAApBD,M;;;AAoCrBA,QAAOhJ,SAAP,GAAmB;AACfkJ,qBAAgB,iBAAUxD,IAAV,CAAeD,UADhB;AAEf9I,aAAQ,iBAAUwM,KAAV,CAAgB,CACpB,UADoB,EAEpB,gBAFoB,EAGpB,aAHoB,CAAhB,EAIL1D;AANY,EAAnB,C;;;;;;;;;;;;;;;;ACvCA;;;;AACA;;;;;;AAEA,KAAIyC,SAAS;AACTkB,gBAAW;AACPC,yBAAgB,cADT;AAEPC,iBAAQ;AAFD,MADF;AAKTC,kBAAa;AACTF,yBAAgB,MADP;AAETC,iBAAQ;AAFC;AALJ,EAAb;;KAWqBE,I,GAAN,MAAMA,IAAN,wBAAwB;AACnCrM,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AACxB,eAAMD,KAAN,EAAaC,OAAb;AACH;;AAEDqC,yBAAoB;AAChB,cAAKpE,EAAL,CAAQ,MAAR,EAAgB,YAAY;AACxBR,qBAAQqB,GAAR,CAAY,gBAAZ;AACH,UAFD;AAGH;;AAED8C,4BAAsB;AAClB;AACA,eAAMA,oBAAN;AACH;;AAED9D,cAAS;AACL,gBACI;AAAA;AAAA,eAAI,SAAS,KAAKiC,KAAL,CAAWsL,OAAxB;AACI,wBAAQ,KAAKtL,KAAL,CAAWgM,SAAX,GAAuBlB,OAAOkB,SAA9B,GAA0ClB,OAAOqB,WAD7D;AAEM,kBAAKnM,KAAL,CAAWmF;AAFjB,UADJ;AAMH;AAvBkC,E;mBAAlBiH,I;;AAyBrBA,MAAKzJ,YAAL,GAAoB;AAChB2I,cAAS,YAAU,CAAE,CADL;AAEhBnG,WAAM,EAFU;AAGhB6G,gBAAW;AAHK,EAApB;AAKAI,MAAKxJ,SAAL,GAAiB;AACb0I,cAAS,iBAAUhD,IAAV,CAAeD,UADX;AAEblD,WAAM,iBAAUiD,MAAV,CAAiBC,UAFV;AAGb2D,gBAAW,iBAAUK,IAAV,CAAehE;AAHb,EAAjB,C;;;;;;;;;;;;;;;;AC5CA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;;;KAEqBiE,Q,GAAN,MAAMA,QAAN,wBAA4B;AACvCvM,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AACxB,eAAMD,KAAN,EAAaC,OAAb;AACH;;AAEDlC,cAAS;AACL,gBACI;AAAA;AAAA;AACM,kBAAKiC,KAAL,CAAWuM,KAAX,CAAiB5I,GAAjB,CAAqB,CAAC6I,IAAD,EAAOxL,KAAP,KACnB,gDAAM,MAAOwL,KAAK5N,GAAL,CAAS,MAAT,CAAb;AACI,4BAAY4N,KAAK5N,GAAL,CAAS,WAAT,CADhB;AAEI,sBAAKoC,KAFT;AAGI,0BAAS,MAAM,KAAKhB,KAAL,CAAWyM,WAAX,CAAuBzL,KAAvB,CAHnB,GADF;AADN,UADJ;AAUH;AAhBsC,E;mBAAtBsL,Q;;;AAmBrBA,UAAS1J,SAAT,GAAqB;AACjB6J,kBAAa,iBAAUnE,IAAV,CAAeD,UADX;AAEjBkE,YAAO,kCAAmBG,MAAnB,CAA0B,kCAAmBC,QAAnB,CAA4B;AACzDxH,eAAM,iBAAUiD,MAAV,CAAiBC,UADkC;AAEzD2D,oBAAW,iBAAUK,IAAV,CAAehE;AAF+B,MAA5B,CAA1B;AAFU,EAArB,C;;;;;;;;;;;;;;mBCxBe;AACXb,aAAQ3B,IAAR,EAAc7I,GAAd,EAAkB;AACd,gBAAO,IAAI4P,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpCC,wBAAW,MAAM;AACbF,yBAAQ;AACJtP,2BAAM;AACFS,kCAAS;AADP;AADF,kBAAR;AAKH,cAND,EAMG,GANH;AAOH,UARM,CAAP;AASH;AAXU,E;;;;;;;;;;;;;;;;;ACDf;;;;AACA;;AACA;;;;AAEA,UAASgP,eAAT,CAAyBpL,KAAzB,EAAgC;AAC5B,YAAO;AACHuD,eAAMvD,MAAMqL;AADT,MAAP;AAGH;;KAGKC,K,WADL,yBAAQF,eAAR,C,mCACD,MAAME,KAAN,0BAA8B;;AAK1BnP,cAAS;AACL,gBACI;AAAA;AAAA,eAAK,WAAU,OAAf;AAAA;AAEI;AAAA;AAAA,mBAAM,IAAG,kBAAT;AAAA;AAAA,cAFJ;AAAA;AAGW,kBAAKiC,KAAL,CAAWmF;AAHtB,UADJ;AAOH;AAbyB,E,UACnBc,U,GAAa;AAChBkH,aAAQ;AADQ,E;mBAeTD,K;;;;;;;;;;;;;;;AC3Bf;;;;;;AAEA,KAAIhL,MAAM,CAAC,EAACQ,QAAD,EAAD,KAAgB;AACtB,YACI,gBAAMF,QAAN,CAAeC,IAAf,CAAoBC,QAApB,CADJ;AAGH,EAJD;;AAMAR,KAAIU,SAAJ,GAAgB;AACZF,eAAU,iBAAUG;AADR,EAAhB;;mBAIeX,G;;;;;;;;;;;;;;;ACZf;;;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;;;KAEMkL,S,GAAN,MAAMA,SAAN,wBAA6B;AACzBrN,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AACxB,eAAMD,KAAN,EAAaC,OAAb;AACH;;AAEDqC,yBAAoB;AAChB,eAAM,EAAC2B,QAAD,EAAWoJ,cAAX,KAA6B,KAAKrN,KAAxC;AACAiE,kBAAS,+BAAmBoJ,cAAnB,CAAT;AACH;;AAEDC,+BAA0B7L,SAA1B,EAAqC;AACjC,aAAIA,UAAU4L,cAAV,KAA6B,KAAKrN,KAAL,CAAWqN,cAA5C,EAA4D;AACxD,mBAAM,EAACpJ,QAAD,EAAWoJ,cAAX,KAA6B5L,SAAnC;AACAwC,sBAAS,+BAAmBoJ,cAAnB,CAAT;AACH;AACJ;;AAEDE,oBAAeC,UAAf,EAA2B;AACvB,cAAKxN,KAAL,CAAWiE,QAAX,CAAoB,yBAAauJ,UAAb,CAApB;AACH;;AAEDC,0BAAqB3F,CAArB,EAAwB;AACpBA,WAAEkB,cAAF;;AAEA,eAAM,EAAC/E,QAAD,EAAWoJ,cAAX,KAA6B,KAAKrN,KAAxC;AACAiE,kBAAS,6BAAiBoJ,cAAjB,CAAT;AACApJ,kBAAS,+BAAmBoJ,cAAnB,CAAT;AACH;;AAEDtP,cAAS;AACL,eAAM,EAACsP,cAAD,EAAiB3J,KAAjB,EAAwBgK,UAAxB,EAAoCC,WAApC,KAAmD,KAAK3N,KAA9D;AACA,eAAM4N,UAAUlK,MAAMmK,IAAN,KAAe,CAA/B;AACA,gBACI;AAAA;AAAA;AACI,+DAAQ,OAAOR,cAAf;AACQ,2BAAU,KAAKE,cADvB;AAEQ,0BAAUO,cAFlB,GADJ;AAII;AAAA;AAAA;AAEQH,+BACI;AAAA;AAAA;AAAA;AACK,yBAAI7J,IAAJ,CAAS6J,WAAT,EAAsBI,kBAAtB,CAAyC,OAAzC,EAAkD;AACnDC,iCAAQ;AAD2C,sBAAlD,CADL;AAAA;AAIK;AAJL,kBADJ,GAOI,EATZ;AAWK,kBAACN,UAAD,IACD;AAAA;AAAA,uBAAG,MAAK,GAAR;AACG,kCAAS,KAAKD,oBADjB;AAAA;AAAA;AAZJ,cAJJ;AAsBKG,uBACMF,aAAa;AAAA;AAAA;AAAA;AAAA,cAAb,GAAmC;AAAA;AAAA;AAAA;AAAA,cADzC,GAEK;AAAA;AAAA,mBAAK,OAAO,EAAEO,SAASP,aAAa,GAAb,GAAmB,CAA9B,EAAZ;AACF,kEAAO,OAAOhK,KAAd;AADE;AAxBV,UADJ;AA+BH;AA/DwB,E;;AAiE7B0J,WAAUzK,YAAV,GAAyB;AACrB0K,qBAAgB,EADK;AAErB3J,YAAO,IAAI,oBAAUwK,IAAd,EAFc;AAGrBR,iBAAY,KAHS;AAIrBC,kBAAa;;AAJQ,EAAzB;AAOAP,WAAUxK,SAAV,GAAsB;AAClByK,qBAAgB,iBAAUjF,MAAV,CAAiBC,UADf;AAElB3E,YAAO,kCAAmBgF,IAAnB,CAAwBL,UAFb;AAGlBqF,iBAAY,iBAAUrB,IAAV,CAAehE,UAHT;AAIlBsF,kBAAa,iBAAUQ;AAJL,EAAtB;;AAOA,OAAML,iBAAiB,CAAC,SAAD,EAAY,UAAZ,CAAvB;;AAEA,UAASd,eAAT,CAAyBpL,KAAzB,EAAgC;AAC5B,WAAMyL,iBAAiBzL,MAAMhD,GAAN,CAAU,gBAAV,CAAvB;AACA,WAAMwP,gBAAgBxM,MAAMhD,GAAN,CAAU,eAAV,CAAtB;AACA,WAAMrB,OAAO6Q,cAAcxP,GAAd,CAAkBgD,MAAMhD,GAAN,CAAU,gBAAV,CAAlB,KAAkD,IAAI,oBAAUyP,GAAd,CAAkB;AACzEX,qBAAY,IAD6D;AAEzEY,gBAAO,IAAI,oBAAUJ,IAAd;AAFkE,MAAlB,CAA/D;AAIA,WAAMR,aAAanQ,KAAKqB,GAAL,CAAS,YAAT,CAAnB;AACA,WAAM+O,cAAcpQ,KAAKqB,GAAL,CAAS,aAAT,CAApB;AACA,WAAM8E,QAAQnG,KAAKqB,GAAL,CAAS,OAAT,CAAd;;AAEA,YAAO;AACHyO,uBADG;AAEH3J,cAFG;AAGHgK,mBAHG;AAIHC;AAJG,MAAP;AAMH;;mBAEc,yBAAQX,eAAR,EAAyBI,SAAzB,C;;;;;;;;;;;;;;;AC7Gf;;;;AACA;;AAEA;;;;AACA;;;;AACA;;AACA;;;;;;AAEA,KAAGnP,QAAQsQ,OAAX,EAAmB;AACf,SAAIC,SAAShQ,GAAGiQ,OAAH,EAAb;AACH;;KAEKC,I,GAAN,MAAMA,IAAN,wBAAwB;AACpB3O,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AACxB,eAAMD,KAAN,EAAaC,OAAb;;AAEA,cAAK2B,KAAL,GAAa;AACT6H,oBAAO,EADE;AAETJ,uBAAU,EAFD;AAGTlE,mBAAM;AAHG,UAAb;AAKH;;AAED7C,yBAAoB;AAChBkM,gBAAOtQ,EAAP,CAAU,MAAV,EAAkB,KAAKyQ,UAAL,CAAgBtO,IAAhB,CAAqB,IAArB,CAAlB;AACAmO,gBAAOtQ,EAAP,CAAU,cAAV,EAA0B,KAAK0Q,cAAL,CAAoBvO,IAApB,CAAyB,IAAzB,CAA1B;AACAmO,gBAAOtQ,EAAP,CAAU,WAAV,EAAuB,KAAK2Q,UAAL,CAAgBxO,IAAhB,CAAqB,IAArB,CAAvB;AACAmO,gBAAOtQ,EAAP,CAAU,WAAV,EAAuB,KAAK4Q,QAAL,CAAczO,IAAd,CAAmB,IAAnB,CAAvB;AACAmO,gBAAOtQ,EAAP,CAAU,aAAV,EAAyB,KAAK6Q,eAAL,CAAqB1O,IAArB,CAA0B,IAA1B,CAAzB;AACH;;AAEDsO,gBAAWpR,IAAX,EAAiB;AACb,aAAI,EAACkM,KAAD,EAAQlI,IAAR,KAAgBhE,IAApB;AACA,cAAKuL,QAAL,CAAc,EAACW,KAAD,EAAQN,MAAM5H,IAAd,EAAd;AACH;;AAEDqN,oBAAe5Q,OAAf,EAAwB;AACpB,aAAI,EAACqL,QAAD,KAAa,KAAKzH,KAAtB;;AAEA,cAAKkH,QAAL,CAAc;AACVO,uBAAU,CACN,GAAGA,QADG,EAENrL,OAFM;AADA,UAAd;AAMH;;AAED6Q,gBAAWtR,IAAX,EAAiB;AACb,aAAI,EAACkM,KAAD,EAAQJ,QAAR,KAAoB,KAAKzH,KAA7B;AACA,aAAI,EAACL,IAAD,KAAShE,IAAb;;AAEA,cAAKuL,QAAL,CAAc;AACVW,oBAAO,CACHA,KADG,EAEHlI,IAFG,CADG;AAKV8H,uBAAU,CACN,GAAGA,QADG,EAEN;AACIF,uBAAM,iBADV;AAEIhE,uBAAO5D,OAAM;AAFjB,cAFM;AALA,UAAd;AAaH;;AAEDuN,cAASvR,IAAT,EAAe;AACX,aAAI,EAACkM,KAAD,EAAQJ,QAAR,KAAoB,KAAKzH,KAA7B;AACA,aAAI,EAACL,IAAD,KAAShE,IAAb;AACA,aAAIyD,QAAQyI,MAAMxI,OAAN,CAAcM,IAAd,CAAZ;AACAkI,eAAMtI,MAAN,CAAaH,KAAb,EAAoB,CAApB;;AAEA,cAAK8H,QAAL,CAAc;AACVW,oBAAO,CACH,GAAGA,KADA,CADG;AAIVJ,uBAAU,CACN,GAAGA,QADG,EAEN;AACIF,uBAAM,iBADV;AAEIhE,uBAAO5D,OAAM;AAFjB,cAFM;AAJA,UAAd;AAYH;;AAEDwN,qBAAgBxR,IAAhB,EAAsB;AAClB,aAAI,EAACyR,OAAD,EAAUpG,OAAV,KAAqBrL,IAAzB;AACA,aAAI,EAACkM,KAAD,EAAQJ,QAAR,KAAoB,KAAKzH,KAA7B;AACA,aAAIZ,QAAQyI,MAAMxI,OAAN,CAAc+N,OAAd,CAAZ;AACAvF,eAAMtI,MAAN,CAAaH,KAAb,EAAoB,CAApB,EAAuB4H,OAAvB;;AAEA,cAAKE,QAAL,CAAc;AACVW,oBAAO,CACH,GAAGA,KADA,CADG;AAIVJ,uBAAU,CACN,GAAGA,QADG,EAEN;AACIF,uBAAM,iBADV;AAEIhE,uBAAO,mBAAmB6J,OAAnB,GAA6B,OAA7B,GAAsCpG;AAFjD,cAFM;AAJA,UAAd;AAYH;;AAEDW,qBAAgBvL,OAAhB,EAAyB;AACrB,aAAI,EAACqL,QAAD,KAAa,KAAKzH,KAAtB;;AAEA,cAAKkH,QAAL,CAAc;AACVO,uBAAU,CACN,GAAGA,QADG,EAENrL,OAFM;AADA,UAAd;AAMAwQ,gBAAO5N,IAAP,CAAY,cAAZ,EAA4B5C,OAA5B;AACH;;AAEDiL,kBAAaL,OAAb,EAAsB;AAClB,aAAIoG,UAAU,KAAKpN,KAAL,CAAWuH,IAAzB;AACA,aAAI,EAACE,QAAD,KAAa,KAAKzH,KAAtB;;AAEA4M,gBAAO5N,IAAP,CAAY,aAAZ,EAA2B,EAAEW,MAAOqH,OAAT,EAA3B,EAA+CqG,MAAD,IAAY;AACtD,iBAAG,CAACA,MAAJ,EAAY;AACR,wBAAOC,MAAM,uCAAN,CAAP;AACH;AACD,iBAAI,EAACzF,KAAD,KAAU,KAAK7H,KAAnB;AACA,iBAAIZ,QAAQyI,MAAMxI,OAAN,CAAc+N,OAAd,CAAZ;AACAvF,mBAAMtI,MAAN,CAAaH,KAAb,EAAoB,CAApB,EAAuB4H,OAAvB;;AAEAS,wBAAWA,SAAS1F,GAAT,CAAc3F,OAAD,IAAa;AACjC,qBAAGA,QAAQmL,IAAR,KAAiB6F,OAApB,EAA6B;AACzB,4BAAO3P,OAAOiH,MAAP,CAAc,EAAd,EAAkBtI,OAAlB,EAA2B;AAC9BmL,+BAAMP;AADwB,sBAA3B,CAAP;AAGH,kBAJD,MAIO;AACH,4BAAO5K,OAAP;AACH;AACJ,cARU,CAAX;;AAUA,kBAAK8K,QAAL,CAAc;AACVW,wBAAO,CACH,GAAGA,KADA,CADG;AAIVN,uBAAMP,OAJI;AAKVS;AALU,cAAd;AAOH,UAzBD;AA0BH;;AAEDtL,cAAS;AACL,gBACI;AAAA;AAAA;AACI;AACI,wBAAO,KAAK6D,KAAL,CAAW6H;AADtB,eADJ;AAII;AACI,2BAAU,KAAK7H,KAAL,CAAWyH;AADzB,eAJJ;AAOI;AACI,kCAAiB,KAAKE,eAD1B;AAEI,uBAAM,KAAK3H,KAAL,CAAWuH;AAFrB,eAPJ;AAWI;AACI,+BAAc,KAAKF;AADvB;AAXJ,UADJ;AAiBH;AA5JmB,E;mBA8JTyF,I;;;;;;;;;;;;;;;AC1Kf;;;;AACA;;AACA;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;KAEMA,I,GAAN,MAAMA,IAAN,wBAAwB;AACpB3O,iBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AACxB,eAAMD,KAAN,EAAaC,OAAb;AACH;;AAEDqC,yBAAmB;AACf5E,iBAAQqB,GAAR,CAAY,KAAKkB,OAAL,CAAamC,UAAb,CAAwB+G,IAApC;;AAEA,cAAKvI,IAAL,CAAU,MAAV;AACH;;AAED7C,cAAS;AACL;AACA,eAAM,EAAEkG,QAAF,EAAYkL,YAAZ,EAA0BC,gBAA1B,KAA+C,KAAKpP,KAA1D;AACA,gBACI;AAAA;AAAA;AACI;AACI,6BAAYmF,QACRlB,SAAS,mBAAQkB,IAAR,CAAT,CAFR,GADJ;AAKI;AACI,wBAAOgK,YADX;AAEI,8BAAanO,SACTiD,SAAS,wBAAajD,KAAb,CAAT,CAHR,GALJ;AAUI;AACI,yBAAQoO,gBADZ;AAEI,iCAAgBC,cACZpL,SAAS,+BAAoBoL,UAApB,CAAT,CAHR,GAVJ;AAeI;AAAA;AAAA,mBAAM,oBAAmB,GAAzB;AACI;AAAA;AAAA,uBAAU,OAAM,GAAhB;AAAA;AAAA,kBADJ;AAII;AAAA;AAAA,uBAAU,OAAM,GAAhB;AAAA;AAAA,kBAJJ;AAOI;AAAA;AAAA,uBAAU,OAAI,GAAd;AAAA;AAAA,kBAPJ;AAUI;AAAA;AAAA,uBAAU,OAAI,GAAd;AAAA;AAAA;AAVJ;AAfJ,UADJ;AAgCH;AA9CmB,E;;;AAiDxBX,MAAK9L,SAAL,GAAiB;AACbuM,mBAAc,iBAAUnN,UAAV,kBAA2BqG,UAD5B;AAEb+G,uBAAkB,iBAAUrD,KAAV,CAAgB,CAC9B,UAD8B,EAE9B,gBAF8B,EAG9B,aAH8B,CAAhB,EAIf1D;AANU,EAAjB;AAQAqG,MAAK3M,YAAL,GAAoB;AAChBK,iBAAY,iBAAUS,MADN;AAEhBnC,gBAAW,iBAAUmC;AAFL,EAApB;;AAKA,UAASyM,WAAT,CAAqB/C,KAArB,EAA4BhN,MAA5B,EAAoC;AAChC,aAAQA,MAAR;AACI,cAAK,wBAAkByF,QAAvB;AACI,oBAAOuH,KAAP;AACJ,cAAK,wBAAkBtH,cAAvB;AACI,oBAAOsH,MAAMhN,MAAN,CAAaiN,QAAQA,KAAK5N,GAAL,CAAS,WAAT,CAArB,CAAP;AACJ,cAAK,wBAAkBsG,WAAvB;AACI,oBAAOqH,MAAMhN,MAAN,CAAaiN,QAAQ,CAACA,KAAK5N,GAAL,CAAS,WAAT,CAAtB,CAAP;AANR;AAQH;;AAED;AACA;AACA,UAAS2Q,MAAT,CAAgB3N,KAAhB,EAAuB;AACnB,YAAO;AACHuN,uBAAcG,YAAY1N,MAAMhD,GAAN,CAAU,OAAV,CAAZ,EAAgCgD,MAAMhD,GAAN,CAAU,kBAAV,CAAhC,CADX;AAEHwQ,2BAAkBxN,MAAMhD,GAAN,CAAU,kBAAV;AAFf,MAAP;AAIH;;AAED;mBACe,yBAAQ2Q,MAAR,EAAgBb,IAAhB,C;;;;;;;;;;;;;;mBC1FSvJ,I;;AAFxB;;AAEe,UAASA,IAAT,CAAcvD,QAAQ,MAAtB,EAA6B;AACxC,YAAOA,KAAP;AACH,E;;;;;;;;;;;;;;;ACJD;;;;AACA;;AACA;;;;AAKA,UAASyL,cAAT,CAAwBzL,QAAQ,SAAhC,EAA2C4N,MAA3C,EAAmD;AACjD,WAAQA,OAAOjM,IAAf;AACE;AACE,cAAOiM,OAAOlM,MAAd;AACF;AACE,cAAO1B,KAAP;AAJJ;AAMD,E,CAfD;;;AAiBA,UAAS8B,KAAT,CAAe9B,QAAQ,IAAI,oBAAUyM,GAAd,CAAkB;AACvCX,eAAY,KAD2B;AAEvC+B,kBAAe,KAFwB;AAGvCnB,UAAO,IAAI,oBAAUJ,IAAd;AAHgC,EAAlB,CAAvB,EAIIsB,MAJJ,EAIY;AACV,WAAQA,OAAOjM,IAAf;AACE;AACE,cAAO3B,MAAMlG,GAAN,CAAU,eAAV,EAA2B,IAA3B,CAAP;AACF;AACE,cAAOkG,MAAM8N,KAAN,CAAY;AACjBhC,qBAAY,IADK;AAEjB+B,wBAAe;AAFE,QAAZ,CAAP;AAIF;AACE,cAAO7N,MAAM8N,KAAN,CAAY;AACjBhC,qBAAY,KADK;AAEjB+B,wBAAe,KAFE;AAGjBnB,gBAAOkB,OAAO9L,KAHG;AAIjBiK,sBAAa6B,OAAO3L;AAJH,QAAZ,CAAP;AAMF;AACE,cAAOjC,KAAP;AAhBJ;AAkBD;;AAED,UAASwM,aAAT,CAAuBxM,QAAQ,IAAI,oBAAUyM,GAAd,EAA/B,EAAoDmB,MAApD,EAA4D;AAC1D,WAAQA,OAAOjM,IAAf;AACE;AACA;AACA;AACE,cAAO3B,MAAMlG,GAAN,CAAU8T,OAAOlM,MAAjB,EAAyBI,MAAM9B,MAAM4N,OAAOlM,MAAb,CAAN,EAA4BkM,MAA5B,CAAzB,CAAP;AACF;AACE,cAAO5N,KAAP;AANJ;AAQD;;AAED,OAAMoE,cAAc,uCAAgB;AAClCoI,gBADkC;AAElCf;AAFkC,EAAhB,CAApB;;mBAKerH,W;;;;;;;;;;;;;;;AC1Df;;AACA;;;;AACA;;;;;;AAEA,OAAMA,cAAc,4BAAgB;AAChCiH,2BADgC;AAEhC0C;AAFgC,EAAhB,CAApB;;mBAKe3J,W;;;;;;;;;;;;;;;ACRf;;AACA;;AACA;;AACA,OAAM,EAAEhB,QAAF,4BAAN,C,CAJA;;;AAMA,UAASoK,gBAAT,CAA0BxN,QAAQoD,QAAlC,EAA4CwK,MAA5C,EAAoD;AAChD,aAAQA,OAAOjM,IAAf;AACI;AACI,oBAAOiM,OAAOjQ,MAAd;AACJ;AACI,oBAAOqC,KAAP;AAJR;AAMH;;AAED,UAAS2K,KAAT,CAAe3K,QAAQ,qBAAvB,EAAmC4N,MAAnC,EAA2C;AACvC,aAAQA,OAAOjM,IAAf;AACI;AACI,oBAAO3B,MAAMnB,IAAN,CAAW,mBAAQ;AAClB0E,uBAAMqK,OAAOrK,IADK;AAElB6G,4BAAW;AAFO,cAAR,CAAX,CAAP;AAIJ;AACI,oBAAOpK,MAAMgO,MAAN,CAAaJ,OAAOxO,KAApB,EAA2B,UAAS6O,IAAT,EAAc;AAC5C,wBAAOA,KAAKnU,GAAL,CAAS,WAAT,EAAsB,IAAtB,CAAP;AACH,cAFM,CAAP;AAGJ;AACI,oBAAOkG,KAAP;AAXR;AAaH;;AAED,OAAMkO,UAAU,uCAAgB;AAC5BV,qBAD4B;AAE5B7C;AAF4B,EAAhB,CAAhB;;mBAKeuD,O;;;;;;;;;;;;;;mBCjCSC,I;;AAHxB;;KAAYC,O;;;;AAGG,UAASD,IAAT,CAAcnO,QAAQ,EAAtB,EAA0B4N,SAAS,EAAnC,EAAuC;AAClD,aAAQA,OAAOjM,IAAf;AACI,cAAKyM,QAAQ1I,iBAAb;AACI,oBAAOkI,OAAO9H,OAAd;AACJ;AACI,oBAAO9F,KAAP;AAJR;AAMH,E;;;;;;;;;;;;;;;ACVD;;;;AACA;;AAEA;;;;AACA;;;;AAEA;;;;;;AAEA;AACA,KAAI,KAAJ,EAA0C;AACtCnD,aAAQwR,MAAR,GAAiB,SAASC,aAAT,CAAuBC,IAAvB,EAA6BC,QAA7B,EAAuC;AACpDA,kBAAS3R,OAAT;AACH,MAFD;AAGH;AARD;;;AAUA,UAASoJ,QAAT,CAAkBwI,SAAlB,EAA6B3O,SAA7B,EAAwC4O,OAAxC,EAAiDC,EAAjD,EAAoD;AAChD,SAAIC,YAAY9O,UAAU+O,MAAV,CAAiB/O,UAAU+O,MAAV,CAAiBrP,MAAjB,GAA0B,CAA3C,CAAhB;;AAEA,SAAGoP,UAAUzK,SAAb,EAAwB;AACpB,aAAIA,YAAYyK,UAAUzK,SAAV,CAAoB2K,gBAApC;AACA,aAAIC,WAAWjP,UAAUiP,QAAzB;AACA,aAAIC,gBAAgB7K,UAAU8K,YAAV,GAAyB9K,UAAU8K,YAAnC,GAAkD9K,SAAtE;;AAEA1G,gBAAOiH,MAAP,CAAcwK,OAAOC,cAArB,EAAqC;AACjC5D,qBAAQwD,SAASnK,KAAT,CAAe2G,MAAf,IAA0ByD,cAAc3K,UAAd,IAA4B2K,cAAc3K,UAAd,CAAyBkH;AADtD,UAArC;AAGH;;AAEDoD;AACH;;mBAGenK,KAAD,IAAW;AACtB,WAAM4K,cAAc,CAACtP,SAAD,EAAY4O,OAAZ,EAAqBF,QAArB,KAAkC;AAClD,eAAM,EAAEjH,MAAM,EAAE8H,aAAF,EAAR,KAA6B7K,MAAM5B,QAAN,EAAnC;AACA,aAAI,CAACyM,aAAL,EAAoB;AAChBX,qBAAQ;AACJY,2BAAU,QADN;AAEJtP,wBAAO,EAAEuP,cAAczP,UAAUiP,QAAV,CAAmBO,QAAnC;AAFH,cAAR;AAIH;AACDd;AACH,MATD;;AAWA,WAAMgB,eAAe,CAAC1P,SAAD,EAAY4O,OAAZ,EAAqBF,QAArB,KAAkC;AACnD,eAAM,EAAEjH,MAAM,EAAE8H,aAAF,EAAR,KAA6B7K,MAAM5B,QAAN,EAAnC;AACA,aAAIyM,aAAJ,EAAmB;AACfX,qBAAQ;AACJY,2BAAU;AADN,cAAR;AAGH;AACDd;AACH,MARD;AASA,YACI;AAAA;AAAA,WAAO,MAAK,GAAZ,EAAgB,wBAAhB,EAAgC,UAAWvI,QAA3C;AACI,kEAAY,cAAc,CAACnG,SAAD,EAAY6O,EAAZ,KAAmB;AACzC9R,iBAAA,sBAAmBA,WAAW;AAC1B8R,wBAAG,IAAH,EAAS9R,QAAQ,kBAAR,EAA4B4S,OAArC;AACH,kBAFD;AAGH,cAJD,GADJ;AAMI,6DAAO,MAAK,MAAZ,EAAmB,cAAc,CAAC3P,SAAD,EAAY6O,EAAZ,KAAmB;AAChD9R,iBAAA,sBAAmBA,WAAW;AAC1B8R,wBAAG,IAAH,EAAS9R,QAAQ,kBAAR,EAA4B4S,OAArC;AACH,kBAFD;AAGH,cAJD,GANJ;AAWI,6DAAO,MAAK,OAAZ,EAAoB,0BAApB;AAXJ,MADJ;AAeH,E;;;;;;;;;;;;;;mBCrCuBC,c;;AA/BxB;;AACA;;;;;;AAEA,KAAG,KAAH,EAA4D;AACxD,SAAIC,eAAe9S,QAAQ,cAAR,CAAnB;AACH;;AAED,OAAM+S,oBAAoB,MAAM;AAC5B,SAAIC,aAAa,iDAAjB;;AAEA,SAAG,KAAH,EAA4D;AACxD,aAAG,CAACX,OAAOY,iBAAX,EAA8B;AAC1BD,0BAAa,kDAAuBF,cAAvB,CAAb;AACH;AACJ;;AAED,SAAII,qBAAqB,CACrBF,UADqB,CAAzB;;AAIA,SAAG,KAAH,EAA4D;AACxD,aAAGX,OAAOY,iBAAV,EAA4B;AACxBC,gCAAmBlR,IAAnB,CAAwBqQ,OAAOY,iBAAP,EAAxB;AACH;AACJ;;AAED,YAAOC,kBAAP;AACH,EApBD;;AAsBA,OAAMC,mBAAmB,oBAAQ,GAAGJ,mBAAX,qBAAzB;;AAEe,UAASF,cAAT,CAAwBO,YAAxB,EAAsC7L,WAAtC,EAAmD;AAC9D,WAAMI,QAAQwL,iBAAiB5L,WAAjB,EAA8B6L,YAA9B,CAAd;;AAEA,YAAOzL,KAAP;AACH,E;;;;;;;;;;;;;;mBC1BuBkL,c;;AATxB;;AAEA;;;;AACA;;;;;;AAFA;AAIA,KAAG,KAAH,EAA4D;AACxD,SAAIC,eAAe9S,QAAQ,cAAR,CAAnB;AACH;;AAEc,UAAS6S,cAAT,CAAwBO,YAAxB,EAAsCC,OAAtC,EAA+C;AAC1D,WAAML,aAAa,sBAAnB;AAGA,SAAIrL,KAAJ;;AAEA,SAAInI,QAAQsQ,OAAZ,EAAqB;AACjB,aAAG,KAAH,EAA0C;AACtCkD,wBAAWhR,IAAX,CAAgB8Q,cAAhB;;AAEAnL,qBAAQ,+CAAyByL,YAAzB,EAAuC,oBAC3C,4BAAgB,GAAGJ,UAAnB,CAD2C,EAE3C,OAAOX,OAAOY,iBAAd,KAAoC,WAApC,GAAkDZ,OAAOY,iBAAP,EAAlD,GAA+EK,KAAKA,CAFzC,CAAvC,CAAR;AAIH,UAPD,MAOO;AACH3L,qBAAQ,+CAAyByL,YAAzB,EAAuC,oBAC3C,4BAAgB,GAAGJ,UAAnB,CAD2C,CAAvC,CAAR;AAGH;AAEJ,MAdD,MAcO;AACHrL,iBAAQ,+CAAyByL,YAAzB,EAAuC,oBAAQ,4BAAgB,GAAGJ,UAAnB,CAAR,EAAwCM,KAAKA,CAA7C,CAAvC,CAAR;AACH;;AAED,SAAI,KAAJ,EAAgB;AACZ;AACAC,gBAAOC,GAAP,CAAWC,MAAX,CAAkB,yBAAlB,EAA6C,MAAM;AAC/C,mBAAMC,cAAc1T,QAAQ,yBAAR,CAApB;AACA2H,mBAAMgM,cAAN,CAAqBD,WAArB;AACH,UAHD;AAIH;;AAED,YAAO/L,KAAP;AACH,E;;;;;;;;;;;;;;mBChCuBiM,mB;;AAVxB;;;;AAGA;;;;;;AAEA,KAAIC,4BAA4B,IAAhC;AACA,KAAIrU,QAAQsQ,OAAZ,EAAqB;AACjB,SAAIgE,gBAAgBzB,OAAOC,cAAP,CAAsB5D,MAA1C;AACH;;AAEc,UAASkF,mBAAT,CAA6BG,cAA7B,EAA6CC,KAA7C,EAAoD;AAC/D,YAAO,UAAU/D,IAAV,EAAgB;AAAA;;AACnB,aAAIzQ,QAAQsQ,OAAZ,EAAqB;AACjB,iBAAI,CAACG,KAAKzI,UAAV,EAAsB;AAClBvI,yBAAQG,KAAR,CAAe,2DAAf;AACH,cAFD,MAEO;AACHyU,6CAA4B5D,KAAKzI,UAAL,CAAgBkH,MAAhB,KAA2BoF,aAAvD;AACH;AACJ;;AAPkB,aASbG,mBATa,qBASnB,MAAMA,mBAAN,wBAAuC;;AAiBnC,oBAAOC,SAAP,CAAiB;AACb1O,yBADa;AAEb0M,yBAFa;AAGbiC,uBAHa;AAIbvQ,0BAJa;AAKb4D;AALa,cAAjB,EAMGjJ,GANH,EAMQ;AACJ,wBAAO4P,QAAQiG,GAAR,CACHL,eAAe7O,GAAf,CAAmBmP,iBAAiB7O,SAAS6O,cAAc;AACvD7O,6BADuD;AAEvD0M,6BAFuD;AAGvDiC,2BAHuD;AAIvDvQ,8BAJuD;AAKvD4D;AALuD,kBAAd,EAM1CjJ,GAN0C,CAAT,CAApC,CADG,CAAP;AASH;;AAEDwE,mCAAsBC,SAAtB,EAAiC;AAC7B,wBAAO,KAAKzB,KAAL,KAAeyB,SAAtB;AACH;;AAEDc,gCAAmBwQ,SAAnB,EAA8B;AAC1B,uBAAM;AACFpC;AADE,qBAEF,KAAK3Q,KAFT;AAGA,uBAAM;AACF2Q,+BAAUqC;AADR,qBAEFD,SAFJ;;AAIA,uBAAME,eAAgBtC,SAASO,QAAT,KAAsB8B,aAAa9B,QAApC,IAChBP,SAASuC,MAAT,CAAgBC,KAAhB,CAAsB,CAAtB,MAA6BH,aAAaE,MAAb,CAAoBC,KAApB,CAA0B,CAA1B,CADlC;;AAGA,qBAAIF,YAAJ,EAAkB;AACd,0BAAKG,kBAAL;AACH;AACJ;;AAED9Q,iCAAoB;AAChB,qBAAI,CAACmQ,KAAL,EAAY;AACR,yBAAI,CAACH,yBAAL,EAAgC;AAC5B,8BAAKc,kBAAL;AACH;;AAEDd,iDAA4B,KAA5B;AACH,kBAND,MAMO;AACH,yBAAI,CAACA,yBAAD,IAA8B,CAAC5D,KAAK2E,WAAxC,EAAqD;AACjD,8BAAKD,kBAAL;AACH;;AAED1E,0BAAK2E,WAAL,GAAmB,IAAnB;AACAf,iDAA4B,KAA5B;AACH;AACJ;;AAEDc,kCAAqB;AACjB,sBAAKrT,WAAL,CAAiB4S,SAAjB,CAA2B;AACvB1O,+BAAU,KAAKjE,KAAL,CAAWiE,QADE;AAEvB2O,6BAAQ,KAAK5S,KAAL,CAAW4S,MAFI;AAGvBjC,+BAAU,KAAK3Q,KAAL,CAAW2Q,QAHE;AAIvBtO,gCAAW,KAAKpC,OAAL,CAAamC;AAJD,kBAA3B;AAMH;;AAEDrE,sBAAS;AACL,wBACI,8BAAC,IAAD,EAAU,KAAKiC,KAAf,CADJ;AAGH;AArFkC,UATpB,SAUR4C,SAVQ,GAUI;AACfqB,uBAAU,iBAAUqE,IAAV,CAAeD,UADV;AAEfuK,qBAAQ,iBAAU/P,MAFH;AAGf8N,uBAAU,iBAAU2C,KAAV,CAAgB;AACtBpC,2BAAU,iBAAU9I,MAAV,CAAiBmL,QADL;AAEtBL,yBAAQ,iBAAU9K,MAFI;AAGtB5B,wBAAO,iBAAU4B,MAAV,CAAiBvF;AAHF,cAAhB,EAIPwF;AAPY,UAVJ,SAoBRtG,YApBQ,GAoBO;AAClBK,yBAAY,iBAAUS;AADJ,UApBP,SAwBRgO,YAxBQ,GAwBOnC,IAxBP;;;AAiGnB,gBAAOgE,mBAAP;AACH,MAlGD;AAmGH,E;;;;;;;;;AC9GD;AACA;;;;;;;;;;;;AAYA;;AAEA;;AAEA,KAAI5Q,iBAAiBzC,OAAOO,SAAP,CAAiBkC,cAAtC;;AAEA;;;;AAIA,UAAS0R,EAAT,CAAYC,CAAZ,EAAeC,CAAf,EAAkB;AACd;AACA,SAAID,MAAMC,CAAV,EAAa;AACT,gBAAO,IAAP;AACH,MAFD,MAEO;AACH,aAAG,OAAOD,CAAP,KAAa,UAAb,IAA2B,OAAOC,CAAP,KAAa,UAA3C,EAAsD;AAClD,oBAAOD,EAAEE,QAAF,OAAiBD,EAAEC,QAAF,EAAxB;AACH;AACD,gBAAO,KAAP;AACH;AACJ;;AAED;;;;;AAKA,UAASC,YAAT,CAAsBC,IAAtB,EAA4BC,IAA5B,EAAkC;AAC9B,SAAIN,GAAGK,IAAH,EAASC,IAAT,CAAJ,EAAoB;AAChB,gBAAO,IAAP;AACH;;AAED,SAAI,OAAOD,IAAP,KAAgB,QAAhB,IAA4BA,SAAS,IAArC,IAA6C,OAAOC,IAAP,KAAgB,QAA7D,IAAyEA,SAAS,IAAtF,EAA4F;AACxF,gBAAO,KAAP;AACH;;AAED,SAAIC,QAAQ1U,OAAO2U,IAAP,CAAYH,IAAZ,CAAZ;AACA,SAAII,QAAQ5U,OAAO2U,IAAP,CAAYF,IAAZ,CAAZ;;AAEA,SAAIC,MAAM3S,MAAN,KAAiB6S,MAAM7S,MAA3B,EAAmC;AAC/B,gBAAO,KAAP;AACH;;AAED;AACA,UAAK,IAAIqH,IAAI,CAAb,EAAgBA,IAAIsL,MAAM3S,MAA1B,EAAkCqH,GAAlC,EAAuC;AACnC,aAAI,CAAC3G,eAAeoS,IAAf,CAAoBJ,IAApB,EAA0BC,MAAMtL,CAAN,CAA1B,CAAD,IAAwC,CAAC+K,GAAGK,KAAKE,MAAMtL,CAAN,CAAL,CAAH,EAAmBqL,KAAKC,MAAMtL,CAAN,CAAL,CAAnB,CAA7C,EAAiF;AAC7E,oBAAO,KAAP;AACH;AACJ;;AAED,YAAO,IAAP;AACH;;AAEDuJ,QAAOmC,OAAP,GAAiBP,YAAjB,C;;;;;;;;;;;;;;;AClEA;;AAEA,KAAIQ,SAAS,qBAAb;;AAEAA,QAAO5L,IAAP,CAAY,OAAZ,EAAqB,UAASxL,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAwB;AACzC,SAAGW,KAAH,EAAU;AACNX;AACH,MAFD,MAEO;AACHD,aAAImK,IAAJ,CAAS,MAAT;AACH;AACJ,EAND;;mBAQegN,M;;;;;;;;;;;ACZf;;;;AACA;;;;AACA;;;;AACA;;;;;;;;AAEApC,QAAOmC,OAAP;AAAA,kCAAiB,WAAgBnX,GAAhB,EAAqBC,GAArB,EAA0BC,IAA1B,EAAgC;AAC7C,aAAI0E,QAAQ;AACRwM,4BAAe,EADP;AAERf,6BAAgB;AAFR,UAAZ;;AAKA,aAAI;AACA,iBAAInJ,WAAW,MAAM,+BAAO,6BAA2BtC,MAAMyL,cAAe,QAAvD,EAA+D;AAChFlJ,yBAAQ,KADwE;AAEhFC,0BAAS;AAFuE,cAA/D,EAGlBC,IAHkB,CAGb;AAAA,wBAAYH,SAAS9H,IAAT,EAAZ;AAAA,cAHa,CAArB;;AAKAwF,mBAAMwM,aAAN,CAAoBxM,MAAMyL,cAA1B,IAA4C;AACxCoC,gCAAe,KADyB;AAExC/B,6BAAY,KAF4B;AAGxCC,8BAAa7J,KAAKC,GAAL,EAH2B;AAIxCuK,wBAAOpK,SAAS3G,IAAT,CAAcmF,QAAd,CAAuBiB,GAAvB,CAA2B;AAAA,4BAASC,MAAMrG,IAAf;AAAA,kBAA3B;AAJiC,cAA5C;AAOH,UAbD,CAaE,OAAM+G,EAAN,EAAS;AACP5G,qBAAQG,KAAR,CAAcyG,EAAd;AACH;;AAEDrH,aAAI2I,eAAJ,CAAoB;AAChBG,wBAAW,mDADK;AAEhB5I,qBAAQ;AACJ2J,0BAAS,OADL;AAEJE,wBAAO;AAFH,cAFQ;AAMhBzJ,mBAAMqE,KANU;AAOhBoE;AAPgB,UAApB;AAUH,MAjCD;;AAAA;AAAA;AAAA;AAAA,M;;;;;;;;;;;ACLA;;;;AACA;;;;AACA;;;;;;AAEA,KAAIF,WAAW,aAAGP,YAAH,CAAgBzI,YAAY,qBAA5B,EAAmD,MAAnD,CAAf;AACA,KAAIuX,WAAW,EAAf;;AAIArC,QAAOmC,OAAP,GAAiB,UAAUnX,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AACvCD,SAAI2I,eAAJ,CAAoB;AAChBE,iBADgB;AAEhBC,oBAAW,mDAFK;AAGhB5I,iBAAQ;AACJ2J,sBAAS,MADL;AAEJE,oBAAO;AAFH,UAHQ;AAOhBzJ,eAAM8W,QAPU;AAQhBnO,wBAAe;AARC,MAApB;AAUH,EAXD,C;;;;;;;;;;;;ACTA;;;;AACA;;;;AACA;;;;;;AAEA,KAAImO,WAAW;AACXjF,uBAAkB,UADP;AAEX7C,YAAO,CACH;AACIpH,eAAM,KADV;AAEI6G,oBAAW;AAFf,MADG,EAKH;AACI7G,eAAM,KADV;AAEI6G,oBAAW;AAFf,MALG;AAFI,EAAf;;AAcAgG,QAAOmC,OAAP,GAAiB,UAAUnX,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AACvCD,SAAI2I,eAAJ,CAAoB;AAChBG,oBAAW,mDADK;AAEhB5I,iBAAQ;AACJ2J,sBAAS,MADL;AAEJE,oBAAO;AAFH,UAFQ;AAMhBzJ,eAAM8W,QANU;AAOhBrO,oCAPgB;AAQhBC,qBAAY;AACRkD,mBAAM;AADE;AARI,MAApB;AAYH,EAbD,C;;;;;;;;;;;;;;mBCjBwBmL,gB;AAAT,UAASA,gBAAT,CAA0BtX,GAA1B,EAA+BC,GAA/B,EAAoCC,IAApC,EAA0C;AACrD,SAAIqX,iBAAiB,CACjB,qBADiB,CAArB;AAGA,SAAIC,SAASxX,IAAIyX,OAAJ,CAAYD,MAAzB;AACA,SAAGD,eAAetT,OAAf,CAAuBuT,MAAvB,IAAiC,CAAC,CAArC,EAAuC;AACnCvX,aAAIyX,MAAJ,CAAW,6BAAX,EAA0CF,MAA1C;AACH;AACDtX;AACH,E;;;;;;;;;;;;;;mBCOuByX,W;;AAjBxB;;;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;AACA;;;;;;;;AAEA,OAAMrP,kBAAkB,aAAGC,YAAH,CAAgBzI,YAAY,sBAA5B,EAAoD,MAApD,CAAxB;;AAGe,UAAS6X,WAAT,CAAqB3X,GAArB,EAA0BC,GAA1B,EAA+B;AAC1C,WAAM6U,UAAU,uCAAhB;AACA,WAAM1L,QAAQ,wBAAe;AACzB+C,eAAM;AADmB,MAAf,EAEX2I,OAFW,CAAd;AAGA,SAAIzP,YAAY;AACZuS,eAAM9Q,KAAKC,GAAL;AADM,MAAhB;AAGA,WAAM0M,SAAS,sBAAarK,KAAb,EAAoB/D,SAApB,CAAf;;AAEA,6BAAM,EAACoO,MAAD,EAASE,UAAU3T,IAAI6X,WAAvB,EAAN;AAAA,sCAA2C,WAAgBpX,GAAhB,EAAqBqX,QAArB,EAA+B9U,KAA/B,EAAqC;AAC5E,iBAAIvC,GAAJ,EAAS;AACLR,qBAAIW,MAAJ,CAAW,GAAX,EAAgBxB,IAAhB,CAAqBqB,GAArB;AACH,cAFD,MAEO,IAAIqX,QAAJ,EAAc;AACjB7X,qBAAI6X,QAAJ,CAAa,GAAb,EAAkBA,SAAS5D,QAAT,GAAoB4D,SAAS5B,MAA/C;AACH,cAFM,MAEA,IAAIlT,KAAJ,EAAW;AACd,qBAAIuG,QAAQvJ,IAAIwJ,KAAJ,CAAUD,KAAV,IAAoBvJ,IAAIwJ,KAAJ,CAAUD,KAAV,KAAoB,iBAAOE,WAAP,CAAmBC,SAAvE;AACA,qBAAIC,UAAU,iBAAOF,WAAP,CAAmBE,OAAjC;AACA,qBAAIC,YAAY,EAAhB;AACA;AACA,qBAAI,IAAJ,EAA2C;AACvCA,iCAAYD,WAAWA,QAAQE,EAA/B;AACH,kBAFD,MAEO;AACHD,iCAAY,gDAAoB,KAApB,CAAZ;AACH;AACD,qBAAIiL,eAAe,EAAnB;AACA,qBAAIkD,gBAAgB,EAApB;AACA,qBAAIC,WAAW,EAAf;;AAEA,qBAAI;AACA,2BAAM,yBAAoB5O,MAAMnC,QAA1B,EAAoCjE,KAApC,EAA2CqC,SAA3C,EAAsDrF,GAAtD,CAAN;;AAEA+X,qCAAgB,4BACZ;AAAA;AAAA,2BAAU,OAAO3O,KAAjB;AACI;AAAA;AAAA,+BAAK,WAAY/D,SAAjB;AACI,uFAAmBrC,KAAnB;AADJ;AADJ,sBADY,CAAhB;;AAQA6R,oCAAezL,MAAM5B,QAAN,EAAf;AAEH,kBAbD,CAaE,OAAMF,EAAN,EAAS;AACP0Q,gCAAW1Q,GAAGxG,KAAd;AACAJ,6BAAQqB,GAAR,CAAYuF,GAAGxG,KAAf;AACH;;AAED,qBAAIoJ,UAAU,cAAInJ,MAAJ,CAAWuH,eAAX,EAA4BjG,OAAOiH,MAAP,CAAc;AACpD0O,6BADoD;AAEpD3O,2BAAM0O,aAF8C;AAGpDnT,4BAAO,0BAASiQ,YAAT,CAH6C;AAIpD/K,8BAAS,KAJ2C;AAKpDE,4BAAO,MAL6C;AAMpDvH,2BAAM,mBAAyB,YANqB;AAOpD8G,4BAAOA,KAP6C;AAQpDlE,gCAAW,0BAASA,SAAT,CARyC;AASpDsE,8BAAS;AACLE,6BAAID,SADC;AAELK,8BAAKN,WAAWA,QAAQM;AAFnB;AAT2C,kBAAd,EAavC,EAbuC,CAA5B,EAaN;AACJE,mCAAc;AADV,kBAbM,CAAd;;AAiBAlK,qBAAIW,MAAJ,CAAW,GAAX,EAAgBwJ,IAAhB,CAAqBF,OAArB;AAEH,cAnDM,MAmDA;AACHjK,qBAAI6X,QAAJ,CAAa,GAAb;AACH;AACJ,UA3DD;;AAAA;AAAA;AAAA;AAAA;AA4DH,E;;;;;;;;;;;;;;;;ACvFD;;AACA;;;;AAIA;;;;AACA;;;;AACA;;;;;;;;AAJA,KAAIV,SAAS,qBAAb;;AAOA;;;AAGAA,QAAOxV,GAAP,CAAW,GAAX;AACAwV,QAAOxV,GAAP,CAAW,QAAX;AACAwV,QAAOxV,GAAP,CAAW,OAAX;;AAGA;;;AAGA,KAAIqW,UAAU,aAAG1P,YAAH,CAAgBzI,YAAY,8BAA5B,EAA4D,MAA5D,CAAd;;AAEAsX,QAAOxV,GAAP,CAAW,QAAX;AAAA,gCAAqB,WAAe5B,GAAf,EAAoBC,GAApB,EAAwB;AACzCA,SAAIvB,GAAJ,CAAQ,cAAR,EAAwB,wBAAxB;AACAuB,SAAImK,IAAJ,CAAS6N,OAAT;AACH,IAHD;;AAAA;AAAA;AAAA;AAAA;;mBAKeb,M;;;;;;;;;;;;;;;;mBCuBA,UAAU5F,MAAV,EAAkB;AAC7B,SAAIjN,OAAO2T,UAAUC,YAAV,EAAX;;AAEA;AACA3G,YAAO5N,IAAP,CAAY,MAAZ,EAAoB;AAChBW,eAAMA,IADU;AAEhBkI,gBAAOyL,UAAUtW,GAAV;AAFS,MAApB;;AAKA;AACA4P,YAAO4G,SAAP,CAAiBxU,IAAjB,CAAsB,WAAtB,EAAmC;AAC/BW,eAAMA;AADyB,MAAnC;;AAIA;AACAiN,YAAOtQ,EAAP,CAAU,cAAV,EAA0B,UAAUX,IAAV,EAAgB;AACtCiR,gBAAO4G,SAAP,CAAiBxU,IAAjB,CAAsB,cAAtB,EAAsC;AAClCuI,mBAAM5H,IAD4B;AAElC4D,mBAAM5H,KAAK4H;AAFuB,UAAtC;AAIH,MALD;;AAOA;AACAqJ,YAAOtQ,EAAP,CAAU,aAAV,EAAyB,UAAUX,IAAV,EAAgBgD,EAAhB,EAAoB;AACzC,aAAI2U,UAAUG,KAAV,CAAgB9X,KAAKgE,IAArB,CAAJ,EAAgC;AAC5B,iBAAIyN,UAAUzN,IAAd;AACA2T,uBAAUI,IAAV,CAAetG,OAAf;;AAEAzN,oBAAOhE,KAAKgE,IAAZ;;AAEAiN,oBAAO4G,SAAP,CAAiBxU,IAAjB,CAAsB,aAAtB,EAAqC;AACjCoO,0BAASA,OADwB;AAEjCpG,0BAASrH;AAFwB,cAArC;;AAKAhB,gBAAG,IAAH;AACH,UAZD,MAYO;AACHA,gBAAG,KAAH;AACH;AACJ,MAhBD;;AAkBA;AACAiO,YAAOtQ,EAAP,CAAU,YAAV,EAAwB,YAAY;AAChCsQ,gBAAO4G,SAAP,CAAiBxU,IAAjB,CAAsB,WAAtB,EAAmC;AAC/BW,mBAAMA;AADyB,UAAnC;AAGA2T,mBAAUI,IAAV,CAAe/T,IAAf;AACH,MALD;AAMH,E;;AAnGD;AACA,KAAI2T,YAAa,YAAY;AACzB,SAAIK,QAAQ,EAAZ;;AAEA,SAAIF,QAAQ,UAAU9T,IAAV,EAAgB;AACxB,aAAI,CAACA,IAAD,IAASgU,MAAMhU,IAAN,CAAb,EAA0B;AACtB,oBAAO,KAAP;AACH,UAFD,MAEO;AACHgU,mBAAMhU,IAAN,IAAc,IAAd;AACA,oBAAO,IAAP;AACH;AACJ,MAPD;;AASA;AACA,SAAI4T,eAAe,YAAY;AAC3B,aAAI5T,IAAJ;AAAA,aACIiU,aAAa,CADjB;;AAGA,YAAG;AACCjU,oBAAO,WAAWiU,UAAlB;AACAA,2BAAc,CAAd;AACH,UAHD,QAGS,CAACH,MAAM9T,IAAN,CAHV;;AAKA,gBAAOA,IAAP;AACH,MAVD;;AAYA;AACA,SAAI3C,MAAM,YAAY;AAClB,aAAI3B,MAAM,EAAV;AACA,cAAK,IAAIkM,IAAT,IAAiBoM,KAAjB,EAAwB;AACpBtY,iBAAIwD,IAAJ,CAAS0I,IAAT;AACH;;AAED,gBAAOlM,GAAP;AACH,MAPD;;AASA,SAAIqY,OAAO,UAAU/T,IAAV,EAAgB;AACvB,aAAIgU,MAAMhU,IAAN,CAAJ,EAAiB;AACb,oBAAOgU,MAAMhU,IAAN,CAAP;AACH;AACJ,MAJD;;AAMA,YAAO;AACH8T,gBAAOA,KADJ;AAEHC,eAAMA,IAFH;AAGH1W,cAAKA,GAHF;AAIHuW,uBAAcA;AAJX,MAAP;AAMH,EA/CgB,EAAjB;;AAiDA;AAiDC,E;;;;;;;;;;;;;;ACnGD,UAASM,mBAAT,CAA6BxR,QAA7B,EAAuC,EAAEyR,UAAF,EAAc/E,QAAd,EAAwBiC,MAAxB,EAAvC,EAAyEvQ,YAAY,EAArF,EAAyFrF,GAAzF,EAA8F;AAC1F,WAAM2Y,WAAWD,WAAW/R,GAAX,CAAgBiS,OAAD,IAAa;AACzC,aAAG,CAACA,OAAJ,EAAa,OAAO,IAAP;;AAEb,eAAM7P,YAAY6P,QAAQlF,gBAAR,GAA2BkF,QAAQlF,gBAAnC,GAAsDkF,OAAxE;AACA,eAAM3P,aAAaF,UAAU8K,YAAV,IAA0B9K,UAAU8K,YAAV,CAAuB5K,UAApE;;AAEA,gBAAOF,UAAU4M,SAAV,GAAsB5M,UAAU4M,SAAV,CAAoB,EAAE1O,QAAF,EAAY0M,QAAZ,EAAsBiC,MAAtB,EAA8BvQ,SAA9B,EAAyC4D,UAAzC,EAApB,EAA2EjJ,GAA3E,CAAtB,GAAwG,IAA/G;AACH,MAPgB,CAAjB;;AASA,SAAI6Y,gBAAgBH,WAAWA,WAAWtU,MAAX,GAAoB,CAA/B,EAAkCsP,gBAAlC,GAAqDgF,WAAWA,WAAWtU,MAAX,GAAoB,CAA/B,EAAkCsP,gBAAvF,GAA0GgF,WAAWA,WAAWtU,MAAX,GAAoB,CAA/B,CAA9H;AACAiB,eAAU8K,MAAV,GAAmB0I,iBAAiBA,cAAchF,YAA/B,IAA+CgF,cAAchF,YAAd,CAA2B5K,UAA1E,IAAwF4P,cAAchF,YAAd,CAA2B5K,UAA3B,CAAsCkH,MAAjJ;;AAEA,YAAOP,QAAQiG,GAAR,CAAY8C,QAAZ,CAAP;AACH;;mBAEcF,mB;;;;;;;;;AChBf,yC;;;;;;;;;ACAA,wC;;;;;;;;;ACAA,yC;;;;;;;;;ACAA,2C;;;;;;;;;ACAA,mC;;;;;;;;;ACAA,6C;;;;;;;;;ACAA,oC;;;;;;;;;ACAA,kC;;;;;;;;;ACAA,oC;;;;;;;;;ACAA,uC","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap eb310abba3bc068fa889","import http from 'http';\r\nimport express from 'express';\r\nimport compress from 'compression';\r\nimport logger from 'morgan';\r\nimport cookieParser from 'cookie-parser';\r\nimport bodyParser from 'body-parser';\r\nimport session from 'express-session';\r\nimport csurf from 'csurf';\r\nimport config from './config/config.json';\r\nimport routes from './routes/index';\r\nimport apis from './apis/index';\r\nimport allowCrossDomain from './middlewares/allowCrossDomain'\r\nimport reactRender from './middlewares/renderReactMiddleware';\r\nimport Immutable from 'immutable';\r\nimport helmet from 'helmet';\r\nimport socket from './sockets/socket';\r\nimport spaRenderMatch from './middlewares/spaRenderMatch';\r\n\r\nlet app = express();\r\n\r\napp.set('host', process.env.IP || '127.0.0.1');\r\napp.set('port', process.env.PORT || 3000);\r\napp.disable('x-powered-by');\r\n\r\napp.use(helmet.contentSecurityPolicy());\r\napp.use(helmet.frameguard());\r\napp.use(helmet.noSniff());\r\napp.use(helmet.xssFilter());\r\napp.use(helmet.hsts());\r\napp.use(compress());\r\napp.use(logger('dev'));\r\napp.use(bodyParser.json());\r\napp.use(bodyParser.urlencoded({ extended: true }));\r\napp.use(cookieParser());\r\napp.use(session({\r\n    resave: true,\r\n    secret: 'mySecretCookieSalt',\r\n    key: 'myCookieSessionId',\r\n    saveUninitialized: true,\r\n    cookie: {\r\n        httpOnly: true,\r\n    }\r\n}));\r\n\r\n// app.use(favicon(__dirname + '/../public/favicon.ico'));\r\napp.use('/static', express.static(__dirname + '/../public', {\r\n    maxAge: 86400000\r\n}));\r\n\r\n// if(process.env.NODE_ENV !== 'production'){\r\n//     let webpack = require('webpack');\r\n//     let config = require('../create-webpack.config')(true);\r\n//     let webpackDevMiddleware = require('webpack-dev-middleware');\r\n//     let webpackHotMiddleware = require('webpack-hot-middleware');\r\n//     let compiler = webpack(config);\r\n//     app.use(webpackDevMiddleware(compiler, { noInfo: true, publicPath: config.output.publicPath }));\r\n//     app.use(webpackHotMiddleware(compiler));\r\n// }\r\n\r\napp.use(allowCrossDomain);\r\n\r\napp.use(csurf());\r\napp.use(function (req, res, next) {\r\n    res.locals.csrftoken = req.csrfToken();\r\n    next();\r\n});\r\napp.use(reactRender({\r\n    transformer: function(data){\r\n        return Immutable.fromJS(data);\r\n    }\r\n}));\r\n\r\napp.use('/api', apis);\r\napp.use('/', routes);\r\napp.use('*', spaRenderMatch);\r\n\r\n// error handlers\r\n// no stacktraces leaked to user\r\napp.use(function(err, req, res, next) {\r\n    console.dir(err);\r\n    res.status(err.status || 500);\r\n    if(err.status === 500) {\r\n        console.error(err.stack);\r\n        res.json({error: 'Internal Server Error'});\r\n    }\r\n    else if(err.status === 404) {\r\n        res.render('error');    //render error page\r\n    } else {\r\n        res.json({error: err.message})\r\n    }\r\n});\r\n\r\n\r\nprocess.on('uncaughtException', err => {\r\n    console.error(err.message + '\\n' + err.stack);\r\n});\r\nprocess.on('unhandledRejection', (reason, p) => {\r\n    console.error(\"Unhandled Rejection at: Promise \", p, \" reason: \", reason);\r\n});\r\nprocess.on('rejectionHandled', (reason, p) => {\r\n    console.warn(\"rejectionHandled at: Promise \", p, \" reason: \", reason);\r\n});\r\n\r\nlet server = http.createServer(app);\r\n\r\n/* Socket.io Communication */\r\nlet io = require('socket.io').listen(server);\r\nio.sockets.on('connection', socket);\r\n\r\nserver.listen(app.get('port'), app.get('host'), function() {\r\n    let { address, port } = server.address();\r\n    console.log(`${ config.serverName } server listening at http://%s:%s`, address, port);\r\n});\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/server/app.js","module.exports = require(\"react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = 1\n// module chunks = 0","import React, { PropTypes, Component } from 'react';\nimport shallowEqual from '../utils/shallowEqual';\nimport EventEmitter from 'events';\n\nconst eventMatchReg = /^on[A-Z]/;\nfunction getEventMethodsProps(instance){\n    let methods = Object.getOwnPropertyNames(instance)\n        .filter((prop) => {\n            return eventMatchReg.test(prop)\n                && typeof instance[prop] === 'function';\n        });\n\n    let instancePrototype = Object.getPrototypeOf(instance);\n    if(instancePrototype !== Object.prototype) {\n        methods = methods.concat(getEventMethodsProps(instancePrototype));\n    }\n\n    return methods\n}\n\n\nexport default class Base extends Component {\n    constructor(props, context){\n        super(props, context);\n\n        this.__eventNames = {};\n\n        this.__bindFunctions();\n    }\n\n    __bindFunctions(){\n        let props = getEventMethodsProps(this);\n        for(let prop of props){\n            if(!this[prop].funcBinded){\n                this[prop] = this[prop].bind(this);\n                this[prop].funcBinded = true;\n            }\n        }\n    }\n\n    on(eventName, fn){\n        if(typeof fn !== 'function') throw new Error('fn should be a function');\n\n        if(!this.__eventNames[eventName]){\n            this.__eventNames[eventName] = [fn];\n        } else {\n            this.__eventNames[eventName].push(fn);\n        }\n\n        return this.context.$eventBus.addListener(eventName, fn);\n    }\n\n    emit(eventName, ...args){\n        return this.context.$eventBus.emit(eventName, ...args);\n    }\n\n    off(eventName, fn){\n        let events = this.__eventNames[eventName];\n        if(events){\n            let index = events.indexOf(fn);\n\n            if(index >= 0) {\n                this.context.$eventBus.removeListener(eventName, fn);\n\n                events.splice(index, 1);\n\n                if(!events.length) {\n                    delete this.__eventNames[eventName];\n                }\n            } else {\n                console.warn('event: ' + eventName + ' is not registered in ' + this._reactInternalInstance.getName() + ' Component');\n            }\n\n            return true;\n        } else {\n            console.warn('event: ' + eventName + ' is not registered in ' + this.constructor.name + ' Component');\n\n            return false;\n        }\n    }\n\n\n    /**\n     * 检验组件更新\n     * @param nextProps\n     * @param nextState\n     * @returns {*}\n     */\n    shouldComponentUpdate(nextProps, nextState){\n        let shouldUpdate = !shallowEqual(this.props, nextProps) || !shallowEqual(this.state, nextState);\n\n        if(shouldUpdate && process.env.NODE_ENV !== 'production') {\n            console.log('Component: ' + this.constructor.name + ' will update');\n        }\n\n        return shouldUpdate;\n    }\n\n    componentWillUnmount(){\n        for(let eventName in this.__eventNames){\n            if(this.__eventNames.hasOwnProperty(eventName)){\n                for(let fn of this.__eventNames[eventName]){\n                    this.off(eventName, fn);\n                }\n            }\n        }\n    }\n}\nBase.contextTypes = {\n    $eventBus: PropTypes.instanceOf(EventEmitter)\n};\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/pages/Base.jsx","module.exports = require(\"immutable\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"immutable\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"react-redux\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-redux\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"react-immutable-proptypes\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-immutable-proptypes\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"redux\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"redux\"\n// module id = 7\n// module chunks = 0","module.exports = {\n\t\"application\": {\n\t\t\"version\": {\n\t\t\t\"css\": \"\",\n\t\t\t\"js\": \"\"\n\t\t},\n\t\t\"debugName\": \"test\"\n\t},\n\t\"serverName\": \"isomophic-react-redux-starter\"\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/config/config.json\n// module id = 8\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"react-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-router\"\n// module id = 10\n// module chunks = 0","import React, { Component, PropTypes } from 'react';\nimport EventEmitter from 'events';\n\nlet mediator = new EventEmitter();\n\nclass App extends Component {\n    constructor(props, context) {\n        super(props, context);\n    }\n\n    getChildContext(){\n        return {\n            $eventBus: mediator,\n            $appConfig: this.props.appConfig\n        }\n    }\n\n    componentDidMount(){\n    }\n\n    componentDidUpdate(){\n    }\n\n    componentWillUnmount(){\n    }\n\n    render() {\n        return React.Children.only(this.props.children);\n    }\n}\nApp.defaultProps = {\n    appConfig: null\n};\nApp.propTypes = {\n    appConfig: PropTypes.object\n};\nApp.childContextTypes = {\n    $eventBus: PropTypes.instanceOf(EventEmitter),\n    $appConfig: PropTypes.object\n};\n\nexport default App;\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/App.jsx","import fetch from 'isomorphic-fetch'\nimport Immutable from 'immutable';\n\nexport const REQUEST_POSTS = 'REQUEST_POSTS'\nexport const RECEIVE_POSTS = 'RECEIVE_POSTS'\nexport const SELECT_REDDIT = 'SELECT_REDDIT'\nexport const INVALIDATE_REDDIT = 'INVALIDATE_REDDIT'\n\nexport function selectReddit(reddit) {\n    return {\n        type: SELECT_REDDIT,\n        reddit\n    }\n}\n\nexport function invalidateReddit(reddit) {\n    return {\n        type: INVALIDATE_REDDIT,\n        reddit\n    }\n}\n\nfunction requestPosts(reddit) {\n    return {\n        type: REQUEST_POSTS,\n        reddit\n    }\n}\n\nfunction receivePosts(reddit, json) {\n    return {\n        type: RECEIVE_POSTS,\n        reddit,\n        posts: Immutable.fromJS(json.data.children.map(child => child.data)),\n        receivedAt: Date.now()\n    }\n}\n\nfunction fetchPosts(reddit) {\n    return async function(dispatch) {\n        dispatch(requestPosts(reddit))\n        try {\n            let response = await fetch(`https://www.reddit.com/r/${reddit}.json`, {\n                method: 'GET',\n                timeout: 5000\n            }).then(response => response.json());\n            dispatch(receivePosts(reddit, response))\n        } catch(ex){\n            console.error(ex);\n        }\n    }\n}\n\nfunction shouldFetchPosts(state, reddit) {\n    const posts = state.get('postsByReddit').get(reddit)\n    if (!posts) {\n        return true\n    }\n    if (posts.get('isFetching')) {\n        return false\n    }\n    return posts.get('didInvalidate')\n}\n\nexport function fetchPostsIfNeeded(reddit) {\n    return (dispatch, getState) => {\n        if (shouldFetchPosts(getState(), reddit)) {\n            return dispatch(fetchPosts(reddit))\n        }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/actions/async.js","/*\r\n * action 类型\r\n */\r\n\r\nexport const ADD_TODO = 'ADD_TODO';\r\nexport const COMPLETE_TODO = 'COMPLETE_TODO';\r\nexport const SET_VISIBILITY_FILTER = 'SET_VISIBILITY_FILTER'\r\n\r\n/*\r\n * 其它的常量\r\n */\r\n\r\nexport const VisibilityFilters = {\r\n    SHOW_ALL: 'SHOW_ALL',\r\n    SHOW_COMPLETED: 'SHOW_COMPLETED',\r\n    SHOW_ACTIVE: 'SHOW_ACTIVE'\r\n};\r\n\r\n/*\r\n * action 创建函数\r\n */\r\n\r\nexport function addTodo(text) {\r\n    return { type: ADD_TODO, text }\r\n}\r\n\r\nexport function completeTodo(index) {\r\n    return { type: COMPLETE_TODO, index }\r\n}\r\n\r\nexport function setVisibilityFilter(filter) {\r\n    return { type: SET_VISIBILITY_FILTER, filter }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/actions/todo.js","import ejs from 'ejs';\r\nimport React from 'react';\r\nimport {renderToString} from 'react-dom/server';\r\nimport {Provider} from 'react-redux';\r\nimport fs from 'fs';\r\nimport { jsObj as safeJSON } from 'secure-filters';\r\n\r\nimport configureStore from '../../common/store/index';\r\nimport App from '../../common/App.jsx';\r\nimport config from '../config/config.json';\r\n\r\nconst defaultTemplate = fs.readFileSync(__dirname + '/../views/index.html', 'utf8');\r\n\r\nexport function getDefaultJSVersion(name) {\r\n    let webpackAssets = fs.readFileSync(__dirname + '/../../webpack-assets.json', 'utf8');\r\n\r\n    try {\r\n        webpackAssets = JSON.parse(webpackAssets);\r\n    } catch (ex) {\r\n        console.log('webpack-assets.json parsed error');\r\n        webpackAssets = {};\r\n    }\r\n    return webpackAssets[name];\r\n}\r\n\r\nexport default function reactRender(middlewareConfig = {}) {\r\n    return function (req, res, next) {\r\n        res.renderReactHTML = function (opts = {}) {\r\n            let {\r\n                template = '',\r\n                component = '',\r\n                data = {},\r\n                rootReducer = (() => {\r\n                }),\r\n                locals = {},\r\n                pageConfig = {},\r\n                needTransform = true\r\n            } = opts;\r\n            let transformedData = (typeof middlewareConfig.transformer === 'function' && needTransform)\r\n                ? middlewareConfig.transformer(data) : data;\r\n            let store = configureStore(transformedData, rootReducer);\r\n            let html = '';\r\n            pageConfig = Object.assign(typeof middlewareConfig.appConfig === 'object'\r\n                ? middlewareConfig.appConfig : {}, pageConfig);\r\n\r\n            try {\r\n                html = renderToString((\r\n                    <Provider store={ store }>\r\n                        <App appconfig={ pageConfig }>\r\n                            { component }\r\n                        </App>\r\n                    </Provider>\r\n                ));\r\n            } catch (ex) {\r\n                html = 'internal server error: \\n' + ex.message;\r\n                console.error(ex.message);\r\n            }\r\n\r\n            let debug = req.query.debug && (req.query.debug === config.application.debugName);\r\n            let version = config.application.version;\r\n            let jsVersion = '';\r\n            // prefer config version, useful when using CDN config\r\n            if (process.env.NODE_ENV === 'production') {\r\n                jsVersion = version && version.js;\r\n            } else {\r\n                jsVersion = getDefaultJSVersion(locals.appName || 'index');\r\n            }\r\n            template = template || middlewareConfig.defaultTemplate || defaultTemplate;\r\n\r\n            let finalLocals = Object.assign({\r\n                html,\r\n                state: safeJSON(data),\r\n                appName: 'index',\r\n                title: '',\r\n                test: process.env.NODE_ENV !== 'production',\r\n                debug,\r\n                appConfig: safeJSON(pageConfig),\r\n                version: {\r\n                    js: jsVersion,\r\n                    css: version && version.css\r\n                }\r\n            }, res.locals, locals);\r\n\r\n            let pageStr = ejs.render(template, finalLocals, {\r\n                compileDebug: false\r\n            });\r\n\r\n            res.status(200).send(pageStr);\r\n        };\r\n\r\n        next();\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/server/middlewares/renderReactMiddleware.jsx","module.exports = require(\"ejs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ejs\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"events\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"events\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"isomorphic-fetch\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"isomorphic-fetch\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"react-dom/server\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-dom/server\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"redux-immutablejs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"redux-immutablejs\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"redux-thunk\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"redux-thunk\"\n// module id = 20\n// module chunks = 0","module.exports = require(\"secure-filters\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"secure-filters\"\n// module id = 21\n// module chunks = 0","import fetchList from '../fetchList';\r\n\r\nexport const LOAD_VOTE_SUCCESS = 'LOAD_VOTE_SUCCESS';\r\nexport const LOAD_VOTE_FAILED = 'LOAD_VOTE_FAILED';\r\n\r\nexport function loadData(opts, req){\r\n    return (dispatch) => {\r\n        return fetchList.getVote(opts, req).then((resp) => {\r\n            dispatch({\r\n                type: LOAD_VOTE_SUCCESS,\r\n                payload: resp.data\r\n            });\r\n        }).catch(() => {\r\n            dispatch({\r\n                type: LOAD_VOTE_FAILED\r\n            });\r\n        });\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/actions/vote.js","import React, { Component, PropTypes } from 'react';\nimport Immutable from 'immutable';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport Base from '../../pages/Base';\n\nexport default class Picker extends Base {\n  constructor(props, context) {\n    super(props, context);\n  }\n\n  onChange(e) {\n    this.props.onChange(e.target.value)\n  }\n\n  render() {\n    const { value, onChange, options } = this.props\n\n    return (\n      <span>\n        <h1>{value}</h1>\n        <select onChange={ this.onChange }\n          value={value}>\n          {options.map(option =>\n            <option value={option} key={option}>\n              {option}\n            </option>)\n          }\n        </select>\n      </span>\n    )\n  }\n}\n\nPicker.propTypes = {\n  options: PropTypes.arrayOf(\n    PropTypes.string.isRequired\n  ).isRequired,\n  value: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/async/Picker.jsx","import React, { PropTypes, Component } from 'react'\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport Base from '../../pages/Base';\n\nexport default class Posts extends Base {\n  render() {\n    return (\n      <ul>\n        {this.props.posts.map((post, i) =>\n          <li key={i}>{post.get('title')}</li>\n        )}\n      </ul>\n    )\n  }\n}\n\nPosts.propTypes = {\n  posts: ImmutablePropTypes.list.isRequired\n}\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/async/Posts.jsx","import React from 'react';\nimport Base from '../../pages/Base';\n\n\nexport default class ChangeNameForm extends Base {\n    constructor(props, context) {\n        super(props, context);\n\n        this.state = {newName: ''};\n    }\n\n    onKey(e) {\n        this.setState({ newName : e.target.value });\n    }\n\n    onSubmit(e) {\n        e.preventDefault();\n        var newName = this.state.newName;\n        this.props.onChangeName(newName);\n        this.setState({ newName: '' });\n    }\n\n    render() {\n        return(\n            <div className='change_name_form'>\n                <h3> Change Name </h3>\n                <form onSubmit={this.onSubmit}>\n                    <input\n                        onChange={this.onKey}\n                        value={this.state.newName}\n                    />\n                </form>\n            </div>\n        );\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/chat/ChangeNameForm.jsx","import React, { PropTypes } from 'react';\r\nimport Base from '../../pages/Base';\r\n\r\nexport class Message extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"message\">\r\n                <strong>{this.props.user} :</strong>\r\n                <span>{this.props.text}</span>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nMessage.defaultProps = {\r\n    user: '',\r\n    text: ''\r\n};\r\nMessage.propTypes = {\r\n    user: PropTypes.string.isRequired,\r\n    text: PropTypes.string.isRequired\r\n};\r\n\r\nexport class MessageList extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className='messages'>\r\n                <h2> Conversation: </h2>\r\n                {\r\n                    this.props.messages.map((message, i) => {\r\n                        return (\r\n                            <Message\r\n                                key={i}\r\n                                user={message.user}\r\n                                text={message.text}\r\n                            />\r\n                        );\r\n                    })\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\n\r\nexport class MessageForm extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n\r\n        this.state = {text: ''};\r\n    }\r\n\r\n    onSubmit(e) {\r\n        e.preventDefault();\r\n        if(!this.state.text) return;\r\n\r\n        let message = {\r\n            user : this.props.user,\r\n            text : this.state.text\r\n        };\r\n        this.props.onMessageSubmit(message);\r\n        this.setState({ text: '' });\r\n    }\r\n\r\n    onChange(e) {\r\n        this.setState({ text : e.target.value });\r\n    }\r\n\r\n    render() {\r\n        return(\r\n            <div className='message_form'>\r\n                <h3>Write New Message</h3>\r\n                <form onSubmit={this.onSubmit}>\r\n                    <input\r\n                        onChange={this.onChange}\r\n                        value={this.state.text}\r\n                    />\r\n                </form>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/chat/Messages.jsx","import React from 'react';\nimport Base from '../../pages/Base';\n\nexport default class UsersList extends Base {\n    constructor(props, context) {\n        super(props, context);\n    }\n\n    render() {\n        return (\n            <div className='users'>\n                <h3> Online Users </h3>\n                <ul>\n                    {\n                        this.props.users.map((user, i) => {\n                            return (\n                                <li key={i}>\n                                    {user}\n                                </li>\n                            );\n                        })\n                    }\n                </ul>\n            </div>\n        );\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/chat/UsersList.jsx","import React, { Component, PropTypes } from 'react';\nimport classnames from 'classnames';\nimport Base from '../../pages/Base';\n\nexport default class Tabs extends Base {\n    constructor(props, context) {\n        super(props, context);\n\n        this.state = {\n            selectedTab: props.defaultSelectedTab || null\n        };\n\n        this.firstTabLabel = null;\n    }\n\n    getChildContext(){\n        return {\n            onSelect: this.onSelect.bind(this),\n            selectedTab: this.state.selectedTab || this.props.defaultSelectedTab,\n            activeStyle: this.props.activeLinkStyle || defaultActiveStyle,\n            firstTabLabel: this.firstTabLabel\n        };\n    }\n\n    onSelect(tab, ...rest) {\n        if(this.state.selectedTab === tab) return;\n\n        this.setState({\n            selectedTab: tab\n        });\n\n        if(typeof this.props.onSelect === 'function') {\n            this.props.onSelect(tab, ...rest);\n        }\n    }\n\n    findFirstTabLabel(children){\n        if (typeof children !== 'object' || this.firstTabLabel) {\n            return;\n        }\n\n        React.Children.forEach(children, (child) => {\n            if(child.props && child.props.label) {\n                if(this.firstTabLabel == null){\n                    this.firstTabLabel = child.props.label;\n                    return;\n                }\n            }\n\n            this.findFirstTabLabel(child.props && child.props.children);\n        });\n    }\n\n    render() {\n        this.findFirstTabLabel(this.props.children);\n\n        return (\n            <div className={ this.props.className } style={ this.props.style }>\n                {this.props.children}\n            </div>\n        );\n    }\n}\nTabs.defaultProps = {\n    onSelect: null,\n    activeLinkStyle: null,\n    defaultSelectedTab: '',\n    className: '',\n    style: null\n};\nTabs.propTypes = {\n    onSelect: PropTypes.func,\n    activeLinkStyle: PropTypes.object,\n    defaultSelectedTab: PropTypes.string,\n    className: PropTypes.string,\n    style: PropTypes.object\n};\nTabs.childContextTypes = {\n    onSelect: PropTypes.func,\n    selectedTab: PropTypes.string,\n    activeStyle: PropTypes.object,\n    firstTabLabel: PropTypes.string\n};\n\nconst defaultActiveStyle = {\n    fontWeight: 'bold'\n};\n\nexport class TabTitle extends Component {\n    constructor(props, context){\n        super(props, context);\n\n        this.onSelect = this.onSelect.bind(this);\n    }\n\n    onSelect(){\n        this.context.onSelect(this.props.label);\n    }\n\n    componentDidMount() {\n        if (this.context.selectedTab === this.props.label || (!this.context.selectedTab && this.context.firstTabLabel === this.props.label)) {\n            this.context.onSelect(this.props.label);\n        }\n    }\n\n    render() {\n        let style = null;\n        let isActive = this.context.selectedTab === this.props.label;\n        if (isActive) {\n            style = this.context.activeStyle;\n        }\n        let clsNames = classnames(this.props.className, { active: isActive });\n\n        return (\n            <div\n                className={ clsNames }\n                style={style}\n                onClick={ this.onSelect }\n            >\n                {this.props.children}\n            </div>\n        );\n    }\n}\nTabTitle.defaultProps = {\n    label: '',\n    className: 'tab-link'\n};\nTabTitle.propTypes = {\n    label: PropTypes.string.isRequired,\n    className: PropTypes.string\n};\nTabTitle.contextTypes = {\n    onSelect: PropTypes.func,\n    firstTabLabel: PropTypes.string,\n    activeStyle: PropTypes.object,\n    selectedTab: PropTypes.string\n};\n\nconst styles = {\n    visible: {\n        display: 'block'\n    },\n    hidden: {\n        display: 'none'\n    }\n};\n\nexport class TabPanel extends Component {\n    constructor(props, context){\n        super(props, context);\n\n        for(let style in styles){\n            if(styles.hasOwnProperty(style)){\n                Object.assign(styles[style], this.props.style);\n            }\n        }\n    }\n\n    render() {\n        let displayStyle = this.context.selectedTab === this.props.for\n            ? styles.visible : styles.hidden;\n\n        return (\n            <div\n                className={ this.props.className }\n                style={ displayStyle }>\n                {this.props.children}\n            </div>\n        );\n    }\n}\nTabPanel.defaultProps = {\n    for: '',\n    className: 'tab-content',\n    style: null\n};\nTabPanel.propTypes = {\n    for: PropTypes.string.isRequired,\n    className: PropTypes.string,\n    style: PropTypes.object\n};\nTabPanel.contextTypes = {\n    selectedTab: PropTypes.string\n};\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/common/Tab.jsx","import React, { Component, PropTypes } from 'react';\nimport Base from '../../pages/Base';\n\nexport default class AddTodo extends Base {\n    constructor(props, context) {\n        super(props, context);\n    }\n\n    render() {\n        return (\n            <div>\n                <input type='text' ref='input' />\n                <button onClick={ this.onClick.bind(this) }>Add</button>\n            </div>\n        )\n    }\n\n    onClick(e) {\n        const node = this.refs.input;\n        const text = node.value.trim();\n        this.props.onAddClick(text);\n        node.value = '';\n    }\n}\n\nAddTodo.propTypes = {\n    onAddClick: PropTypes.func.isRequired\n};\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/todo/AddTodo.jsx","import React, { Component, PropTypes } from 'react';\nimport Base from '../../pages/Base';\n\nexport default class Footer extends Base {\n    constructor(props, context) {\n        super(props, context);\n    }\n\n    renderFilter(filter, name) {\n        if (filter === this.props.filter) {\n            return name\n        }\n\n        return (\n            <a href='#' onClick={e => {\n                e.preventDefault()\n                this.props.onFilterChange(filter)\n            } }>\n                {name}\n            </a>\n        )\n    }\n\n    render() {\n        return (\n            <p>\n                Show:\n                {' '}\n                {this.renderFilter('SHOW_ALL', 'All') }\n                {', '}\n                {this.renderFilter('SHOW_COMPLETED', 'Completed') }\n                {', '}\n                {this.renderFilter('SHOW_ACTIVE', 'Active') }\n                .\n            </p>\n        )\n    }\n}\n\nFooter.propTypes = {\n    onFilterChange: PropTypes.func.isRequired,\n    filter: PropTypes.oneOf([\n        'SHOW_ALL',\n        'SHOW_COMPLETED',\n        'SHOW_ACTIVE'\n    ]).isRequired\n}\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/todo/Footer.jsx","import React, {Component, PropTypes} from 'react';\r\nimport Base from '../../pages/Base';\r\n\r\nlet styles = {\r\n    completed: {\r\n        textDecoration: 'line-through',\r\n        cursor: 'default'\r\n    },\r\n    uncompleted: {\r\n        textDecoration: 'none',\r\n        cursor: 'pointer'\r\n    }\r\n};\r\n\r\nexport default class Todo extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.on('test', function () {\r\n            console.log('test event bus');\r\n        });\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        // unregister subscribe\r\n        super.componentWillUnmount();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <li onClick={this.props.onClick}\r\n                style={ this.props.completed ? styles.completed : styles.uncompleted }>\r\n                { this.props.text }\r\n            </li>\r\n        )\r\n    }\r\n}\r\nTodo.defaultProps = {\r\n    onClick: function(){},\r\n    text: '',\r\n    completed: false\r\n};\r\nTodo.propTypes = {\r\n    onClick: PropTypes.func.isRequired,\r\n    text: PropTypes.string.isRequired,\r\n    completed: PropTypes.bool.isRequired\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/todo/Todo.jsx","import React, { Component, PropTypes } from 'react'\nimport { List } from 'immutable';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport Todo from './Todo'\nimport Base from '../../pages/Base';\n\nexport default class TodoList extends Base {\n    constructor(props, context) {\n        super(props, context);\n    }\n\n    render() {\n        return (\n            <ul>\n                { this.props.todos.map((todo, index) =>\n                    <Todo text={ todo.get('text') }\n                        completed={ todo.get('completed') }\n                        key={index}\n                        onClick={() => this.props.onTodoClick(index) } />\n                    ) }\n            </ul>\n        )\n    }\n}\n\nTodoList.propTypes = {\n    onTodoClick: PropTypes.func.isRequired,\n    todos: ImmutablePropTypes.listOf(ImmutablePropTypes.contains({\n        text: PropTypes.string.isRequired,\n        completed: PropTypes.bool.isRequired\n    }))\n};\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/components/todo/TodoList.jsx","\r\nexport default {\r\n    getVote(opts, req){\r\n        return new Promise((resolve, reject) => {\r\n            setTimeout(() => {\r\n                resolve({\r\n                    data: {\r\n                        message: 123\r\n                    }\r\n                });\r\n            }, 500);\r\n        });\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/fetchList/serverFetch.js","import React, { Component } from 'react';\r\nimport { Link } from 'react-router';\r\nimport { connect } from 'react-redux';\r\n\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        text: state.about\r\n    };\r\n}\r\n\r\n@connect(mapStateToProps)\r\nclass About extends Component {\r\n    static pageConfig = {\r\n        pageId: 'About'\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"about\">\r\n                this is about page\r\n                <Link to=\"/vote?debug=test\">vote</Link>\r\n                text: {this.props.text}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default About;\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/pages/App/About.jsx","import React, { PropTypes } from 'react';\r\n\r\nlet App = ({children}) => {\r\n    return (\r\n        React.Children.only(children)\r\n    );\r\n};\r\n\r\nApp.propTypes = {\r\n    children: PropTypes.object\r\n};\r\n\r\nexport default App;\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/pages/App/App.jsx","import React, {Component, PropTypes} from 'react'\nimport {connect} from 'react-redux'\nimport Immutable from 'immutable';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport {selectReddit, fetchPostsIfNeeded, invalidateReddit} from '../../actions/async'\nimport Picker from '../../components/async/Picker.jsx'\nimport Posts from '../../components/async/Posts.jsx'\nimport Base from '../Base.jsx';\n\nclass AsyncPage extends Base {\n    constructor(props, context) {\n        super(props, context);\n    }\n\n    componentDidMount() {\n        const {dispatch, selectedReddit} = this.props\n        dispatch(fetchPostsIfNeeded(selectedReddit))\n    }\n\n    componentWillReceiveProps(nextProps) {\n        if (nextProps.selectedReddit !== this.props.selectedReddit) {\n            const {dispatch, selectedReddit} = nextProps\n            dispatch(fetchPostsIfNeeded(selectedReddit))\n        }\n    }\n\n    onHandleChange(nextReddit) {\n        this.props.dispatch(selectReddit(nextReddit))\n    }\n\n    onHandleRefreshClick(e) {\n        e.preventDefault()\n\n        const {dispatch, selectedReddit} = this.props\n        dispatch(invalidateReddit(selectedReddit))\n        dispatch(fetchPostsIfNeeded(selectedReddit))\n    }\n\n    render() {\n        const {selectedReddit, posts, isFetching, lastUpdated} = this.props\n        const isEmpty = posts.size === 0\n        return (\n            <div>\n                <Picker value={selectedReddit}\n                        onChange={this.onHandleChange}\n                        options={ defaultOptions }/>\n                <p>\n                    {\n                        lastUpdated ? (\n                            <span>\n                Last updated at {new Date(lastUpdated).toLocaleTimeString('en-US', {\n                                hour12: false\n                            })}.\n                                {' '}\n              </span>\n                        ) : ''\n                    }\n                    {!isFetching &&\n                    <a href=\"#\"\n                       onClick={this.onHandleRefreshClick}>\n                        Refresh\n                    </a>\n                    }\n                </p>\n                {isEmpty\n                    ? (isFetching ? <h2>Loading...</h2> : <h2>Empty.</h2>)\n                    : <div style={{ opacity: isFetching ? 0.5 : 1 }}>\n                    <Posts posts={posts}/>\n                </div>\n                }\n            </div>\n        )\n    }\n}\nAsyncPage.defaultProps = {\n    selectedReddit: '',\n    posts: new Immutable.List(),\n    isFetching: false,\n    lastUpdated: 0\n\n};\nAsyncPage.propTypes = {\n    selectedReddit: PropTypes.string.isRequired,\n    posts: ImmutablePropTypes.list.isRequired,\n    isFetching: PropTypes.bool.isRequired,\n    lastUpdated: PropTypes.number\n}\n\nconst defaultOptions = ['reactjs', 'frontend'];\n\nfunction mapStateToProps(state) {\n    const selectedReddit = state.get('selectedReddit');\n    const postsByReddit = state.get('postsByReddit');\n    const data = postsByReddit.get(state.get('selectedReddit')) || new Immutable.Map({\n            isFetching: true,\n            items: new Immutable.List()\n        });\n    const isFetching = data.get('isFetching');\n    const lastUpdated = data.get('lastUpdated');\n    const posts = data.get('items');\n\n    return {\n        selectedReddit,\n        posts,\n        isFetching,\n        lastUpdated\n    }\n}\n\nexport default connect(mapStateToProps)(AsyncPage)\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/pages/async/Page.jsx","import React, {Component, PropTypes} from 'react'\nimport {connect} from 'react-redux'\n\nimport Base from '../Base.jsx';\nimport UsersList from '../../components/chat/UsersList';\nimport { MessageForm, MessageList } from '../../components/chat/Messages';\nimport ChangeNameForm from '../../components/chat/ChangeNameForm';\n\nif(process.browser){\n    var socket = io.connect();\n}\n\nclass Page extends Base {\n    constructor(props, context) {\n        super(props, context);\n\n        this.state = {\n            users: [],\n            messages: [],\n            text: ''\n        };\n    }\n\n    componentDidMount() {\n        socket.on('init', this.initialize.bind(this));\n        socket.on('send:message', this.messageRecieve.bind(this));\n        socket.on('user:join', this.userJoined.bind(this));\n        socket.on('user:left', this.userLeft.bind(this));\n        socket.on('change:name', this.userChangedName.bind(this));\n    }\n\n    initialize(data) {\n        let {users, name} = data;\n        this.setState({users, user: name});\n    }\n\n    messageRecieve(message) {\n        let {messages} = this.state;\n\n        this.setState({\n            messages: [\n                ...messages,\n                message\n            ]\n        });\n    }\n\n    userJoined(data) {\n        let {users, messages} = this.state;\n        let {name} = data;\n\n        this.setState({\n            users: [\n                users,\n                name\n            ],\n            messages: [\n                ...messages,\n                {\n                    user: 'APPLICATION BOT',\n                    text : name +' Joined'\n                }\n            ]\n        });\n    }\n\n    userLeft(data) {\n        let {users, messages} = this.state;\n        let {name} = data;\n        let index = users.indexOf(name);\n        users.splice(index, 1);\n\n        this.setState({\n            users: [\n                ...users\n            ],\n            messages: [\n                ...messages,\n                {\n                    user: 'APPLICATION BOT',\n                    text : name +' Left'\n                }\n            ]\n        });\n    }\n\n    userChangedName(data) {\n        let {oldName, newName} = data;\n        let {users, messages} = this.state;\n        let index = users.indexOf(oldName);\n        users.splice(index, 1, newName);\n\n        this.setState({\n            users: [\n                ...users\n            ],\n            messages: [\n                ...messages,\n                {\n                    user: 'APPLICATION BOT',\n                    text : 'Change Name : ' + oldName + ' ==> '+ newName\n                }\n            ]\n        });\n    }\n\n    onMessageSubmit(message) {\n        let {messages} = this.state;\n\n        this.setState({\n            messages: [\n                ...messages,\n                message\n            ]\n        });\n        socket.emit('send:message', message);\n    }\n\n    onChangeName(newName) {\n        let oldName = this.state.user;\n        let {messages} = this.state;\n\n        socket.emit('change:name', { name : newName}, (result) => {\n            if(!result) {\n                return alert('There was an error changing your name');\n            }\n            let {users} = this.state;\n            let index = users.indexOf(oldName);\n            users.splice(index, 1, newName);\n\n            messages = messages.map((message) => {\n                if(message.user === oldName) {\n                    return Object.assign({}, message, {\n                        user: newName\n                    });\n                } else {\n                    return message;\n                }\n            });\n\n            this.setState({\n                users: [\n                    ...users\n                ],\n                user: newName,\n                messages\n            });\n        });\n    }\n\n    render() {\n        return (\n            <div>\n                <UsersList\n                    users={this.state.users}\n                />\n                <MessageList\n                    messages={this.state.messages}\n                />\n                <MessageForm\n                    onMessageSubmit={this.onMessageSubmit}\n                    user={this.state.user}\n                />\n                <ChangeNameForm\n                    onChangeName={this.onChangeName}\n                />\n            </div>\n        );\n    }\n}\nexport default Page;\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/pages/chat/Page.jsx","import React, { Component, PropTypes } from 'react'\nimport { connect } from 'react-redux'\nimport { List } from 'immutable';\nimport Base from '../Base.jsx';\nimport { addTodo, completeTodo, setVisibilityFilter, VisibilityFilters } from '../../actions/todo'\nimport AddTodo from '../../components/todo/AddTodo'\nimport TodoList from '../../components/todo/TodoList'\nimport Footer from '../../components/todo/Footer';\nimport Tabs, { TabTitle, TabPanel } from '../../components/common/Tab';\n\nclass Page extends Base {\n    constructor(props, context) {\n        super(props, context);\n    }\n\n    componentDidMount(){\n        console.log(this.context.$appConfig.user);\n\n        this.emit('test');\n    }\n\n    render() {\n        // Injected by connect() call:\n        const { dispatch, visibleTodos, visibilityFilter } = this.props\n        return (\n            <div>\n                <AddTodo\n                    onAddClick={text =>\n                        dispatch(addTodo(text))\n                    } />\n                <TodoList\n                    todos={visibleTodos}\n                    onTodoClick={index =>\n                        dispatch(completeTodo(index))\n                    } />\n                <Footer\n                    filter={visibilityFilter}\n                    onFilterChange={nextFilter =>\n                        dispatch(setVisibilityFilter(nextFilter))\n                    } />\n                <Tabs defaultSelectedTab=\"1\">\n                    <TabTitle label=\"1\">\n                        tab1\n                    </TabTitle>\n                    <TabTitle label=\"2\">\n                        tab2\n                    </TabTitle>\n                    <TabPanel for=\"1\">\n                        TabContent1\n                    </TabPanel>\n                    <TabPanel for=\"2\">\n                        TabContent2\n                    </TabPanel>\n                </Tabs>\n            </div>\n        )\n    }\n}\n\nPage.propTypes = {\n    visibleTodos: PropTypes.instanceOf(List).isRequired,\n    visibilityFilter: PropTypes.oneOf([\n        'SHOW_ALL',\n        'SHOW_COMPLETED',\n        'SHOW_ACTIVE'\n    ]).isRequired\n};\nPage.contextTypes = {\n    $appConfig: PropTypes.object,\n    $eventBus: PropTypes.object\n};\n\nfunction selectTodos(todos, filter) {\n    switch (filter) {\n        case VisibilityFilters.SHOW_ALL:\n            return todos\n        case VisibilityFilters.SHOW_COMPLETED:\n            return todos.filter(todo => todo.get('completed'))\n        case VisibilityFilters.SHOW_ACTIVE:\n            return todos.filter(todo => !todo.get('completed'))\n    }\n}\n\n// Which props do we want to inject, given the global state?\n// Note: use https://github.com/faassen/reselect for better performance.\nfunction select(state) {\n    return {\n        visibleTodos: selectTodos(state.get('todos'), state.get('visibilityFilter')),\n        visibilityFilter: state.get('visibilityFilter')\n    }\n}\n\n// 包装 component ，注入 dispatch 和 state 到其默认的 connect(select)(App) 中；\nexport default connect(select)(Page);\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/pages/todo/Todo.jsx","\r\nimport { combineReducers } from 'redux';\r\n\r\nexport default function text(state = 'test'){\r\n    return state;\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/reducers/about.js","// import { combineReducers } from 'redux'\nimport Immutable from 'immutable';\nimport { combineReducers } from 'redux-immutablejs';\nimport {\n  SELECT_REDDIT, INVALIDATE_REDDIT,\n  REQUEST_POSTS, RECEIVE_POSTS\n} from '../actions/async'\n\nfunction selectedReddit(state = 'reactjs', action) {\n  switch (action.type) {\n    case SELECT_REDDIT:\n      return action.reddit\n    default:\n      return state\n  }\n}\n\nfunction posts(state = new Immutable.Map({\n  isFetching: false,\n  didInvalidate: false,\n  items: new Immutable.List()\n}), action) {\n  switch (action.type) {\n    case INVALIDATE_REDDIT:\n      return state.set('didInvalidate', true)\n    case REQUEST_POSTS:\n      return state.merge({\n        isFetching: true,\n        didInvalidate: false\n      });\n    case RECEIVE_POSTS:\n      return state.merge({\n        isFetching: false,\n        didInvalidate: false,\n        items: action.posts,\n        lastUpdated: action.receivedAt\n      });\n    default:\n      return state\n  }\n}\n\nfunction postsByReddit(state = new Immutable.Map(), action) {\n  switch (action.type) {\n    case INVALIDATE_REDDIT:\n    case RECEIVE_POSTS:\n    case REQUEST_POSTS:\n      return state.set(action.reddit, posts(state[action.reddit], action));\n    default:\n      return state\n  }\n}\n\nconst rootReducer = combineReducers({\n  postsByReddit,\n  selectedReddit\n})\n\nexport default rootReducer\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/reducers/async.js","import { combineReducers } from 'redux';\nimport about from './about';\nimport vote from './vote';\n\nconst rootReducer = combineReducers({\n    about,\n    vote\n});\n\nexport default rootReducer;\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/reducers/spaReducers.js","// import { combineReducers } from 'redux'\nimport { List, Map } from 'immutable';\nimport { combineReducers } from 'redux-immutablejs';\nimport { ADD_TODO, COMPLETE_TODO, SET_VISIBILITY_FILTER, VisibilityFilters } from '../actions/todo'\nconst { SHOW_ALL } = VisibilityFilters\n\nfunction visibilityFilter(state = SHOW_ALL, action) {\n    switch (action.type) {\n        case SET_VISIBILITY_FILTER:\n            return action.filter\n        default:\n            return state\n    }\n}\n\nfunction todos(state = new List(), action) {\n    switch (action.type) {\n        case ADD_TODO:\n            return state.push(new Map({\n                    text: action.text,\n                    completed: false\n                }))\n        case COMPLETE_TODO:\n            return state.update(action.index, function(item){\n                return item.set('completed', true);\n            });\n        default:\n            return state\n    }\n}\n\nconst todoApp = combineReducers({\n    visibilityFilter,\n    todos\n})\n\nexport default todoApp\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/reducers/todo.js","import * as ACTIONS from '../actions/vote';\n\n\nexport default function Vote(state = {}, action = {}) {\n    switch (action.type) {\n        case ACTIONS.LOAD_VOTE_SUCCESS:\n            return action.payload;\n        default:\n            return state;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/reducers/vote.js","import React from 'react';\r\nimport { Route, IndexRoute } from 'react-router';\r\n\r\nimport connectDataFetchers from './utils/connectDataFetchers';\r\nimport App from './pages/App/App';\r\n// import Vote from './universalPage/Vote';\r\nimport About from './pages/App/About';\r\n\r\n// require.ensure polyfill for node\r\nif (typeof require.ensure !== 'function') {\r\n    require.ensure = function requireModule(deps, callback) {\r\n        callback(require);\r\n    };\r\n}\r\n\r\nfunction onChange(prevState, nextState, replace, cb){\r\n    let lastRoute = nextState.routes[nextState.routes.length - 1];\r\n\r\n    if(lastRoute.component) {\r\n        let component = lastRoute.component.WrappedComponent;\r\n        let location = nextState.location;\r\n        let pageComponent = component.OriginalPage ? component.OriginalPage : component;\r\n\r\n        Object.assign(window.__APP_CONFIG__, {\r\n            pageId: location.query.pageId || (pageComponent.pageConfig && pageComponent.pageConfig.pageId)\r\n        });\r\n    }\r\n\r\n    cb();\r\n}\r\n\r\n\r\nexport default (store) => {\r\n    const requireAuth = (nextState, replace, callback) => {\r\n        const { user: { authenticated }} = store.getState();\r\n        if (!authenticated) {\r\n            replace({\r\n                pathname: '/login',\r\n                state: { nextPathname: nextState.location.pathname }\r\n            });\r\n        }\r\n        callback();\r\n    };\r\n\r\n    const redirectAuth = (nextState, replace, callback) => {\r\n        const { user: { authenticated }} = store.getState();\r\n        if (authenticated) {\r\n            replace({\r\n                pathname: '/'\r\n            });\r\n        }\r\n        callback();\r\n    };\r\n    return (\r\n        <Route path=\"/\" component={App} onChange={ onChange }>\r\n            <IndexRoute getComponent={(nextState, cb) => {\r\n                require.ensure([], require => {\r\n                    cb(null, require('./pages/App/Vote').default);\r\n                }, 'Vote');\r\n            }}/>\r\n            <Route path=\"vote\" getComponent={(nextState, cb) => {\r\n                require.ensure([], require => {\r\n                    cb(null, require('./pages/App/Vote').default);\r\n                }, 'Vote');\r\n            }}/>\r\n            <Route path=\"about\" component={About} />\r\n        </Route>\r\n    );\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/routes.js","import { createStore, applyMiddleware, compose } from 'redux';\r\nimport thunk from 'redux-thunk';\r\n\r\nif(process.env.NODE_ENV !== 'production' && process.browser){\r\n    var createLogger = require('redux-logger');\r\n}\r\n\r\nconst middlewareBuilder = () => {\r\n    let middleware = applyMiddleware(thunk);\r\n\r\n    if(process.env.NODE_ENV !== 'production' && process.browser){\r\n        if(!window.devToolsExtension) {\r\n            middleware = applyMiddleware(thunk, createLogger());\r\n        }\r\n    }\r\n\r\n    let allComposeElements = [\r\n        middleware\r\n    ];\r\n\r\n    if(process.env.NODE_ENV !== 'production' && process.browser){\r\n        if(window.devToolsExtension){\r\n            allComposeElements.push(window.devToolsExtension());\r\n        }\r\n    }\r\n\r\n    return allComposeElements;\r\n};\r\n\r\nconst finalCreateStore = compose(...middlewareBuilder())(createStore);\r\n\r\nexport default function configureStore(initialState, rootReducer) {\r\n    const store = finalCreateStore(rootReducer, initialState);\r\n\r\n    return store;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/store/index.js","import { createStore, applyMiddleware, compose } from 'redux';\r\n// import { routerMiddleware } from 'react-router-redux';\r\nimport thunk from 'redux-thunk';\r\nimport rootReducer from '../reducers/spaReducers';\r\n\r\nif(process.env.NODE_ENV !== 'production' && process.browser){\r\n    var createLogger = require('redux-logger');\r\n}\r\n\r\nexport default function configureStore(initialState, history) {\r\n    const middleware = [\r\n        thunk\r\n    ];\r\n    let store;\r\n\r\n    if (process.browser) {\r\n        if(process.env.NODE_ENV !== 'production') {\r\n            middleware.push(createLogger());\r\n\r\n            store = createStore(rootReducer, initialState, compose(\r\n                applyMiddleware(...middleware),\r\n                typeof window.devToolsExtension !== 'undefined' ? window.devToolsExtension() : f => f\r\n            ));\r\n        } else {\r\n            store = createStore(rootReducer, initialState, compose(\r\n                applyMiddleware(...middleware)\r\n            ));\r\n        }\r\n\r\n    } else {\r\n        store = createStore(rootReducer, initialState, compose(applyMiddleware(...middleware), f => f));\r\n    }\r\n\r\n    if (module.hot) {\r\n        // Enable Webpack hot module replacement for reducers\r\n        module.hot.accept('../reducers/spaReducers', () => {\r\n            const nextReducer = require('../reducers/spaReducers');\r\n            store.replaceReducer(nextReducer);\r\n        });\r\n    }\r\n\r\n    return store;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/store/spaStore.js","import React, {\r\n    PropTypes\r\n} from 'react';\r\nimport Base from '../pages/Base';\r\n\r\nlet IS_FIRST_MOUNT_AFTER_LOAD = true;\r\nif (process.browser) {\r\n    var FIRST_PAGE_ID = window.__APP_CONFIG__.pageId;\r\n}\r\n\r\nexport default function connectDataFetchers(actionCreators, cache) {\r\n    return function (Page) {\r\n        if (process.browser) {\r\n            if (!Page.pageConfig) {\r\n                console.error(`Page Component static propery pageConfig.pageId required!`);\r\n            } else {\r\n                IS_FIRST_MOUNT_AFTER_LOAD = Page.pageConfig.pageId === FIRST_PAGE_ID;\r\n            }\r\n        }\r\n\r\n        class DataFetchersWrapper extends Base {\r\n            static propTypes = {\r\n                dispatch: PropTypes.func.isRequired,\r\n                params: PropTypes.object,\r\n                location: PropTypes.shape({\r\n                    pathname: PropTypes.string.required,\r\n                    search: PropTypes.string,\r\n                    query: PropTypes.string.object\r\n                }).isRequired\r\n            };\r\n\r\n            static contextTypes = {\r\n                $appConfig: PropTypes.object\r\n            };\r\n\r\n            static OriginalPage = Page;\r\n\r\n            static fetchData({\r\n                dispatch,\r\n                location,\r\n                params,\r\n                appConfig,\r\n                pageConfig\r\n            }, req) {\r\n                return Promise.all(\r\n                    actionCreators.map(actionCreator => dispatch(actionCreator({\r\n                        dispatch,\r\n                        location,\r\n                        params,\r\n                        appConfig,\r\n                        pageConfig\r\n                    }, req)))\r\n                );\r\n            }\r\n\r\n            shouldComponentUpdate(nextProps) {\r\n                return this.props !== nextProps;\r\n            }\r\n\r\n            componentDidUpdate(prevProps) {\r\n                const {\r\n                    location\r\n                } = this.props;\r\n                const {\r\n                    location: prevLocation\r\n                } = prevProps;\r\n\r\n                const isUrlChanged = (location.pathname !== prevLocation.pathname) ||\r\n                    (location.search.slice(1) !== prevLocation.search.slice(1));\r\n\r\n                if (isUrlChanged) {\r\n                    this._fetchDataOnClient();\r\n                }\r\n            }\r\n\r\n            componentDidMount() {\r\n                if (!cache) {\r\n                    if (!IS_FIRST_MOUNT_AFTER_LOAD) {\r\n                        this._fetchDataOnClient();\r\n                    }\r\n\r\n                    IS_FIRST_MOUNT_AFTER_LOAD = false;\r\n                } else {\r\n                    if (!IS_FIRST_MOUNT_AFTER_LOAD && !Page.DATA_LOADED) {\r\n                        this._fetchDataOnClient();\r\n                    }\r\n\r\n                    Page.DATA_LOADED = true;\r\n                    IS_FIRST_MOUNT_AFTER_LOAD = false;\r\n                }\r\n            }\r\n\r\n            _fetchDataOnClient() {\r\n                this.constructor.fetchData({\r\n                    dispatch: this.props.dispatch,\r\n                    params: this.props.params,\r\n                    location: this.props.location,\r\n                    appConfig: this.context.$appConfig\r\n                });\r\n            }\r\n\r\n            render() {\r\n                return ( \r\n                    <Page {...this.props }/>\r\n                );\r\n            }\r\n        }\r\n\r\n        return DataFetchersWrapper;\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/utils/connectDataFetchers.js","// modified\r\n/**\r\n * Copyright (c) 2013-present, Facebook, Inc.\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree. An additional grant\r\n * of patent rights can be found in the PATENTS file in the same directory.\r\n *\r\n * @typechecks\r\n *\r\n */\r\n\r\n/*eslint-disable no-self-compare */\r\n\r\n'use strict';\r\n\r\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\r\n\r\n/**\r\n * inlined Object.is polyfill to avoid requiring consumers ship their own\r\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\r\n */\r\nfunction is(x, y) {\r\n    // SameValue algorithm\r\n    if (x === y) {\r\n        return true;\r\n    } else {\r\n        if(typeof x === 'function' && typeof y === 'function'){\r\n            return x.toString() === y.toString();\r\n        }\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n * Performs equality by iterating through keys on an object and returning false\r\n * when any key has values which are not strictly equal between the arguments.\r\n * Returns true when the values of all keys are strictly equal.\r\n */\r\nfunction shallowEqual(objA, objB) {\r\n    if (is(objA, objB)) {\r\n        return true;\r\n    }\r\n\r\n    if (typeof objA !== 'object' || objA === null || typeof objB !== 'object' || objB === null) {\r\n        return false;\r\n    }\r\n\r\n    var keysA = Object.keys(objA);\r\n    var keysB = Object.keys(objB);\r\n\r\n    if (keysA.length !== keysB.length) {\r\n        return false;\r\n    }\r\n\r\n    // Test for A's keys different from B.\r\n    for (var i = 0; i < keysA.length; i++) {\r\n        if (!hasOwnProperty.call(objB, keysA[i]) || !is(objA[keysA[i]], objB[keysA[i]])) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nmodule.exports = shallowEqual;\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/common/utils/shallowEqual.js","import { Router } from 'express';\r\n\r\nlet router = new Router();\r\n\r\nrouter.post('/ajax', function(req, res, next){\r\n    if(error) {\r\n        next();\r\n    } else {\r\n        res.send('test')\r\n    }\r\n});\r\n\r\nexport default router;\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/server/apis/index.js","import React from 'react';\nimport fetch from 'isomorphic-fetch';\nimport rootReducer from '../../common/reducers/async';\nimport Page from '../../common/pages/async/Page.jsx';\n\nmodule.exports = async function (req, res, next) {\n    let state = {\n        postsByReddit: {},\n        selectedReddit: 'reactjs'\n    };\n\n    try {\n        let response = await fetch(`https://www.reddit.com/r/${state.selectedReddit}.json`, {\n            method: 'GET',\n            timeout: 5000\n        }).then(response => response.json());\n\n        state.postsByReddit[state.selectedReddit] = {\n            didInvalidate: false,\n            isFetching: false,\n            lastUpdated: Date.now(),\n            items: response.data.children.map(child => child.data)\n        };\n\n    } catch(ex){\n        console.error(ex);\n    }\n\n    res.renderReactHTML({\n        component: <Page/>,\n        locals: {\n            appName: 'async',\n            title: 'async page'\n        },\n        data: state,\n        rootReducer\n    });\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/server/controllers/async.js","import React from 'react';\r\nimport Page from '../../common/pages/chat/Page';\r\nimport fs from 'fs';\r\n\r\nlet template = fs.readFileSync(__dirname + '/../views/chat.html', 'utf8');\r\nlet fakeData = {\r\n\r\n};\r\n\r\nmodule.exports = function (req, res, next) {\r\n    res.renderReactHTML({\r\n        template,\r\n        component: <Page/>,\r\n        locals: {\r\n            appName: 'chat',\r\n            title: 'chat page'\r\n        },\r\n        data: fakeData,\r\n        needTransform: false\r\n    });\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/server/controllers/chat.js","import React from 'react';\nimport rootReducer from '../../common/reducers/todo';\nimport Page from '../../common/pages/todo/Todo';\n\nlet fakeData = {\n    visibilityFilter: 'SHOW_ALL',\n    todos: [\n        {\n            text: 'one',\n            completed: false\n        },\n        {\n            text: 'two',\n            completed: true\n        }\n    ]\n};\n\nmodule.exports = function (req, res, next) {\n    res.renderReactHTML({\n        component: <Page/>,\n        locals: {\n            appName: 'todo',\n            title: 'todo page'\n        },\n        data: fakeData,\n        rootReducer,\n        pageConfig: {\n            user: 'test'\n        }\n    });\n};\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/server/controllers/todo.js","\r\nexport default function allowCrossDomain(req, res, next) {\r\n    let allowedOrigins = [\r\n        'http://www.test.com'\r\n    ];\r\n    let origin = req.headers.origin;\r\n    if(allowedOrigins.indexOf(origin) > -1){\r\n        res.header('Access-Control-Allow-Origin', origin);\r\n    }\r\n    next();\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/server/middlewares/allowCrossDomain.js","import React from 'react';\nimport {renderToString} from 'react-dom/server';\nimport {createMemoryHistory, match, RouterContext} from 'react-router';\nimport {Provider} from 'react-redux';\nimport createRoutes from '../../common/routes';\nimport configureStore from '../../common/store/spaStore';\nimport preRenderMiddleware from '../utils/preRender';\nimport ejs from 'ejs';\nimport config from '../config/config.json';\nimport { getDefaultJSVersion } from './renderReactMiddleware';\nimport App from '../../common/App.jsx';\nimport { jsObj as safeJSON } from 'secure-filters';\nimport fs from 'fs';\n\nconst defaultTemplate = fs.readFileSync(__dirname + '/../views/index.html', 'utf8');\n\n\nexport default function renderMatch(req, res) {\n    const history = createMemoryHistory();\n    const store = configureStore({\n        user: {}\n    }, history);\n    let appConfig = {\n        time: Date.now()\n    };\n    const routes = createRoutes(store, appConfig);\n\n    match({routes, location: req.originalUrl}, async function (err, redirect, props){\n        if (err) {\n            res.status(500).json(err);\n        } else if (redirect) {\n            res.redirect(302, redirect.pathname + redirect.search);\n        } else if (props) {\n            let debug = req.query.debug && (req.query.debug === config.application.debugName);\n            let version = config.application.version;\n            let jsVersion = '';\n            // prefer config version, useful when using CDN config\n            if (process.env.NODE_ENV === 'production') {\n                jsVersion = version && version.js;\n            } else {\n                jsVersion = getDefaultJSVersion('app');\n            }\n            let initialState = {};\n            let componentHTML = '';\n            let errorMsg = '';\n\n            try {\n                await preRenderMiddleware(store.dispatch, props, appConfig, req);\n\n                componentHTML = renderToString(\n                    <Provider store={store}>\n                        <App appConfig={ appConfig }>\n                            <RouterContext {...props} />\n                        </App>\n                    </Provider>\n                );\n\n                initialState = store.getState();\n\n            } catch(ex){\n                errorMsg = ex.stack;\n                console.log(ex.stack)\n            }\n\n            let pageStr = ejs.render(defaultTemplate, Object.assign({\n                errorMsg,\n                html: componentHTML,\n                state: safeJSON(initialState),\n                appName: 'app',\n                title: '游戏中心',\n                test: process.env.NODE_ENV !== 'production',\n                debug: debug,\n                appConfig: safeJSON(appConfig),\n                version: {\n                    js: jsVersion,\n                    css: version && version.css\n                }\n            }, {}), {\n                compileDebug: false\n            });\n\n            res.status(200).send(pageStr);\n\n        } else {\n            res.redirect('/');\n        }\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/server/middlewares/spaRenderMatch.js","import { Router } from 'express';\nimport fs from 'fs';\n\nlet router = new Router();\n\nimport IndexPage from '../controllers/todo';\nimport AsyncPage from '../controllers/async';\nimport ChatPage from '../controllers/chat';\n\n\n/**\n * 首页请求\n */\nrouter.get('/', IndexPage);\nrouter.get('/async', AsyncPage);\nrouter.get('/chat', ChatPage);\n\n\n/**\n * 静态资源\n */\nlet content = fs.readFileSync(__dirname + '/../../client/js/utils/sw.js', 'utf8');\n\nrouter.get('/sw.js', async function(req, res){\n    res.set('Content-Type', 'application/javascript');\n    res.send(content);\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/server/routes/index.js","// Keep track of which names are used so that there are no duplicates\r\nlet userNames = (function () {\r\n    let names = {};\r\n\r\n    let claim = function (name) {\r\n        if (!name || names[name]) {\r\n            return false;\r\n        } else {\r\n            names[name] = true;\r\n            return true;\r\n        }\r\n    };\r\n\r\n    // find the lowest unused \"guest\" name and claim it\r\n    let getGuestName = function () {\r\n        let name,\r\n            nextUserId = 1;\r\n\r\n        do {\r\n            name = 'Guest ' + nextUserId;\r\n            nextUserId += 1;\r\n        } while (!claim(name));\r\n\r\n        return name;\r\n    };\r\n\r\n    // serialize claimed names as an array\r\n    let get = function () {\r\n        let res = [];\r\n        for (let user in names) {\r\n            res.push(user);\r\n        }\r\n\r\n        return res;\r\n    };\r\n\r\n    let free = function (name) {\r\n        if (names[name]) {\r\n            delete names[name];\r\n        }\r\n    };\r\n\r\n    return {\r\n        claim: claim,\r\n        free: free,\r\n        get: get,\r\n        getGuestName: getGuestName\r\n    };\r\n}());\r\n\r\n// export function for listening to the socket\r\nexport default function (socket) {\r\n    let name = userNames.getGuestName();\r\n\r\n    // send the new user their name and a list of users\r\n    socket.emit('init', {\r\n        name: name,\r\n        users: userNames.get()\r\n    });\r\n\r\n    // notify other clients that a new user has joined\r\n    socket.broadcast.emit('user:join', {\r\n        name: name\r\n    });\r\n\r\n    // broadcast a user's message to other users\r\n    socket.on('send:message', function (data) {\r\n        socket.broadcast.emit('send:message', {\r\n            user: name,\r\n            text: data.text\r\n        });\r\n    });\r\n\r\n    // validate a user's name change, and broadcast it on success\r\n    socket.on('change:name', function (data, fn) {\r\n        if (userNames.claim(data.name)) {\r\n            let oldName = name;\r\n            userNames.free(oldName);\r\n\r\n            name = data.name;\r\n\r\n            socket.broadcast.emit('change:name', {\r\n                oldName: oldName,\r\n                newName: name\r\n            });\r\n\r\n            fn(true);\r\n        } else {\r\n            fn(false);\r\n        }\r\n    });\r\n\r\n    // clean up when a user leaves, and broadcast it to other users\r\n    socket.on('disconnect', function () {\r\n        socket.broadcast.emit('user:left', {\r\n            name: name\r\n        });\r\n        userNames.free(name);\r\n    });\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/server/sockets/socket.js","function preRenderMiddleware(dispatch, { components, location, params }, appConfig = {}, req) {\r\n    const promises = components.map((current) => {\r\n        if(!current) return null;\r\n\r\n        const component = current.WrappedComponent ? current.WrappedComponent : current;\r\n        const pageConfig = component.OriginalPage && component.OriginalPage.pageConfig;\r\n\r\n        return component.fetchData ? component.fetchData({ dispatch, location, params, appConfig, pageConfig }, req) : null;\r\n    });\r\n\r\n    let lastComponent = components[components.length - 1].WrappedComponent ? components[components.length - 1].WrappedComponent : components[components.length - 1];\r\n    appConfig.pageId = lastComponent && lastComponent.OriginalPage && lastComponent.OriginalPage.pageConfig && lastComponent.OriginalPage.pageConfig.pageId;\r\n\r\n    return Promise.all(promises);\r\n}\r\n\r\nexport default preRenderMiddleware;\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/isomorphic-react-redux-starter/server/utils/preRender.js","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 58\n// module chunks = 0","module.exports = require(\"classnames\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"classnames\"\n// module id = 59\n// module chunks = 0","module.exports = require(\"compression\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"compression\"\n// module id = 60\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 61\n// module chunks = 0","module.exports = require(\"csurf\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"csurf\"\n// module id = 62\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 63\n// module chunks = 0","module.exports = require(\"helmet\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"helmet\"\n// module id = 64\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 65\n// module chunks = 0","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 66\n// module chunks = 0","module.exports = require(\"socket.io\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"socket.io\"\n// module id = 67\n// module chunks = 0"],"sourceRoot":""}