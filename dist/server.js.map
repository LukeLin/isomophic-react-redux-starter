{"version":3,"sources":["webpack:///webpack/bootstrap 4ac212195c235d9328a1","webpack:///./server/app.js","webpack:///external \"react\"","webpack:///./common/pages/Base.jsx","webpack:///external \"immutable\"","webpack:///external \"react-redux\"","webpack:///external \"react-immutable-proptypes\"","webpack:///external \"redux\"","webpack:///external \"express\"","webpack:///external \"fs\"","webpack:///external \"react-router\"","webpack:///./common/pages/async/actions.js","webpack:///./common/pages/index/indexActions.js","webpack:///./server/config/config.json","webpack:///./~/redux-logger/lib/helpers.js","webpack:///external \"events\"","webpack:///external \"isomorphic-fetch\"","webpack:///external \"react-dom/server\"","webpack:///external \"redux-immutablejs\"","webpack:///external \"redux-thunk\"","webpack:///./common/App.jsx","webpack:///./common/components/async/Picker.jsx","webpack:///./common/components/async/Posts.jsx","webpack:///./common/components/chat/ChangeNameForm.jsx","webpack:///./common/components/chat/Messages.jsx","webpack:///./common/components/chat/UsersList.jsx","webpack:///./common/components/common/Tab.jsx","webpack:///./common/components/index/AddTodo.jsx","webpack:///./common/components/index/Footer.jsx","webpack:///./common/components/index/Todo.jsx","webpack:///./common/components/index/TodoList.jsx","webpack:///./common/middleware/preRenderMiddleware.js","webpack:///./common/pages/async/Page.jsx","webpack:///./common/pages/async/reducers.js","webpack:///./common/pages/chat/Page.jsx","webpack:///./common/pages/index/index.jsx","webpack:///./common/pages/index/indexReducers.js","webpack:///./common/routes.js","webpack:///./common/store/index.js","webpack:///./common/store/universalStore.js","webpack:///./common/universalPage/About.jsx","webpack:///./common/universalPage/App.jsx","webpack:///./common/universalPage/reducers/about.js","webpack:///./common/universalPage/reducers/index.js","webpack:///./common/universalPage/reducers/vote.js","webpack:///./common/utils/shallowEqual.js","webpack:///./server/apis/index.js","webpack:///./server/controllers/async.js","webpack:///./server/controllers/chat.js","webpack:///./server/controllers/index.js","webpack:///./server/routes/index.js","webpack:///./server/sockets/socket.js","webpack:///./server/utils/allowCrossDomain.js","webpack:///./server/utils/renderReactMiddleware.jsx","webpack:///./server/utils/universialRenderMatch.js","webpack:///./~/deep-diff/index.js","webpack:///./~/redux-logger/lib/core.js","webpack:///./~/redux-logger/lib/defaults.js","webpack:///./~/redux-logger/lib/diff.js","webpack:///./~/redux-logger/lib/index.js","webpack:///external \"body-parser\"","webpack:///external \"classnames\"","webpack:///external \"compression\"","webpack:///external \"cookie-parser\"","webpack:///external \"csurf\"","webpack:///external \"ejs\"","webpack:///external \"express-session\"","webpack:///external \"helmet\"","webpack:///external \"http\"","webpack:///external \"morgan\"","webpack:///external \"secure-filters\"","webpack:///external \"socket.io\""],"names":["app","set","IP","PORT","disable","use","contentSecurityPolicy","frameguard","noSniff","xssFilter","hsts","json","urlencoded","extended","resave","secret","key","saveUninitialized","cookie","httpOnly","static","__dirname","maxAge","req","res","next","locals","csrftoken","csrfToken","transformer","data","fromJS","err","console","dir","status","error","stack","render","message","process","on","reason","p","warn","server","createServer","io","require","listen","sockets","get","address","port","log","serverName","eventMatchReg","getEventMethodsProps","instance","methods","Object","getOwnPropertyNames","filter","prop","test","instancePrototype","getPrototypeOf","prototype","concat","Base","constructor","props","context","__eventNames","__bindFunctions","funcBinded","bind","eventName","fn","Error","push","$eventBus","addListener","emit","args","off","events","index","indexOf","removeListener","splice","length","_reactInternalInstance","getName","name","shouldComponentUpdate","nextProps","nextState","shouldUpdate","state","componentWillUnmount","hasOwnProperty","contextTypes","instanceOf","selectReddit","invalidateReddit","fetchPostsIfNeeded","REQUEST_POSTS","RECEIVE_POSTS","SELECT_REDDIT","INVALIDATE_REDDIT","reddit","type","requestPosts","receivePosts","posts","children","map","child","receivedAt","Date","now","fetchPosts","dispatch","response","method","timeout","then","ex","shouldFetchPosts","getState","addTodo","completeTodo","setVisibilityFilter","ADD_TODO","COMPLETE_TODO","SET_VISIBILITY_FILTER","VisibilityFilters","SHOW_ALL","SHOW_COMPLETED","SHOW_ACTIVE","text","mediator","App","getChildContext","$appConfig","appConfig","componentDidMount","componentDidUpdate","Children","only","defaultProps","propTypes","object","childContextTypes","Picker","onChange","e","target","value","options","option","arrayOf","string","isRequired","func","Posts","post","i","list","ChangeNameForm","newName","onKey","setState","onSubmit","preventDefault","onChangeName","Message","user","MessageList","messages","MessageForm","onMessageSubmit","UsersList","users","Tabs","selectedTab","defaultSelectedTab","firstTabLabel","onSelect","activeStyle","activeLinkStyle","defaultActiveStyle","tab","rest","findFirstTabLabel","forEach","label","className","style","fontWeight","TabTitle","isActive","clsNames","active","styles","visible","display","hidden","TabPanel","assign","displayStyle","for","AddTodo","onClick","node","refs","input","trim","onAddClick","Footer","renderFilter","onFilterChange","oneOf","completed","textDecoration","cursor","uncompleted","Todo","bool","TodoList","todos","todo","onTodoClick","listOf","contains","defaultFetchData","Promise","resolve","preRenderMiddleware","routes","location","params","matchedRoute","fetchDataHandler","fetchData","AsyncPage","selectedReddit","componentWillReceiveProps","onHandleChange","nextReddit","onHandleRefreshClick","isFetching","lastUpdated","isEmpty","size","defaultOptions","toLocaleTimeString","hour12","opacity","List","number","mapStateToProps","postsByReddit","Map","items","action","didInvalidate","merge","rootReducer","browser","socket","connect","Page","initialize","messageRecieve","userJoined","userLeft","userChangedName","oldName","result","alert","visibleTodos","visibilityFilter","nextFilter","selectTodos","select","update","item","todoApp","ensure","requireModule","deps","callback","store","requireAuth","replace","authenticated","pathname","nextPathname","redirectAuth","cb","default","configureStore","createLogger","middlewareBuilder","middleware","window","devToolsExtension","allComposeElements","finalCreateStore","initialState","history","f","module","hot","accept","nextReducer","replaceReducer","About","about","vote","is","x","y","toString","shallowEqual","objA","objB","keysA","keys","keysB","call","exports","router","send","renderReactHTML","component","appName","title","template","readFileSync","fakeData","needTransform","pageConfig","content","userNames","getGuestName","broadcast","claim","free","names","nextUserId","allowCrossDomain","allowedOrigins","origin","headers","header","reactRender","defaultTemplate","getDefaultJSVersion","webpackAssets","JSON","parse","middlewareConfig","opts","transformedData","html","debug","query","application","debugName","version","jsVersion","js","finalLocals","jsObj","css","pageStr","compileDebug","renderMatch","isWaiting","isLogin","originalUrl","redirect","search","componentHTML","stringify","catch","sendStatus"],"mappings":"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AsCA;AACHR,iBAAI6W,UAAJ,CAAe,GAAf;AACH;AACJ,MA9CD;AA+CH,E;;;;;;;;;AC1FD;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,EAAC;AACD;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+EAA8E,QAAQ;AACtF;AACA,8EAA6E,QAAQ;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,sBAAqB,gBAAgB;AACrC;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,YAAW;AACX;AACA;AACA,YAAW;AACX;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,QAAO;AACP;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,IAAG;;AAEH;AACA,EAAC;;;;;;;;;;ACraD;;AAEA;AACA;AACA,EAAC;AACD;;AAEA;;AAEA;;AAEA;;AAEA,uCAAsC,uCAAuC,gBAAgB;;AAE7F,mCAAkC,0BAA0B,0CAA0C,gBAAgB,OAAO,kBAAkB,EAAE,aAAa,EAAE,OAAO,wBAAwB,EAAE;;AAEjM,wBAAuB,mGAAmG;;AAE1H;AACA;AACA;AACA,YAAW,2BAA2B;AACtC,YAAW,OAAO;AAClB,YAAW,MAAM;AACjB,YAAW,OAAO;AAClB;AACA,cAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA,iFAAgF;AAChF;;AAEA;AACA;AACA;AACA,0EAAyE;AACzE,QAAO;AACP,iEAAgE;AAChE;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,iHAAgH,gCAAgC;AAChJ;;AAEA;AACA,0GAAyG,sCAAsC;AAC/I;;AAEA;AACA,uGAAsG,4BAA4B;AAClI;;AAEA;AACA,iHAAgH,gCAAgC;AAChJ;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH,E;;;;;;;;;AC/HA;;AAEA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,qC;;;;;;;;;AC7CA;;AAEA;AACA;AACA,EAAC;AACD;;AAEA;;AAEA;;AAEA,uCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA,iDAAgD;AAChD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,MAAK;AACL,IAAG;AACH;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,qC;;;;;;;;;AC1FA;;AAEA,oDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE9P;AACA;AACA,EAAC;;AAED;;AAEA;;AAEA;;AAEA;;AAEA,uCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,2BAA2B;AACtC,YAAW,QAAQ;AACnB,YAAW,QAAQ;AACnB,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB,YAAW,QAAQ;AACnB,YAAW,QAAQ;AACnB,YAAW,QAAQ;AACnB,YAAW,SAAS;AACpB,YAAW,SAAS;AACpB,YAAW,SAAS;AACpB;AACA,cAAa,SAAS;AACtB;AACA;AACA,yEAAwE;;AAExE,kCAAiC;;AAEjC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8FAA6F;AAC7F;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;;AAEA;;AAEA,sDAAqD,kBAAkB,aAAa;AACpF;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qC;;;;;;;;;AChHA,yC;;;;;;;;;ACAA,wC;;;;;;;;;ACAA,yC;;;;;;;;;ACAA,2C;;;;;;;;;ACAA,mC;;;;;;;;;ACAA,iC;;;;;;;;;ACAA,6C;;;;;;;;;ACAA,oC;;;;;;;;;ACAA,kC;;;;;;;;;ACAA,oC;;;;;;;;;ACAA,4C;;;;;;;;;ACAA,uC","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 4ac212195c235d9328a1\n **/","import http from 'http';\r\nimport express from 'express';\r\nimport compress from 'compression';\r\nimport logger from 'morgan';\r\nimport cookieParser from 'cookie-parser';\r\nimport bodyParser from 'body-parser';\r\nimport session from 'express-session';\r\nimport csurf from 'csurf';\r\nimport config from './config/config.json';\r\nimport routes from './routes/index';\r\nimport apis from './apis/index';\r\nimport allowCrossDomain from './utils/allowCrossDomain'\r\nimport reactRender from './utils/renderReactMiddleware';\r\nimport Immutable from 'immutable';\r\nimport helmet from 'helmet';\r\nimport socket from './sockets/socket';\r\nimport universialRenderMatch from './utils/universialRenderMatch';\r\n\r\nlet app = express();\r\n\r\napp.set('host', process.env.IP || '127.0.0.1');\r\napp.set('port', process.env.PORT || 3000);\r\napp.disable('x-powered-by');\r\n\r\napp.use(helmet.contentSecurityPolicy());\r\napp.use(helmet.frameguard());\r\napp.use(helmet.noSniff());\r\napp.use(helmet.xssFilter());\r\napp.use(helmet.hsts());\r\napp.use(compress());\r\napp.use(logger('dev'));\r\napp.use(bodyParser.json());\r\napp.use(bodyParser.urlencoded({ extended: true }));\r\napp.use(cookieParser());\r\napp.use(session({\r\n    resave: true,\r\n    secret: 'mySecretCookieSalt',\r\n    key: 'myCookieSessionId',\r\n    saveUninitialized: true,\r\n    cookie: {\r\n        httpOnly: true,\r\n    }\r\n}));\r\n\r\n// app.use(favicon(__dirname + '/../public/favicon.ico'));\r\napp.use('/static', express.static(__dirname + '/../public', {\r\n    maxAge: 86400000\r\n}));\r\n\r\n// if(process.env.NODE_ENV !== 'production'){\r\n//     let webpack = require('webpack');\r\n//     let config = require('../create-webpack.config')(true);\r\n//     let webpackDevMiddleware = require('webpack-dev-middleware');\r\n//     let webpackHotMiddleware = require('webpack-hot-middleware');\r\n//     let compiler = webpack(config);\r\n//     app.use(webpackDevMiddleware(compiler, { noInfo: true, publicPath: config.output.publicPath }));\r\n//     app.use(webpackHotMiddleware(compiler));\r\n// }\r\n\r\napp.use(allowCrossDomain);\r\n\r\napp.use(csurf());\r\napp.use(function (req, res, next) {\r\n    res.locals.csrftoken = req.csrfToken();\r\n    next();\r\n});\r\napp.use(reactRender({\r\n    transformer: function(data){\r\n        return Immutable.fromJS(data);\r\n    }\r\n}));\r\n\r\napp.use('/', routes);\r\napp.use('/api', apis);\r\napp.use('*', universialRenderMatch);\r\n\r\n// error handlers\r\n// no stacktraces leaked to user\r\napp.use(function(err, req, res, next) {\r\n    console.dir(err);\r\n    res.status(err.status || 500);\r\n    if(err.status === 500) {\r\n        console.error(err.stack);\r\n        res.json({error: 'Internal Server Error'});\r\n    }\r\n    else if(err.status === 404) {\r\n        res.render('error');    //render error page\r\n    } else {\r\n        res.json({error: err.message})\r\n    }\r\n});\r\n\r\n\r\nprocess.on('uncaughtException', err => {\r\n    console.error(err.message + '\\n' + err.stack);\r\n});\r\nprocess.on('unhandledRejection', (reason, p) => {\r\n    console.error(\"Unhandled Rejection at: Promise \", p, \" reason: \", reason);\r\n});\r\nprocess.on('rejectionHandled', (reason, p) => {\r\n    console.warn(\"rejectionHandled at: Promise \", p, \" reason: \", reason);\r\n});\r\n\r\nlet server = http.createServer(app);\r\n\r\n/* Socket.io Communication */\r\nlet io = require('socket.io').listen(server);\r\nio.sockets.on('connection', socket);\r\n\r\nserver.listen(app.get('port'), app.get('host'), function() {\r\n    let { address, port } = server.address();\r\n    console.log(`${ config.serverName } server listening at http://%s:%s`, address, port);\r\n});\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./server/app.js\n **/","module.exports = require(\"react\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"react\"\n ** module id = 1\n ** module chunks = 0\n **/","import React, { PropTypes, Component } from 'react';\r\nimport shallowEqual from '../utils/shallowEqual';\r\nimport EventEmitter from 'events';\r\n\r\nconst eventMatchReg = /^on[A-Z]/;\r\nfunction getEventMethodsProps(instance){\r\n    let methods = Object.getOwnPropertyNames(instance)\r\n        .filter((prop) => {\r\n            return eventMatchReg.test(prop)\r\n                && typeof instance[prop] === 'function';\r\n        });\r\n\r\n    let instancePrototype = Object.getPrototypeOf(instance);\r\n    if(instancePrototype !== Object.prototype) {\r\n        methods = methods.concat(getEventMethodsProps(instancePrototype));\r\n    }\r\n\r\n    return methods\r\n}\r\n\r\n\r\nexport default class Base extends Component {\r\n    constructor(props, context){\r\n        super(props, context);\r\n\r\n        this.__eventNames = {};\r\n\r\n        this.__bindFunctions();\r\n    }\r\n\r\n    __bindFunctions(){\r\n        let props = getEventMethodsProps(this);\r\n        for(let prop of props){\r\n            if(!this[prop].funcBinded){\r\n                this[prop] = this[prop].bind(this);\r\n                this[prop].funcBinded = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    on(eventName, fn){\r\n        if(typeof fn !== 'function') throw new Error('fn should be a function');\r\n\r\n        if(!this.__eventNames[eventName]){\r\n            this.__eventNames[eventName] = [fn];\r\n        } else {\r\n            this.__eventNames[eventName].push(fn);\r\n        }\r\n\r\n        return this.context.$eventBus.addListener(eventName, fn);\r\n    }\r\n\r\n    emit(eventName, ...args){\r\n        return this.context.$eventBus.emit(eventName, ...args);\r\n    }\r\n\r\n    off(eventName, fn){\r\n        let events = this.__eventNames[eventName];\r\n        if(events){\r\n            let index = events.indexOf(fn);\r\n\r\n            if(index >= 0) {\r\n                this.context.$eventBus.removeListener(eventName, fn);\r\n\r\n                events.splice(index, 1);\r\n\r\n                if(!events.length) {\r\n                    delete this.__eventNames[eventName];\r\n                }\r\n            } else {\r\n                console.warn('event: ' + eventName + ' is not registered in ' + this._reactInternalInstance.getName() + ' Component');\r\n            }\r\n\r\n            return true;\r\n        } else {\r\n            console.warn('event: ' + eventName + ' is not registered in ' + this.constructor.name + ' Component');\r\n\r\n            return false;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 检验组件更新\r\n     * @param nextProps\r\n     * @param nextState\r\n     * @returns {*}\r\n     */\r\n    shouldComponentUpdate(nextProps, nextState){\r\n        let shouldUpdate = !shallowEqual(this.props, nextProps) || !shallowEqual(this.state, nextState);\r\n\r\n        if(shouldUpdate && process.env.NODE_ENV !== 'production') {\r\n            console.log('Component: ' + this.constructor.name + ' will update');\r\n        }\r\n\r\n        return shouldUpdate;\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        for(let eventName in this.__eventNames){\r\n            if(this.__eventNames.hasOwnProperty(eventName)){\r\n                for(let fn of this.__eventNames[eventName]){\r\n                    this.off(eventName, fn);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nBase.contextTypes = {\r\n    $eventBus: PropTypes.instanceOf(EventEmitter)\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/pages/Base.jsx\n **/","module.exports = require(\"immutable\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"immutable\"\n ** module id = 3\n ** module chunks = 0\n **/","module.exports = require(\"react-redux\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"react-redux\"\n ** module id = 4\n ** module chunks = 0\n **/","module.exports = require(\"react-immutable-proptypes\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"react-immutable-proptypes\"\n ** module id = 5\n ** module chunks = 0\n **/","module.exports = require(\"redux\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"redux\"\n ** module id = 6\n ** module chunks = 0\n **/","module.exports = require(\"express\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express\"\n ** module id = 7\n ** module chunks = 0\n **/","module.exports = require(\"fs\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"fs\"\n ** module id = 8\n ** module chunks = 0\n **/","module.exports = require(\"react-router\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"react-router\"\n ** module id = 9\n ** module chunks = 0\n **/","import fetch from 'isomorphic-fetch'\r\nimport Immutable from 'immutable';\r\n\r\nexport const REQUEST_POSTS = 'REQUEST_POSTS'\r\nexport const RECEIVE_POSTS = 'RECEIVE_POSTS'\r\nexport const SELECT_REDDIT = 'SELECT_REDDIT'\r\nexport const INVALIDATE_REDDIT = 'INVALIDATE_REDDIT'\r\n\r\nexport function selectReddit(reddit) {\r\n    return {\r\n        type: SELECT_REDDIT,\r\n        reddit\r\n    }\r\n}\r\n\r\nexport function invalidateReddit(reddit) {\r\n    return {\r\n        type: INVALIDATE_REDDIT,\r\n        reddit\r\n    }\r\n}\r\n\r\nfunction requestPosts(reddit) {\r\n    return {\r\n        type: REQUEST_POSTS,\r\n        reddit\r\n    }\r\n}\r\n\r\nfunction receivePosts(reddit, json) {\r\n    return {\r\n        type: RECEIVE_POSTS,\r\n        reddit,\r\n        posts: Immutable.fromJS(json.data.children.map(child => child.data)),\r\n        receivedAt: Date.now()\r\n    }\r\n}\r\n\r\nfunction fetchPosts(reddit) {\r\n    return async function(dispatch) {\r\n        dispatch(requestPosts(reddit))\r\n        try {\r\n            let response = await fetch(`https://www.reddit.com/r/${reddit}.json`, {\r\n                method: 'GET',\r\n                timeout: 5000\r\n            }).then(response => response.json());\r\n            dispatch(receivePosts(reddit, response))\r\n        } catch(ex){\r\n            console.error(ex);\r\n        }\r\n    }\r\n}\r\n\r\nfunction shouldFetchPosts(state, reddit) {\r\n    const posts = state.get('postsByReddit').get(reddit)\r\n    if (!posts) {\r\n        return true\r\n    }\r\n    if (posts.get('isFetching')) {\r\n        return false\r\n    }\r\n    return posts.get('didInvalidate')\r\n}\r\n\r\nexport function fetchPostsIfNeeded(reddit) {\r\n    return (dispatch, getState) => {\r\n        if (shouldFetchPosts(getState(), reddit)) {\r\n            return dispatch(fetchPosts(reddit))\r\n        }\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/pages/async/actions.js\n **/","/*\r\n * action 类型\r\n */\r\n\r\nexport const ADD_TODO = 'ADD_TODO';\r\nexport const COMPLETE_TODO = 'COMPLETE_TODO';\r\nexport const SET_VISIBILITY_FILTER = 'SET_VISIBILITY_FILTER'\r\n\r\n/*\r\n * 其它的常量\r\n */\r\n\r\nexport const VisibilityFilters = {\r\n    SHOW_ALL: 'SHOW_ALL',\r\n    SHOW_COMPLETED: 'SHOW_COMPLETED',\r\n    SHOW_ACTIVE: 'SHOW_ACTIVE'\r\n};\r\n\r\n/*\r\n * action 创建函数\r\n */\r\n\r\nexport function addTodo(text) {\r\n    return { type: ADD_TODO, text }\r\n}\r\n\r\nexport function completeTodo(index) {\r\n    return { type: COMPLETE_TODO, index }\r\n}\r\n\r\nexport function setVisibilityFilter(filter) {\r\n    return { type: SET_VISIBILITY_FILTER, filter }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/pages/index/indexActions.js\n **/","module.exports = {\n\t\"application\": {\n\t\t\"version\": {\n\t\t\t\"css\": \"\",\n\t\t\t\"js\": \"\"\n\t\t},\n\t\t\"debugName\": \"test\"\n\t},\n\t\"serverName\": \"isomophic-react-redux-starter\"\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./server/config/config.json\n ** module id = 12\n ** module chunks = 0\n **/","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar repeat = exports.repeat = function repeat(str, times) {\n  return new Array(times + 1).join(str);\n};\n\nvar pad = exports.pad = function pad(num, maxLength) {\n  return repeat(\"0\", maxLength - num.toString().length) + num;\n};\n\nvar formatTime = exports.formatTime = function formatTime(time) {\n  return pad(time.getHours(), 2) + \":\" + pad(time.getMinutes(), 2) + \":\" + pad(time.getSeconds(), 2) + \".\" + pad(time.getMilliseconds(), 3);\n};\n\n// Use performance API if it's available in order to get better precision\nvar timer = exports.timer = typeof performance !== \"undefined\" && performance !== null && typeof performance.now === \"function\" ? performance : Date;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/redux-logger/lib/helpers.js\n ** module id = 13\n ** module chunks = 0\n **/","module.exports = require(\"events\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"events\"\n ** module id = 14\n ** module chunks = 0\n **/","module.exports = require(\"isomorphic-fetch\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"isomorphic-fetch\"\n ** module id = 15\n ** module chunks = 0\n **/","module.exports = require(\"react-dom/server\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"react-dom/server\"\n ** module id = 16\n ** module chunks = 0\n **/","module.exports = require(\"redux-immutablejs\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"redux-immutablejs\"\n ** module id = 17\n ** module chunks = 0\n **/","module.exports = require(\"redux-thunk\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"redux-thunk\"\n ** module id = 18\n ** module chunks = 0\n **/","import React, { Component, PropTypes } from 'react';\r\nimport EventEmitter from 'events';\r\n\r\nlet mediator = new EventEmitter();\r\n\r\nclass App extends Component {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n    }\r\n\r\n    getChildContext(){\r\n        return {\r\n            $eventBus: mediator,\r\n            $appConfig: this.props.appConfig\r\n        }\r\n    }\r\n\r\n    componentDidMount(){\r\n    }\r\n\r\n    componentDidUpdate(){\r\n    }\r\n\r\n    componentWillUnmount(){\r\n    }\r\n\r\n    render() {\r\n        return React.Children.only(this.props.children);\r\n    }\r\n}\r\nApp.defaultProps = {\r\n    appConfig: null\r\n};\r\nApp.propTypes = {\r\n    appConfig: PropTypes.object\r\n};\r\nApp.childContextTypes = {\r\n    $eventBus: PropTypes.instanceOf(EventEmitter),\r\n    $appConfig: PropTypes.object\r\n};\r\n\r\nexport default App;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/App.jsx\n **/","import React, { Component, PropTypes } from 'react';\r\nimport Immutable from 'immutable';\r\nimport ImmutablePropTypes from 'react-immutable-proptypes';\r\nimport Base from '../../pages/Base';\r\n\r\nexport default class Picker extends Base {\r\n  constructor(props, context) {\r\n    super(props, context);\r\n  }\r\n\r\n  onChange(e) {\r\n    this.props.onChange(e.target.value)\r\n  }\r\n\r\n  render() {\r\n    const { value, onChange, options } = this.props\r\n\r\n    return (\r\n      <span>\r\n        <h1>{value}</h1>\r\n        <select onChange={ this.onChange }\r\n          value={value}>\r\n          {options.map(option =>\r\n            <option value={option} key={option}>\r\n              {option}\r\n            </option>)\r\n          }\r\n        </select>\r\n      </span>\r\n    )\r\n  }\r\n}\r\n\r\nPicker.propTypes = {\r\n  options: PropTypes.arrayOf(\r\n    PropTypes.string.isRequired\r\n  ).isRequired,\r\n  value: PropTypes.string.isRequired,\r\n  onChange: PropTypes.func.isRequired\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/components/async/Picker.jsx\n **/","import React, { PropTypes, Component } from 'react'\r\nimport ImmutablePropTypes from 'react-immutable-proptypes';\r\nimport Base from '../../pages/Base';\r\n\r\nexport default class Posts extends Base {\r\n  render() {\r\n    return (\r\n      <ul>\r\n        {this.props.posts.map((post, i) =>\r\n          <li key={i}>{post.get('title')}</li>\r\n        )}\r\n      </ul>\r\n    )\r\n  }\r\n}\r\n\r\nPosts.propTypes = {\r\n  posts: ImmutablePropTypes.list.isRequired\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/components/async/Posts.jsx\n **/","import React from 'react';\r\nimport Base from '../../pages/Base';\r\n\r\n\r\nexport default class ChangeNameForm extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n\r\n        this.state = {newName: ''};\r\n    }\r\n\r\n    onKey(e) {\r\n        this.setState({ newName : e.target.value });\r\n    }\r\n\r\n    onSubmit(e) {\r\n        e.preventDefault();\r\n        var newName = this.state.newName;\r\n        this.props.onChangeName(newName);\r\n        this.setState({ newName: '' });\r\n    }\r\n\r\n    render() {\r\n        return(\r\n            <div className='change_name_form'>\r\n                <h3> Change Name </h3>\r\n                <form onSubmit={this.onSubmit}>\r\n                    <input\r\n                        onChange={this.onKey}\r\n                        value={this.state.newName}\r\n                    />\r\n                </form>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/components/chat/ChangeNameForm.jsx\n **/","import React, { PropTypes } from 'react';\r\nimport Base from '../../pages/Base';\r\n\r\nexport class Message extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"message\">\r\n                <strong>{this.props.user} :</strong>\r\n                <span>{this.props.text}</span>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nMessage.defaultProps = {\r\n    user: '',\r\n    text: ''\r\n};\r\nMessage.propTypes = {\r\n    user: PropTypes.string.isRequired,\r\n    text: PropTypes.string.isRequired\r\n};\r\n\r\nexport class MessageList extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className='messages'>\r\n                <h2> Conversation: </h2>\r\n                {\r\n                    this.props.messages.map((message, i) => {\r\n                        return (\r\n                            <Message\r\n                                key={i}\r\n                                user={message.user}\r\n                                text={message.text}\r\n                            />\r\n                        );\r\n                    })\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\n\r\nexport class MessageForm extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n\r\n        this.state = {text: ''};\r\n    }\r\n\r\n    onSubmit(e) {\r\n        e.preventDefault();\r\n        if(!this.state.text) return;\r\n\r\n        let message = {\r\n            user : this.props.user,\r\n            text : this.state.text\r\n        };\r\n        this.props.onMessageSubmit(message);\r\n        this.setState({ text: '' });\r\n    }\r\n\r\n    onChange(e) {\r\n        this.setState({ text : e.target.value });\r\n    }\r\n\r\n    render() {\r\n        return(\r\n            <div className='message_form'>\r\n                <h3>Write New Message</h3>\r\n                <form onSubmit={this.onSubmit}>\r\n                    <input\r\n                        onChange={this.onChange}\r\n                        value={this.state.text}\r\n                    />\r\n                </form>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/components/chat/Messages.jsx\n **/","import React from 'react';\r\nimport Base from '../../pages/Base';\r\n\r\nexport default class UsersList extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className='users'>\r\n                <h3> Online Users </h3>\r\n                <ul>\r\n                    {\r\n                        this.props.users.map((user, i) => {\r\n                            return (\r\n                                <li key={i}>\r\n                                    {user}\r\n                                </li>\r\n                            );\r\n                        })\r\n                    }\r\n                </ul>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/components/chat/UsersList.jsx\n **/","import React, { Component, PropTypes } from 'react';\r\nimport classnames from 'classnames';\r\nimport Base from '../../pages/Base';\r\n\r\nexport default class Tabs extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n\r\n        this.state = {\r\n            selectedTab: props.defaultSelectedTab || null\r\n        };\r\n\r\n        this.firstTabLabel = null;\r\n    }\r\n\r\n    getChildContext(){\r\n        return {\r\n            onSelect: this.onSelect.bind(this),\r\n            selectedTab: this.state.selectedTab || this.props.defaultSelectedTab,\r\n            activeStyle: this.props.activeLinkStyle || defaultActiveStyle,\r\n            firstTabLabel: this.firstTabLabel\r\n        };\r\n    }\r\n\r\n    onSelect(tab, ...rest) {\r\n        if(this.state.selectedTab === tab) return;\r\n\r\n        this.setState({\r\n            selectedTab: tab\r\n        });\r\n\r\n        if(typeof this.props.onSelect === 'function') {\r\n            this.props.onSelect(tab, ...rest);\r\n        }\r\n    }\r\n\r\n    findFirstTabLabel(children){\r\n        if (typeof children !== 'object' || this.firstTabLabel) {\r\n            return;\r\n        }\r\n\r\n        React.Children.forEach(children, (child) => {\r\n            if(child.props && child.props.label) {\r\n                if(this.firstTabLabel == null){\r\n                    this.firstTabLabel = child.props.label;\r\n                    return;\r\n                }\r\n            }\r\n\r\n            this.findFirstTabLabel(child.props && child.props.children);\r\n        });\r\n    }\r\n\r\n    render() {\r\n        this.findFirstTabLabel(this.props.children);\r\n\r\n        return (\r\n            <div className={ this.props.className } style={ this.props.style }>\r\n                {this.props.children}\r\n            </div>\r\n        );\r\n    }\r\n}\r\nTabs.defaultProps = {\r\n    onSelect: null,\r\n    activeLinkStyle: null,\r\n    defaultSelectedTab: '',\r\n    className: '',\r\n    style: null\r\n};\r\nTabs.propTypes = {\r\n    onSelect: PropTypes.func,\r\n    activeLinkStyle: PropTypes.object,\r\n    defaultSelectedTab: PropTypes.string,\r\n    className: PropTypes.string,\r\n    style: PropTypes.object\r\n};\r\nTabs.childContextTypes = {\r\n    onSelect: PropTypes.func,\r\n    selectedTab: PropTypes.string,\r\n    activeStyle: PropTypes.object,\r\n    firstTabLabel: PropTypes.string\r\n};\r\n\r\nconst defaultActiveStyle = {\r\n    fontWeight: 'bold'\r\n};\r\n\r\nexport class TabTitle extends Component {\r\n    constructor(props, context){\r\n        super(props, context);\r\n\r\n        this.onSelect = this.onSelect.bind(this);\r\n    }\r\n\r\n    onSelect(){\r\n        this.context.onSelect(this.props.label);\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.context.selectedTab === this.props.label || (!this.context.selectedTab && this.context.firstTabLabel === this.props.label)) {\r\n            this.context.onSelect(this.props.label);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let style = null;\r\n        let isActive = this.context.selectedTab === this.props.label;\r\n        if (isActive) {\r\n            style = this.context.activeStyle;\r\n        }\r\n        let clsNames = classnames(this.props.className, { active: isActive });\r\n\r\n        return (\r\n            <div\r\n                className={ clsNames }\r\n                style={style}\r\n                onClick={ this.onSelect }\r\n            >\r\n                {this.props.children}\r\n            </div>\r\n        );\r\n    }\r\n}\r\nTabTitle.defaultProps = {\r\n    label: '',\r\n    className: 'tab-link'\r\n};\r\nTabTitle.propTypes = {\r\n    label: PropTypes.string.isRequired,\r\n    className: PropTypes.string\r\n};\r\nTabTitle.contextTypes = {\r\n    onSelect: PropTypes.func,\r\n    firstTabLabel: PropTypes.string,\r\n    activeStyle: PropTypes.object,\r\n    selectedTab: PropTypes.string\r\n};\r\n\r\nconst styles = {\r\n    visible: {\r\n        display: 'block'\r\n    },\r\n    hidden: {\r\n        display: 'none'\r\n    }\r\n};\r\n\r\nexport class TabPanel extends Component {\r\n    constructor(props, context){\r\n        super(props, context);\r\n\r\n        for(let style in styles){\r\n            if(styles.hasOwnProperty(style)){\r\n                Object.assign(styles[style], this.props.style);\r\n            }\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let displayStyle = this.context.selectedTab === this.props.for\r\n            ? styles.visible : styles.hidden;\r\n\r\n        return (\r\n            <div\r\n                className={ this.props.className }\r\n                style={ displayStyle }>\r\n                {this.props.children}\r\n            </div>\r\n        );\r\n    }\r\n}\r\nTabPanel.defaultProps = {\r\n    for: '',\r\n    className: 'tab-content',\r\n    style: null\r\n};\r\nTabPanel.propTypes = {\r\n    for: PropTypes.string.isRequired,\r\n    className: PropTypes.string,\r\n    style: PropTypes.object\r\n};\r\nTabPanel.contextTypes = {\r\n    selectedTab: PropTypes.string\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/components/common/Tab.jsx\n **/","import React, { Component, PropTypes } from 'react';\r\nimport Base from '../../pages/Base';\r\n\r\nexport default class AddTodo extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <input type='text' ref='input' />\r\n                <button onClick={ this.onClick.bind(this) }>Add</button>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    onClick(e) {\r\n        const node = this.refs.input;\r\n        const text = node.value.trim();\r\n        this.props.onAddClick(text);\r\n        node.value = '';\r\n    }\r\n}\r\n\r\nAddTodo.propTypes = {\r\n    onAddClick: PropTypes.func.isRequired\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/components/index/AddTodo.jsx\n **/","import React, { Component, PropTypes } from 'react';\r\nimport Base from '../../pages/Base';\r\n\r\nexport default class Footer extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n    }\r\n\r\n    renderFilter(filter, name) {\r\n        if (filter === this.props.filter) {\r\n            return name\r\n        }\r\n\r\n        return (\r\n            <a href='#' onClick={e => {\r\n                e.preventDefault()\r\n                this.props.onFilterChange(filter)\r\n            } }>\r\n                {name}\r\n            </a>\r\n        )\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <p>\r\n                Show:\r\n                {' '}\r\n                {this.renderFilter('SHOW_ALL', 'All') }\r\n                {', '}\r\n                {this.renderFilter('SHOW_COMPLETED', 'Completed') }\r\n                {', '}\r\n                {this.renderFilter('SHOW_ACTIVE', 'Active') }\r\n                .\r\n            </p>\r\n        )\r\n    }\r\n}\r\n\r\nFooter.propTypes = {\r\n    onFilterChange: PropTypes.func.isRequired,\r\n    filter: PropTypes.oneOf([\r\n        'SHOW_ALL',\r\n        'SHOW_COMPLETED',\r\n        'SHOW_ACTIVE'\r\n    ]).isRequired\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/components/index/Footer.jsx\n **/","import React, {Component, PropTypes} from 'react';\r\nimport Base from '../../pages/Base';\r\n\r\nlet styles = {\r\n    completed: {\r\n        textDecoration: 'line-through',\r\n        cursor: 'default'\r\n    },\r\n    uncompleted: {\r\n        textDecoration: 'none',\r\n        cursor: 'pointer'\r\n    }\r\n};\r\n\r\nexport default class Todo extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.on('test', function () {\r\n            console.log('test event bus');\r\n        });\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        // unregister subscribe\r\n        super.componentWillUnmount();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <li onClick={this.props.onClick}\r\n                style={ this.props.completed ? styles.completed : styles.uncompleted }>\r\n                { this.props.text }\r\n            </li>\r\n        )\r\n    }\r\n}\r\nTodo.defaultProps = {\r\n    onClick: function(){},\r\n    text: '',\r\n    completed: false\r\n};\r\nTodo.propTypes = {\r\n    onClick: PropTypes.func.isRequired,\r\n    text: PropTypes.string.isRequired,\r\n    completed: PropTypes.bool.isRequired\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/components/index/Todo.jsx\n **/","import React, { Component, PropTypes } from 'react'\r\nimport { List } from 'immutable';\r\nimport ImmutablePropTypes from 'react-immutable-proptypes';\r\nimport Todo from './Todo'\r\nimport Base from '../../pages/Base';\r\n\r\nexport default class TodoList extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <ul>\r\n                { this.props.todos.map((todo, index) =>\r\n                    <Todo text={ todo.get('text') }\r\n                        completed={ todo.get('completed') }\r\n                        key={index}\r\n                        onClick={() => this.props.onTodoClick(index) } />\r\n                    ) }\r\n            </ul>\r\n        )\r\n    }\r\n}\r\n\r\nTodoList.propTypes = {\r\n    onTodoClick: PropTypes.func.isRequired,\r\n    todos: ImmutablePropTypes.listOf(ImmutablePropTypes.contains({\r\n        text: PropTypes.string.isRequired,\r\n        completed: PropTypes.bool.isRequired\r\n    }))\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/components/index/TodoList.jsx\n **/","const defaultFetchData = () => Promise.resolve();\r\n\r\nfunction preRenderMiddleware({ routes, location, params }) {\r\n    const matchedRoute = routes[routes.length - 1];\r\n    const fetchDataHandler = matchedRoute.fetchData || defaultFetchData;\r\n    return fetchDataHandler(params);\r\n}\r\n\r\nexport default preRenderMiddleware;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/middleware/preRenderMiddleware.js\n **/","import React, {Component, PropTypes} from 'react'\r\nimport {connect} from 'react-redux'\r\nimport Immutable from 'immutable';\r\nimport ImmutablePropTypes from 'react-immutable-proptypes';\r\nimport {selectReddit, fetchPostsIfNeeded, invalidateReddit} from './actions'\r\nimport Picker from '../../components/async/Picker.jsx'\r\nimport Posts from '../../components/async/Posts.jsx'\r\nimport Base from '../Base.jsx';\r\n\r\nclass AsyncPage extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n    }\r\n\r\n    componentDidMount() {\r\n        const {dispatch, selectedReddit} = this.props\r\n        dispatch(fetchPostsIfNeeded(selectedReddit))\r\n    }\r\n\r\n    componentWillReceiveProps(nextProps) {\r\n        if (nextProps.selectedReddit !== this.props.selectedReddit) {\r\n            const {dispatch, selectedReddit} = nextProps\r\n            dispatch(fetchPostsIfNeeded(selectedReddit))\r\n        }\r\n    }\r\n\r\n    onHandleChange(nextReddit) {\r\n        this.props.dispatch(selectReddit(nextReddit))\r\n    }\r\n\r\n    onHandleRefreshClick(e) {\r\n        e.preventDefault()\r\n\r\n        const {dispatch, selectedReddit} = this.props\r\n        dispatch(invalidateReddit(selectedReddit))\r\n        dispatch(fetchPostsIfNeeded(selectedReddit))\r\n    }\r\n\r\n    render() {\r\n        const {selectedReddit, posts, isFetching, lastUpdated} = this.props\r\n        const isEmpty = posts.size === 0\r\n        return (\r\n            <div>\r\n                <Picker value={selectedReddit}\r\n                        onChange={this.onHandleChange}\r\n                        options={ defaultOptions }/>\r\n                <p>\r\n                    {\r\n                        lastUpdated ? (\r\n                            <span>\r\n                Last updated at {new Date(lastUpdated).toLocaleTimeString('en-US', {\r\n                                hour12: false\r\n                            })}.\r\n                                {' '}\r\n              </span>\r\n                        ) : ''\r\n                    }\r\n                    {!isFetching &&\r\n                    <a href=\"#\"\r\n                       onClick={this.onHandleRefreshClick}>\r\n                        Refresh\r\n                    </a>\r\n                    }\r\n                </p>\r\n                {isEmpty\r\n                    ? (isFetching ? <h2>Loading...</h2> : <h2>Empty.</h2>)\r\n                    : <div style={{ opacity: isFetching ? 0.5 : 1 }}>\r\n                    <Posts posts={posts}/>\r\n                </div>\r\n                }\r\n            </div>\r\n        )\r\n    }\r\n}\r\nAsyncPage.defaultProps = {\r\n    selectedReddit: '',\r\n    posts: new Immutable.List(),\r\n    isFetching: false,\r\n    lastUpdated: 0\r\n\r\n};\r\nAsyncPage.propTypes = {\r\n    selectedReddit: PropTypes.string.isRequired,\r\n    posts: ImmutablePropTypes.list.isRequired,\r\n    isFetching: PropTypes.bool.isRequired,\r\n    lastUpdated: PropTypes.number\r\n}\r\n\r\nconst defaultOptions = ['reactjs', 'frontend'];\r\n\r\nfunction mapStateToProps(state) {\r\n    const selectedReddit = state.get('selectedReddit');\r\n    const postsByReddit = state.get('postsByReddit');\r\n    const data = postsByReddit.get(state.get('selectedReddit')) || new Immutable.Map({\r\n            isFetching: true,\r\n            items: new Immutable.List()\r\n        });\r\n    const isFetching = data.get('isFetching');\r\n    const lastUpdated = data.get('lastUpdated');\r\n    const posts = data.get('items');\r\n\r\n    return {\r\n        selectedReddit,\r\n        posts,\r\n        isFetching,\r\n        lastUpdated\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(AsyncPage)\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/pages/async/Page.jsx\n **/","// import { combineReducers } from 'redux'\r\nimport Immutable from 'immutable';\r\nimport { combineReducers } from 'redux-immutablejs';\r\nimport {\r\n  SELECT_REDDIT, INVALIDATE_REDDIT,\r\n  REQUEST_POSTS, RECEIVE_POSTS\r\n} from './actions'\r\n\r\nfunction selectedReddit(state = 'reactjs', action) {\r\n  switch (action.type) {\r\n    case SELECT_REDDIT:\r\n      return action.reddit\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nfunction posts(state = new Immutable.Map({\r\n  isFetching: false,\r\n  didInvalidate: false,\r\n  items: new Immutable.List()\r\n}), action) {\r\n  switch (action.type) {\r\n    case INVALIDATE_REDDIT:\r\n      return state.set('didInvalidate', true)\r\n    case REQUEST_POSTS:\r\n      return state.merge({\r\n        isFetching: true,\r\n        didInvalidate: false\r\n      });\r\n    case RECEIVE_POSTS:\r\n      return state.merge({\r\n        isFetching: false,\r\n        didInvalidate: false,\r\n        items: action.posts,\r\n        lastUpdated: action.receivedAt\r\n      });\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nfunction postsByReddit(state = new Immutable.Map(), action) {\r\n  switch (action.type) {\r\n    case INVALIDATE_REDDIT:\r\n    case RECEIVE_POSTS:\r\n    case REQUEST_POSTS:\r\n      return state.set(action.reddit, posts(state[action.reddit], action));\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nconst rootReducer = combineReducers({\r\n  postsByReddit,\r\n  selectedReddit\r\n})\r\n\r\nexport default rootReducer\n\n\n/** WEBPACK FOOTER **\n ** ./common/pages/async/reducers.js\n **/","import React, {Component, PropTypes} from 'react'\r\nimport {connect} from 'react-redux'\r\n\r\nimport Base from '../Base.jsx';\r\nimport UsersList from '../../components/chat/UsersList';\r\nimport { MessageForm, MessageList } from '../../components/chat/Messages';\r\nimport ChangeNameForm from '../../components/chat/ChangeNameForm';\r\n\r\nif(process.browser){\r\n    var socket = io.connect();\r\n}\r\n\r\nclass Page extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n\r\n        this.state = {\r\n            users: [],\r\n            messages: [],\r\n            text: ''\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        socket.on('init', this.initialize.bind(this));\r\n        socket.on('send:message', this.messageRecieve.bind(this));\r\n        socket.on('user:join', this.userJoined.bind(this));\r\n        socket.on('user:left', this.userLeft.bind(this));\r\n        socket.on('change:name', this.userChangedName.bind(this));\r\n    }\r\n\r\n    initialize(data) {\r\n        let {users, name} = data;\r\n        this.setState({users, user: name});\r\n    }\r\n\r\n    messageRecieve(message) {\r\n        let {messages} = this.state;\r\n\r\n        this.setState({\r\n            messages: [\r\n                ...messages,\r\n                message\r\n            ]\r\n        });\r\n    }\r\n\r\n    userJoined(data) {\r\n        let {users, messages} = this.state;\r\n        let {name} = data;\r\n\r\n        this.setState({\r\n            users: [\r\n                users,\r\n                name\r\n            ],\r\n            messages: [\r\n                ...messages,\r\n                {\r\n                    user: 'APPLICATION BOT',\r\n                    text : name +' Joined'\r\n                }\r\n            ]\r\n        });\r\n    }\r\n\r\n    userLeft(data) {\r\n        let {users, messages} = this.state;\r\n        let {name} = data;\r\n        let index = users.indexOf(name);\r\n        users.splice(index, 1);\r\n\r\n        this.setState({\r\n            users: [\r\n                ...users\r\n            ],\r\n            messages: [\r\n                ...messages,\r\n                {\r\n                    user: 'APPLICATION BOT',\r\n                    text : name +' Left'\r\n                }\r\n            ]\r\n        });\r\n    }\r\n\r\n    userChangedName(data) {\r\n        let {oldName, newName} = data;\r\n        let {users, messages} = this.state;\r\n        let index = users.indexOf(oldName);\r\n        users.splice(index, 1, newName);\r\n\r\n        this.setState({\r\n            users: [\r\n                ...users\r\n            ],\r\n            messages: [\r\n                ...messages,\r\n                {\r\n                    user: 'APPLICATION BOT',\r\n                    text : 'Change Name : ' + oldName + ' ==> '+ newName\r\n                }\r\n            ]\r\n        });\r\n    }\r\n\r\n    onMessageSubmit(message) {\r\n        let {messages} = this.state;\r\n\r\n        this.setState({\r\n            messages: [\r\n                ...messages,\r\n                message\r\n            ]\r\n        });\r\n        socket.emit('send:message', message);\r\n    }\r\n\r\n    onChangeName(newName) {\r\n        let oldName = this.state.user;\r\n        let {messages} = this.state;\r\n\r\n        socket.emit('change:name', { name : newName}, (result) => {\r\n            if(!result) {\r\n                return alert('There was an error changing your name');\r\n            }\r\n            let {users} = this.state;\r\n            let index = users.indexOf(oldName);\r\n            users.splice(index, 1, newName);\r\n\r\n            messages = messages.map((message) => {\r\n                if(message.user === oldName) {\r\n                    return Object.assign({}, message, {\r\n                        user: newName\r\n                    });\r\n                } else {\r\n                    return message;\r\n                }\r\n            });\r\n\r\n            this.setState({\r\n                users: [\r\n                    ...users\r\n                ],\r\n                user: newName,\r\n                messages\r\n            });\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <UsersList\r\n                    users={this.state.users}\r\n                />\r\n                <MessageList\r\n                    messages={this.state.messages}\r\n                />\r\n                <MessageForm\r\n                    onMessageSubmit={this.onMessageSubmit}\r\n                    user={this.state.user}\r\n                />\r\n                <ChangeNameForm\r\n                    onChangeName={this.onChangeName}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default Page;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/pages/chat/Page.jsx\n **/","import React, { Component, PropTypes } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { List } from 'immutable';\r\nimport Base from '../Base.jsx';\r\nimport { addTodo, completeTodo, setVisibilityFilter, VisibilityFilters } from './indexActions'\r\nimport AddTodo from '../../components/index/AddTodo'\r\nimport TodoList from '../../components/index/TodoList'\r\nimport Footer from '../../components/index/Footer';\r\nimport Tabs, { TabTitle, TabPanel } from '../../components/common/Tab';\r\n\r\nclass Page extends Base {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n    }\r\n\r\n    componentDidMount(){\r\n        console.log(this.context.$appConfig.user);\r\n\r\n        this.emit('test');\r\n    }\r\n\r\n    render() {\r\n        // Injected by connect() call:\r\n        const { dispatch, visibleTodos, visibilityFilter } = this.props\r\n        return (\r\n            <div>\r\n                <AddTodo\r\n                    onAddClick={text =>\r\n                        dispatch(addTodo(text))\r\n                    } />\r\n                <TodoList\r\n                    todos={visibleTodos}\r\n                    onTodoClick={index =>\r\n                        dispatch(completeTodo(index))\r\n                    } />\r\n                <Footer\r\n                    filter={visibilityFilter}\r\n                    onFilterChange={nextFilter =>\r\n                        dispatch(setVisibilityFilter(nextFilter))\r\n                    } />\r\n                <Tabs defaultSelectedTab=\"1\">\r\n                    <TabTitle label=\"1\">\r\n                        tab1\r\n                    </TabTitle>\r\n                    <TabTitle label=\"2\">\r\n                        tab2\r\n                    </TabTitle>\r\n                    <TabPanel for=\"1\">\r\n                        TabContent1\r\n                    </TabPanel>\r\n                    <TabPanel for=\"2\">\r\n                        TabContent2\r\n                    </TabPanel>\r\n                </Tabs>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nPage.propTypes = {\r\n    visibleTodos: PropTypes.instanceOf(List).isRequired,\r\n    visibilityFilter: PropTypes.oneOf([\r\n        'SHOW_ALL',\r\n        'SHOW_COMPLETED',\r\n        'SHOW_ACTIVE'\r\n    ]).isRequired\r\n};\r\nPage.contextTypes = {\r\n    $appConfig: PropTypes.object,\r\n    $eventBus: PropTypes.object\r\n};\r\n\r\nfunction selectTodos(todos, filter) {\r\n    switch (filter) {\r\n        case VisibilityFilters.SHOW_ALL:\r\n            return todos\r\n        case VisibilityFilters.SHOW_COMPLETED:\r\n            return todos.filter(todo => todo.get('completed'))\r\n        case VisibilityFilters.SHOW_ACTIVE:\r\n            return todos.filter(todo => !todo.get('completed'))\r\n    }\r\n}\r\n\r\n// Which props do we want to inject, given the global state?\r\n// Note: use https://github.com/faassen/reselect for better performance.\r\nfunction select(state) {\r\n    return {\r\n        visibleTodos: selectTodos(state.get('todos'), state.get('visibilityFilter')),\r\n        visibilityFilter: state.get('visibilityFilter')\r\n    }\r\n}\r\n\r\n// 包装 component ，注入 dispatch 和 state 到其默认的 connect(select)(App) 中；\r\nexport default connect(select)(Page);\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/pages/index/index.jsx\n **/","// import { combineReducers } from 'redux'\r\nimport { List, Map } from 'immutable';\r\nimport { combineReducers } from 'redux-immutablejs';\r\nimport { ADD_TODO, COMPLETE_TODO, SET_VISIBILITY_FILTER, VisibilityFilters } from './indexActions'\r\nconst { SHOW_ALL } = VisibilityFilters\r\n\r\nfunction visibilityFilter(state = SHOW_ALL, action) {\r\n    switch (action.type) {\r\n        case SET_VISIBILITY_FILTER:\r\n            return action.filter\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nfunction todos(state = new List(), action) {\r\n    switch (action.type) {\r\n        case ADD_TODO:\r\n            return state.push(new Map({\r\n                    text: action.text,\r\n                    completed: false\r\n                }))\r\n        case COMPLETE_TODO:\r\n            return state.update(action.index, function(item){\r\n                return item.set('completed', true);\r\n            });\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nconst todoApp = combineReducers({\r\n    visibilityFilter,\r\n    todos\r\n})\r\n\r\nexport default todoApp\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/pages/index/indexReducers.js\n **/","import React from 'react';\nimport { Route, IndexRoute } from 'react-router';\nimport App from './universalPage/App';\n// import Vote from './universalPage/Vote';\nimport About from './universalPage/About';\n\n// require.ensure polyfill for node\nif (typeof require.ensure !== 'function') {\n    require.ensure = function requireModule(deps, callback) {\n        callback(require);\n    };\n}\n\n\nconst fetchData = () => {\n    return new Promise((resolve) => {\n        resolve({\n            message: 'test'\n        });\n    });\n};\n\n/*\n * @param {Redux Store}\n * We require store as an argument here because we wish to get\n * state from the store after it has been authenticated.\n */\nexport default (store) => {\n    const requireAuth = (nextState, replace, callback) => {\n        const { user: { authenticated }} = store.getState();\n        if (!authenticated) {\n            replace({\n                pathname: '/login',\n                state: { nextPathname: nextState.location.pathname }\n            });\n        }\n        callback();\n    };\n\n    const redirectAuth = (nextState, replace, callback) => {\n        const { user: { authenticated }} = store.getState();\n        if (authenticated) {\n            replace({\n                pathname: '/'\n            });\n        }\n        callback();\n    };\n    return (\n        <Route path=\"/\" component={App}>\n            <IndexRoute getComponent={(nextState, cb) => {\n                require.ensure([], require => {\n                    cb(null, require('./universalPage/Vote').default);\n                });\n            }} fetchData={fetchData} />\n            <Route path=\"vote\" getComponent={(nextState, cb) => {\n                require.ensure([], require => {\n                    cb(null, require('./universalPage/Vote').default);\n                });\n            }} fetchData={fetchData}/>\n            <Route path=\"about\" component={About} />\n        </Route>\n    );\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/routes.js\n **/","import { createStore, applyMiddleware, compose } from 'redux';\r\nimport thunk from 'redux-thunk';\r\n\r\nif(process.env.NODE_ENV !== 'production' && process.browser){\r\n    var createLogger = require('redux-logger');\r\n}\r\n\r\nconst middlewareBuilder = () => {\r\n    let middleware = applyMiddleware(thunk);\r\n\r\n    if(process.browser && process.env.NODE_ENV !== 'production'){\r\n        if(!window.devToolsExtension) {\r\n            middleware = applyMiddleware(thunk, createLogger());\r\n        }\r\n    }\r\n\r\n    let allComposeElements = [\r\n        middleware\r\n    ];\r\n\r\n    if(process.browser && process.env.NODE_ENV !== 'production'){\r\n        if(window.devToolsExtension){\r\n            allComposeElements.push(window.devToolsExtension());\r\n        }\r\n    }\r\n\r\n    return allComposeElements;\r\n};\r\n\r\nconst finalCreateStore = compose(...middlewareBuilder())(createStore);\r\n\r\nexport default function configureStore(initialState, rootReducer) {\r\n    const store = finalCreateStore(rootReducer, initialState);\r\n\r\n    return store;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/store/index.js\n **/","import { createStore, applyMiddleware, compose } from 'redux';\r\n// import { routerMiddleware } from 'react-router-redux';\r\nimport thunk from 'redux-thunk';\r\nimport rootReducer from '../universalPage/reducers';\r\nimport createLogger from 'redux-logger';\r\n\r\n/*\r\n * @param {Object} initial state to bootstrap our stores with for server-side rendering\r\n * @param {History Object} a history object. We use `createMemoryHistory` for server-side rendering,\r\n *                          while using browserHistory for client-side\r\n *                          rendering.\r\n */\r\nexport default function configureStore(initialState, history) {\r\n    // Installs hooks that always keep react-router and redux store in sync\r\n    // const middleware = [thunk, routerMiddleware(history)];\r\n    const middleware = [thunk];\r\n    let store;\r\n\r\n    if (process.browser) {\r\n        middleware.push(createLogger());\r\n        store = createStore(rootReducer, initialState, compose(\r\n            applyMiddleware(...middleware),\r\n            typeof window === 'object' && typeof window.devToolsExtension !== 'undefined' ? window.devToolsExtension() : f => f\r\n        ));\r\n    } else {\r\n        store = createStore(rootReducer, initialState, compose(applyMiddleware(...middleware), f => f));\r\n    }\r\n\r\n    if (module.hot) {\r\n        // Enable Webpack hot module replacement for reducers\r\n        module.hot.accept('../universalPage/reducers', () => {\r\n            const nextReducer = require('../universalPage/reducers');\r\n            store.replaceReducer(nextReducer);\r\n        });\r\n    }\r\n\r\n    return store;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/store/universalStore.js\n **/","import React, { Component } from 'react';\nimport { Link } from 'react-router';\nimport { connect } from 'react-redux';\n// import classNames from 'classnames/bind';\n// import styles from 'css/components/about';\n\n// const cx = classNames.bind(styles);\n\n/*\n * Note: This is kept as a container-level component,\n *  i.e. We should keep this as the container that does the data-fetching\n *  and dispatching of actions if you decide to have any sub-components.\n */\nclass About extends Component {\n\n    render() {\n        return (\n            <div className=\"about\">\n                this is about page\n                <Link to=\"/vote\">vote</Link>\n                text: { this.props.text }\n            </div>\n        );\n    }\n}\n\nfunction mapStateToProps(state) {\n    return {\n        text: state.about\n    };\n}\n\n// Read more about where to place `connect` here:\n// https://github.com/rackt/react-redux/issues/75#issuecomment-135436563\nexport default connect(mapStateToProps, { })(About);\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/universalPage/About.jsx\n **/","import React, { PropTypes } from 'react';\r\n// import Navigation from 'containers/Navigation';\r\n// import Message from 'containers/Message';\r\n// import classNames from 'classnames/bind';\r\n// import styles from 'css/main';\r\n\r\n// const cx = classNames.bind(styles);\r\n\r\n\r\n/*\r\n * React-router's <Router> component renders <Route>'s\r\n * and replaces `this.props.children` with the proper React Component.\r\n *\r\n * Please refer to `routes.jsx` for the route config.\r\n *\r\n * A better explanation of react-router is available here:\r\n * https://github.com/rackt/react-router/blob/latest/docs/Introduction.md\r\n */\r\nconst App = ({children}) => {\r\n    return (\r\n        <div className=\"app\">\r\n            {children}\r\n        </div>\r\n    );\r\n};\r\n\r\nApp.propTypes = {\r\n    children: PropTypes.object\r\n};\r\n\r\nexport default App;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/universalPage/App.jsx\n **/","\r\nimport { combineReducers } from 'redux';\r\n\r\nexport default function text(state = 'test'){\r\n    return state;\r\n}\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/universalPage/reducers/about.js\n **/","import { combineReducers } from 'redux';\r\nimport about from './about';\r\nimport vote from './vote';\r\n// import { routerReducer as routing } from 'react-router-redux';\r\n\r\nconst isFetching = ( state = false, action ) => {\r\n    switch (action.type) {\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\n// Combine reducers with routeReducer which keeps track of\r\n// router state\r\nconst rootReducer = combineReducers({\r\n    isFetching,\r\n    about,\r\n    vote,\r\n    // routing\r\n});\r\n\r\nexport default rootReducer;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/universalPage/reducers/index.js\n **/","\r\n\r\n/*\r\n * Message store for global messages, i.e. Network messages / Redirect messages\r\n * that need to be communicated on the page itself. Ideally\r\n * messages/notifications should appear within the component to give the user\r\n * more context. - My 2 cents.\r\n */\r\nexport default function message(state = {\r\n    message: 'test',\r\n    type: 'SUCCESS'\r\n}, action = {}) {\r\n    switch (action.type) {\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/universalPage/reducers/vote.js\n **/","// modified\r\n/**\r\n * Copyright (c) 2013-present, Facebook, Inc.\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree. An additional grant\r\n * of patent rights can be found in the PATENTS file in the same directory.\r\n *\r\n * @typechecks\r\n *\r\n */\r\n\r\n/*eslint-disable no-self-compare */\r\n\r\n'use strict';\r\n\r\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\r\n\r\n/**\r\n * inlined Object.is polyfill to avoid requiring consumers ship their own\r\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\r\n */\r\nfunction is(x, y) {\r\n    // SameValue algorithm\r\n    if (x === y) {\r\n        return true;\r\n    } else {\r\n        if(typeof x === 'function' && typeof y === 'function'){\r\n            return x.toString() === y.toString();\r\n        }\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n * Performs equality by iterating through keys on an object and returning false\r\n * when any key has values which are not strictly equal between the arguments.\r\n * Returns true when the values of all keys are strictly equal.\r\n */\r\nfunction shallowEqual(objA, objB) {\r\n    if (is(objA, objB)) {\r\n        return true;\r\n    }\r\n\r\n    if (typeof objA !== 'object' || objA === null || typeof objB !== 'object' || objB === null) {\r\n        return false;\r\n    }\r\n\r\n    var keysA = Object.keys(objA);\r\n    var keysB = Object.keys(objB);\r\n\r\n    if (keysA.length !== keysB.length) {\r\n        return false;\r\n    }\r\n\r\n    // Test for A's keys different from B.\r\n    for (var i = 0; i < keysA.length; i++) {\r\n        if (!hasOwnProperty.call(objB, keysA[i]) || !is(objA[keysA[i]], objB[keysA[i]])) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nmodule.exports = shallowEqual;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./common/utils/shallowEqual.js\n **/","import { Router } from 'express';\r\n\r\nlet router = new Router();\r\n\r\nrouter.post('/ajax', function(req, res, next){\r\n    if(error) {\r\n        next();\r\n    } else {\r\n        res.send('test')\r\n    }\r\n});\r\n\r\nexport default router;\r\n\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./server/apis/index.js\n **/","import React from 'react';\r\nimport fetch from 'isomorphic-fetch';\r\nimport rootReducer from '../../common/pages/async/reducers';\r\nimport Page from '../../common/pages/async/Page.jsx';\r\n\r\nmodule.exports = async function (req, res, next) {\r\n    let state = {\r\n        postsByReddit: {},\r\n        selectedReddit: 'reactjs'\r\n    };\r\n\r\n    try {\r\n        let response = await fetch(`https://www.reddit.com/r/${state.selectedReddit}.json`, {\r\n            method: 'GET',\r\n            timeout: 5000\r\n        }).then(response => response.json());\r\n\r\n        state.postsByReddit[state.selectedReddit] = {\r\n            didInvalidate: false,\r\n            isFetching: false,\r\n            lastUpdated: Date.now(),\r\n            items: response.data.children.map(child => child.data)\r\n        };\r\n\r\n    } catch(ex){\r\n        console.error(ex);\r\n    }\r\n\r\n    res.renderReactHTML({\r\n        component: <Page/>,\r\n        locals: {\r\n            appName: 'async',\r\n            title: 'async page'\r\n        },\r\n        data: state,\r\n        rootReducer\r\n    });\r\n\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./server/controllers/async.js\n **/","import React from 'react';\r\nimport Page from '../../common/pages/chat/Page';\r\nimport fs from 'fs';\r\n\r\nlet template = fs.readFileSync(__dirname + '/../views/chat.html', 'utf8');\r\nlet fakeData = {\r\n\r\n};\r\n\r\nmodule.exports = function (req, res, next) {\r\n    res.renderReactHTML({\r\n        template,\r\n        component: <Page/>,\r\n        locals: {\r\n            appName: 'chat',\r\n            title: 'chat page'\r\n        },\r\n        data: fakeData,\r\n        needTransform: false\r\n    });\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./server/controllers/chat.js\n **/","import React from 'react';\r\nimport rootReducer from '../../common/pages/index/indexReducers';\r\nimport Page from '../../common/pages/index';\r\n\r\nlet fakeData = {\r\n    visibilityFilter: 'SHOW_ALL',\r\n    todos: [\r\n        {\r\n            text: 'one',\r\n            completed: false\r\n        },\r\n        {\r\n            text: 'two',\r\n            completed: true\r\n        }\r\n    ]\r\n};\r\n\r\nmodule.exports = function (req, res, next) {\r\n    res.renderReactHTML({\r\n        component: <Page/>,\r\n        locals: {\r\n            appName: 'index',\r\n            title: 'index page'\r\n        },\r\n        data: fakeData,\r\n        rootReducer,\r\n        pageConfig: {\r\n            user: 'test'\r\n        }\r\n    });\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./server/controllers/index.js\n **/","import { Router } from 'express';\r\nimport fs from 'fs';\r\n\r\nlet router = new Router();\r\n\r\nimport IndexPage from '../controllers/index';\r\nimport AsyncPage from '../controllers/async';\r\nimport ChatPage from '../controllers/chat';\r\n\r\n\r\n/**\r\n * 首页请求\r\n */\r\nrouter.get('/', IndexPage);\r\nrouter.get('/async', AsyncPage);\r\nrouter.get('/chat', ChatPage);\r\n\r\n\r\n/**\r\n * 静态资源\r\n */\r\nlet content = fs.readFileSync(__dirname + '/../../client/js/utils/sw.js', 'utf8');\r\n\r\nrouter.get('/sw.js', async function(req, res){\r\n    res.set('Content-Type', 'application/javascript');\r\n    res.send(content);\r\n});\r\n\r\nexport default router;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./server/routes/index.js\n **/","// Keep track of which names are used so that there are no duplicates\r\nlet userNames = (function () {\r\n    let names = {};\r\n\r\n    let claim = function (name) {\r\n        if (!name || names[name]) {\r\n            return false;\r\n        } else {\r\n            names[name] = true;\r\n            return true;\r\n        }\r\n    };\r\n\r\n    // find the lowest unused \"guest\" name and claim it\r\n    let getGuestName = function () {\r\n        let name,\r\n            nextUserId = 1;\r\n\r\n        do {\r\n            name = 'Guest ' + nextUserId;\r\n            nextUserId += 1;\r\n        } while (!claim(name));\r\n\r\n        return name;\r\n    };\r\n\r\n    // serialize claimed names as an array\r\n    let get = function () {\r\n        let res = [];\r\n        for (let user in names) {\r\n            res.push(user);\r\n        }\r\n\r\n        return res;\r\n    };\r\n\r\n    let free = function (name) {\r\n        if (names[name]) {\r\n            delete names[name];\r\n        }\r\n    };\r\n\r\n    return {\r\n        claim: claim,\r\n        free: free,\r\n        get: get,\r\n        getGuestName: getGuestName\r\n    };\r\n}());\r\n\r\n// export function for listening to the socket\r\nexport default function (socket) {\r\n    let name = userNames.getGuestName();\r\n\r\n    // send the new user their name and a list of users\r\n    socket.emit('init', {\r\n        name: name,\r\n        users: userNames.get()\r\n    });\r\n\r\n    // notify other clients that a new user has joined\r\n    socket.broadcast.emit('user:join', {\r\n        name: name\r\n    });\r\n\r\n    // broadcast a user's message to other users\r\n    socket.on('send:message', function (data) {\r\n        socket.broadcast.emit('send:message', {\r\n            user: name,\r\n            text: data.text\r\n        });\r\n    });\r\n\r\n    // validate a user's name change, and broadcast it on success\r\n    socket.on('change:name', function (data, fn) {\r\n        if (userNames.claim(data.name)) {\r\n            let oldName = name;\r\n            userNames.free(oldName);\r\n\r\n            name = data.name;\r\n\r\n            socket.broadcast.emit('change:name', {\r\n                oldName: oldName,\r\n                newName: name\r\n            });\r\n\r\n            fn(true);\r\n        } else {\r\n            fn(false);\r\n        }\r\n    });\r\n\r\n    // clean up when a user leaves, and broadcast it to other users\r\n    socket.on('disconnect', function () {\r\n        socket.broadcast.emit('user:left', {\r\n            name: name\r\n        });\r\n        userNames.free(name);\r\n    });\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./server/sockets/socket.js\n **/","\nexport default function allowCrossDomain(req, res, next) {\n    let allowedOrigins = [\n        'http://www.test.com'\n    ];\n    let origin = req.headers.origin;\n    if(allowedOrigins.indexOf(origin) > -1){\n        res.header('Access-Control-Allow-Origin', origin);\n    }\n    next();\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./server/utils/allowCrossDomain.js\n **/","import ejs from 'ejs';\r\nimport React from 'react';\r\nimport {renderToString} from 'react-dom/server';\r\nimport {Provider} from 'react-redux';\r\nimport fs from 'fs';\r\n// for xss protection\r\nimport SecureFilters from 'secure-filters';\r\n\r\nimport configureStore from '../../common/store/index';\r\nimport App from '../../common/App.jsx';\r\nimport config from '../config/config.json';\r\n\r\nconst defaultTemplate = fs.readFileSync(__dirname + '/../views/index.html', 'utf8');\r\n\r\nfunction getDefaultJSVersion(name) {\r\n    let webpackAssets = fs.readFileSync(__dirname + '/../../webpack-assets.json', 'utf8');\r\n\r\n    try {\r\n        webpackAssets = JSON.parse(webpackAssets);\r\n    } catch (ex) {\r\n        console.log('webpack-assets.json parsed error');\r\n        webpackAssets = {};\r\n    }\r\n    return webpackAssets[name];\r\n}\r\n\r\nexport default function reactRender(middlewareConfig = {}) {\r\n    return function (req, res, next) {\r\n        res.renderReactHTML = function (opts = {}) {\r\n            let {\r\n                template = '',\r\n                component = '',\r\n                data = {},\r\n                rootReducer = (() => {\r\n                }),\r\n                locals = {},\r\n                pageConfig = {},\r\n                needTransform = true\r\n            } = opts;\r\n            let transformedData = (typeof middlewareConfig.transformer === 'function' && needTransform)\r\n                ? middlewareConfig.transformer(data) : data;\r\n            let store = configureStore(transformedData, rootReducer);\r\n            let html = '';\r\n            pageConfig = Object.assign(typeof middlewareConfig.appConfig === 'object'\r\n                ? middlewareConfig.appConfig : {}, pageConfig);\r\n\r\n            try {\r\n                html = renderToString((\r\n                    <Provider store={ store }>\r\n                        <App appconfig={ pageConfig }>\r\n                            { component }\r\n                        </App>\r\n                    </Provider>\r\n                ));\r\n            } catch (ex) {\r\n                html = 'internal server error: \\n' + ex.message;\r\n                console.error(ex.message);\r\n            }\r\n\r\n            let debug = req.query.debug && (req.query.debug === config.application.debugName);\r\n            let state = data;\r\n            let version = config.application.version;\r\n            let jsVersion = '';\r\n            // prefer config version, useful when using CDN config\r\n            if (process.env.NODE_ENV === 'production') {\r\n                jsVersion = version && version.js;\r\n            } else {\r\n                jsVersion = getDefaultJSVersion(locals.appName || 'index');\r\n            }\r\n            template = template || middlewareConfig.defaultTemplate || defaultTemplate;\r\n\r\n            let finalLocals = Object.assign({\r\n                html,\r\n                state: SecureFilters.jsObj(data),\r\n                appName: 'index',\r\n                title: '',\r\n                test: process.env.NODE_ENV !== 'production',\r\n                debug,\r\n                appConfig: SecureFilters.jsObj(pageConfig),\r\n                version: {\r\n                    js: jsVersion,\r\n                    css: version && version.css\r\n                }\r\n            }, res.locals, locals);\r\n\r\n            let pageStr = ejs.render(template, finalLocals, {\r\n                compileDebug: false\r\n            });\r\n\r\n            res.status(200).send(pageStr);\r\n        };\r\n\r\n        next();\r\n    };\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./server/utils/renderReactMiddleware.jsx\n **/","import React from 'react';\r\nimport {renderToString} from 'react-dom/server';\r\nimport {createMemoryHistory, match, RouterContext} from 'react-router';\r\nimport {Provider} from 'react-redux';\r\nimport createRoutes from '../../common/routes';\r\nimport configureStore from '../../common/store/universalStore';\r\nimport preRenderMiddleware from '../../common/middleware/preRenderMiddleware';\r\n\r\n\r\nexport default function renderMatch(req, res) {\r\n    // const authenticated = req.isAuthenticated();\r\n    const history = createMemoryHistory();\r\n    const store = configureStore({\r\n        user: {\r\n            // authenticated,\r\n            isWaiting: false,\r\n            message: '',\r\n            isLogin: true\r\n        }\r\n    }, history);\r\n    const routes = createRoutes(store);\r\n\r\n    /*\r\n     * From the react-router docs:\r\n     *\r\n     * This function is to be used for server-side rendering. It matches a set of routes to\r\n     * a location, without rendering, and calls a callback(err, redirect, props)\r\n     * when it's done.\r\n     *\r\n     * The function will create a `history` for you, passing additional `options` to create it.\r\n     * These options can include `basename` to control the base name for URLs, as well as the pair\r\n     * of `parseQueryString` and `stringifyQuery` to control query string parsing and serializing.\r\n     * You can also pass in an already instantiated `history` object, which can be constructured\r\n     * however you like.\r\n     *\r\n     * The three arguments to the callback function you pass to `match` are:\r\n     * - err:       A javascript Error object if an error occured, `undefined` otherwise.\r\n     * - redirect:  A `Location` object if the route is a redirect, `undefined` otherwise\r\n     * - props:     The props you should pass to the routing context if the route matched,\r\n     *              `undefined` otherwise.\r\n     * If all three parameters are `undefined`, this means that there was no route found matching the\r\n     * given location.\r\n     */\r\n    match({routes, location: req.originalUrl}, (err, redirect, props) => {\r\n        if (err) {\r\n            res.status(500).json(err);\r\n        } else if (redirect) {\r\n            res.redirect(302, redirect.pathname + redirect.search);\r\n        } else if (props) {\r\n            // This method waits for all render component\r\n            // promises to resolve before returning to browser\r\n            // store.dispatch({ type: types.CREATE_REQUEST });\r\n            preRenderMiddleware(props)\r\n                .then(data => {\r\n                    store.dispatch({type: 'REQUEST_SUCCESS', data});\r\n                    const componentHTML = renderToString(\r\n                        <Provider store={store}>\r\n                            <RouterContext {...props} />\r\n                        </Provider>\r\n                    );\r\n\r\n                    const initialState = store.getState();\r\n\r\n                    res.status(200).send(`\r\n<!doctype html>\r\n<html>\r\n    <head>\r\n        <meta charset=\"utf-8\">\r\n        <meta name=\"format-detection\" content=\"telephone=no\"/>\r\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\r\n        <meta name=\"apple-mobile-web-app-capable\" content=\"yes\"/>\r\n        <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\"/>\r\n    </head>\r\n    <body>\r\n        <div id=\"page\">${componentHTML}</div>\r\n        <script>window.__INITIAL_STATE__ = ${JSON.stringify(initialState)};</script>\r\n        <script src=\"/static/js/libs-debug.js\"></script>\r\n        <script src=\"/static/js/debug/app.js\"></script>\r\n    </body>\r\n</html>\r\n                `);\r\n                })\r\n                .catch(err => {\r\n                    console.error(err);\r\n                    res.status(500).json(err);\r\n                });\r\n        } else {\r\n            res.sendStatus(404);\r\n        }\r\n    });\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./server/utils/universialRenderMatch.js\n **/","/*!\n * deep-diff.\n * Licensed under the MIT License.\n */\n;(function(root, factory) {\n  'use strict';\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([], function() {\n      return factory();\n    });\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like environments that support module.exports,\n    // like Node.\n    module.exports = factory();\n  } else {\n    // Browser globals (root is window)\n    root.DeepDiff = factory();\n  }\n}(this, function(undefined) {\n  'use strict';\n\n  var $scope, conflict, conflictResolution = [];\n  if (typeof global === 'object' && global) {\n    $scope = global;\n  } else if (typeof window !== 'undefined') {\n    $scope = window;\n  } else {\n    $scope = {};\n  }\n  conflict = $scope.DeepDiff;\n  if (conflict) {\n    conflictResolution.push(\n      function() {\n        if ('undefined' !== typeof conflict && $scope.DeepDiff === accumulateDiff) {\n          $scope.DeepDiff = conflict;\n          conflict = undefined;\n        }\n      });\n  }\n\n  // nodejs compatible on server side and in the browser.\n  function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor;\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  }\n\n  function Diff(kind, path) {\n    Object.defineProperty(this, 'kind', {\n      value: kind,\n      enumerable: true\n    });\n    if (path && path.length) {\n      Object.defineProperty(this, 'path', {\n        value: path,\n        enumerable: true\n      });\n    }\n  }\n\n  function DiffEdit(path, origin, value) {\n    DiffEdit.super_.call(this, 'E', path);\n    Object.defineProperty(this, 'lhs', {\n      value: origin,\n      enumerable: true\n    });\n    Object.defineProperty(this, 'rhs', {\n      value: value,\n      enumerable: true\n    });\n  }\n  inherits(DiffEdit, Diff);\n\n  function DiffNew(path, value) {\n    DiffNew.super_.call(this, 'N', path);\n    Object.defineProperty(this, 'rhs', {\n      value: value,\n      enumerable: true\n    });\n  }\n  inherits(DiffNew, Diff);\n\n  function DiffDeleted(path, value) {\n    DiffDeleted.super_.call(this, 'D', path);\n    Object.defineProperty(this, 'lhs', {\n      value: value,\n      enumerable: true\n    });\n  }\n  inherits(DiffDeleted, Diff);\n\n  function DiffArray(path, index, item) {\n    DiffArray.super_.call(this, 'A', path);\n    Object.defineProperty(this, 'index', {\n      value: index,\n      enumerable: true\n    });\n    Object.defineProperty(this, 'item', {\n      value: item,\n      enumerable: true\n    });\n  }\n  inherits(DiffArray, Diff);\n\n  function arrayRemove(arr, from, to) {\n    var rest = arr.slice((to || from) + 1 || arr.length);\n    arr.length = from < 0 ? arr.length + from : from;\n    arr.push.apply(arr, rest);\n    return arr;\n  }\n\n  function realTypeOf(subject) {\n    var type = typeof subject;\n    if (type !== 'object') {\n      return type;\n    }\n\n    if (subject === Math) {\n      return 'math';\n    } else if (subject === null) {\n      return 'null';\n    } else if (Array.isArray(subject)) {\n      return 'array';\n    } else if (Object.prototype.toString.call(subject) === '[object Date]') {\n      return 'date';\n    } else if (typeof subject.toString !== 'undefined' && /^\\/.*\\//.test(subject.toString())) {\n      return 'regexp';\n    }\n    return 'object';\n  }\n\n  function deepDiff(lhs, rhs, changes, prefilter, path, key, stack) {\n    path = path || [];\n    var currentPath = path.slice(0);\n    if (typeof key !== 'undefined') {\n      if (prefilter) {\n        if (typeof(prefilter) === 'function' && prefilter(currentPath, key)) { return; }\n        else if (typeof(prefilter) === 'object') {\n          if (prefilter.prefilter && prefilter.prefilter(currentPath, key)) { return; }\n          if (prefilter.normalize) {\n            var alt = prefilter.normalize(currentPath, key, lhs, rhs);\n            if (alt) {\n              lhs = alt[0];\n              rhs = alt[1];\n            }\n          }\n        }\n      }\n      currentPath.push(key);\n    }\n\n    // Use string comparison for regexes\n    if (realTypeOf(lhs) === 'regexp' && realTypeOf(rhs) === 'regexp') {\n      lhs = lhs.toString();\n      rhs = rhs.toString();\n    }\n\n    var ltype = typeof lhs;\n    var rtype = typeof rhs;\n    if (ltype === 'undefined') {\n      if (rtype !== 'undefined') {\n        changes(new DiffNew(currentPath, rhs));\n      }\n    } else if (rtype === 'undefined') {\n      changes(new DiffDeleted(currentPath, lhs));\n    } else if (realTypeOf(lhs) !== realTypeOf(rhs)) {\n      changes(new DiffEdit(currentPath, lhs, rhs));\n    } else if (Object.prototype.toString.call(lhs) === '[object Date]' && Object.prototype.toString.call(rhs) === '[object Date]' && ((lhs - rhs) !== 0)) {\n      changes(new DiffEdit(currentPath, lhs, rhs));\n    } else if (ltype === 'object' && lhs !== null && rhs !== null) {\n      stack = stack || [];\n      if (stack.indexOf(lhs) < 0) {\n        stack.push(lhs);\n        if (Array.isArray(lhs)) {\n          var i, len = lhs.length;\n          for (i = 0; i < lhs.length; i++) {\n            if (i >= rhs.length) {\n              changes(new DiffArray(currentPath, i, new DiffDeleted(undefined, lhs[i])));\n            } else {\n              deepDiff(lhs[i], rhs[i], changes, prefilter, currentPath, i, stack);\n            }\n          }\n          while (i < rhs.length) {\n            changes(new DiffArray(currentPath, i, new DiffNew(undefined, rhs[i++])));\n          }\n        } else {\n          var akeys = Object.keys(lhs);\n          var pkeys = Object.keys(rhs);\n          akeys.forEach(function(k, i) {\n            var other = pkeys.indexOf(k);\n            if (other >= 0) {\n              deepDiff(lhs[k], rhs[k], changes, prefilter, currentPath, k, stack);\n              pkeys = arrayRemove(pkeys, other);\n            } else {\n              deepDiff(lhs[k], undefined, changes, prefilter, currentPath, k, stack);\n            }\n          });\n          pkeys.forEach(function(k) {\n            deepDiff(undefined, rhs[k], changes, prefilter, currentPath, k, stack);\n          });\n        }\n        stack.length = stack.length - 1;\n      }\n    } else if (lhs !== rhs) {\n      if (!(ltype === 'number' && isNaN(lhs) && isNaN(rhs))) {\n        changes(new DiffEdit(currentPath, lhs, rhs));\n      }\n    }\n  }\n\n  function accumulateDiff(lhs, rhs, prefilter, accum) {\n    accum = accum || [];\n    deepDiff(lhs, rhs,\n      function(diff) {\n        if (diff) {\n          accum.push(diff);\n        }\n      },\n      prefilter);\n    return (accum.length) ? accum : undefined;\n  }\n\n  function applyArrayChange(arr, index, change) {\n    if (change.path && change.path.length) {\n      var it = arr[index],\n          i, u = change.path.length - 1;\n      for (i = 0; i < u; i++) {\n        it = it[change.path[i]];\n      }\n      switch (change.kind) {\n        case 'A':\n          applyArrayChange(it[change.path[i]], change.index, change.item);\n          break;\n        case 'D':\n          delete it[change.path[i]];\n          break;\n        case 'E':\n        case 'N':\n          it[change.path[i]] = change.rhs;\n          break;\n      }\n    } else {\n      switch (change.kind) {\n        case 'A':\n          applyArrayChange(arr[index], change.index, change.item);\n          break;\n        case 'D':\n          arr = arrayRemove(arr, index);\n          break;\n        case 'E':\n        case 'N':\n          arr[index] = change.rhs;\n          break;\n      }\n    }\n    return arr;\n  }\n\n  function applyChange(target, source, change) {\n    if (target && source && change && change.kind) {\n      var it = target,\n          i = -1,\n          last = change.path ? change.path.length - 1 : 0;\n      while (++i < last) {\n        if (typeof it[change.path[i]] === 'undefined') {\n          it[change.path[i]] = (typeof change.path[i] === 'number') ? [] : {};\n        }\n        it = it[change.path[i]];\n      }\n      switch (change.kind) {\n        case 'A':\n          applyArrayChange(change.path ? it[change.path[i]] : it, change.index, change.item);\n          break;\n        case 'D':\n          delete it[change.path[i]];\n          break;\n        case 'E':\n        case 'N':\n          it[change.path[i]] = change.rhs;\n          break;\n      }\n    }\n  }\n\n  function revertArrayChange(arr, index, change) {\n    if (change.path && change.path.length) {\n      // the structure of the object at the index has changed...\n      var it = arr[index],\n          i, u = change.path.length - 1;\n      for (i = 0; i < u; i++) {\n        it = it[change.path[i]];\n      }\n      switch (change.kind) {\n        case 'A':\n          revertArrayChange(it[change.path[i]], change.index, change.item);\n          break;\n        case 'D':\n          it[change.path[i]] = change.lhs;\n          break;\n        case 'E':\n          it[change.path[i]] = change.lhs;\n          break;\n        case 'N':\n          delete it[change.path[i]];\n          break;\n      }\n    } else {\n      // the array item is different...\n      switch (change.kind) {\n        case 'A':\n          revertArrayChange(arr[index], change.index, change.item);\n          break;\n        case 'D':\n          arr[index] = change.lhs;\n          break;\n        case 'E':\n          arr[index] = change.lhs;\n          break;\n        case 'N':\n          arr = arrayRemove(arr, index);\n          break;\n      }\n    }\n    return arr;\n  }\n\n  function revertChange(target, source, change) {\n    if (target && source && change && change.kind) {\n      var it = target,\n          i, u;\n      u = change.path.length - 1;\n      for (i = 0; i < u; i++) {\n        if (typeof it[change.path[i]] === 'undefined') {\n          it[change.path[i]] = {};\n        }\n        it = it[change.path[i]];\n      }\n      switch (change.kind) {\n        case 'A':\n          // Array was modified...\n          // it will be an array...\n          revertArrayChange(it[change.path[i]], change.index, change.item);\n          break;\n        case 'D':\n          // Item was deleted...\n          it[change.path[i]] = change.lhs;\n          break;\n        case 'E':\n          // Item was edited...\n          it[change.path[i]] = change.lhs;\n          break;\n        case 'N':\n          // Item is new...\n          delete it[change.path[i]];\n          break;\n      }\n    }\n  }\n\n  function applyDiff(target, source, filter) {\n    if (target && source) {\n      var onChange = function(change) {\n        if (!filter || filter(target, source, change)) {\n          applyChange(target, source, change);\n        }\n      };\n      deepDiff(target, source, onChange);\n    }\n  }\n\n  Object.defineProperties(accumulateDiff, {\n\n    diff: {\n      value: accumulateDiff,\n      enumerable: true\n    },\n    observableDiff: {\n      value: deepDiff,\n      enumerable: true\n    },\n    applyDiff: {\n      value: applyDiff,\n      enumerable: true\n    },\n    applyChange: {\n      value: applyChange,\n      enumerable: true\n    },\n    revertChange: {\n      value: revertChange,\n      enumerable: true\n    },\n    isConflict: {\n      value: function() {\n        return 'undefined' !== typeof conflict;\n      },\n      enumerable: true\n    },\n    noConflict: {\n      value: function() {\n        if (conflictResolution) {\n          conflictResolution.forEach(function(it) {\n            it();\n          });\n          conflictResolution = null;\n        }\n        return accumulateDiff;\n      },\n      enumerable: true\n    }\n  });\n\n  return accumulateDiff;\n}));\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/deep-diff/index.js\n ** module id = 54\n ** module chunks = 0\n **/","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.printBuffer = printBuffer;\n\nvar _helpers = require('./helpers');\n\nvar _diff = require('./diff');\n\nvar _diff2 = _interopRequireDefault(_diff);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _typeof(obj) { return obj && typeof Symbol !== \"undefined\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; }\n\n/**\n * Get log level string based on supplied params\n *\n * @param {string | function | object} level - console[level]\n * @param {object} action - selected action\n * @param {array} payload - selected payload\n * @param {string} type - log entry type\n *\n * @returns {string} level\n */\nfunction getLogLevel(level, action, payload, type) {\n  switch (typeof level === 'undefined' ? 'undefined' : _typeof(level)) {\n    case 'object':\n      return typeof level[type] === 'function' ? level[type].apply(level, _toConsumableArray(payload)) : level[type];\n    case 'function':\n      return level(action);\n    default:\n      return level;\n  }\n}\n\nfunction defaultTitleFormatter(options) {\n  var timestamp = options.timestamp;\n  var duration = options.duration;\n\n  return function (action, time, took) {\n    return 'action @ ' + (timestamp ? time : '') + ' ' + action.type + ' ' + (duration ? '(in ' + took.toFixed(2) + ' ms)' : '');\n  };\n}\n\nfunction printBuffer(buffer, options) {\n  var logger = options.logger;\n  var actionTransformer = options.actionTransformer;\n  var _options$titleFormatt = options.titleFormatter;\n  var titleFormatter = _options$titleFormatt === undefined ? defaultTitleFormatter(options) : _options$titleFormatt;\n  var collapsed = options.collapsed;\n  var colors = options.colors;\n  var level = options.level;\n  var diff = options.diff;\n\n  buffer.forEach(function (logEntry, key) {\n    var started = logEntry.started;\n    var startedTime = logEntry.startedTime;\n    var action = logEntry.action;\n    var prevState = logEntry.prevState;\n    var error = logEntry.error;\n    var took = logEntry.took;\n    var nextState = logEntry.nextState;\n\n    var nextEntry = buffer[key + 1];\n\n    if (nextEntry) {\n      nextState = nextEntry.prevState;\n      took = nextEntry.started - started;\n    }\n\n    // Message\n    var formattedAction = actionTransformer(action);\n    var isCollapsed = typeof collapsed === 'function' ? collapsed(function () {\n      return nextState;\n    }, action) : collapsed;\n\n    var formattedTime = (0, _helpers.formatTime)(startedTime);\n    var titleCSS = colors.title ? 'color: ' + colors.title(formattedAction) + ';' : null;\n    var title = titleFormatter(formattedAction, formattedTime, took);\n\n    // Render\n    try {\n      if (isCollapsed) {\n        if (colors.title) logger.groupCollapsed('%c ' + title, titleCSS);else logger.groupCollapsed(title);\n      } else {\n        if (colors.title) logger.group('%c ' + title, titleCSS);else logger.group(title);\n      }\n    } catch (e) {\n      logger.log(title);\n    }\n\n    var prevStateLevel = getLogLevel(level, formattedAction, [prevState], 'prevState');\n    var actionLevel = getLogLevel(level, formattedAction, [formattedAction], 'action');\n    var errorLevel = getLogLevel(level, formattedAction, [error, prevState], 'error');\n    var nextStateLevel = getLogLevel(level, formattedAction, [nextState], 'nextState');\n\n    if (prevStateLevel) {\n      if (colors.prevState) logger[prevStateLevel]('%c prev state', 'color: ' + colors.prevState(prevState) + '; font-weight: bold', prevState);else logger[prevStateLevel]('prev state', prevState);\n    }\n\n    if (actionLevel) {\n      if (colors.action) logger[actionLevel]('%c action', 'color: ' + colors.action(formattedAction) + '; font-weight: bold', formattedAction);else logger[actionLevel]('action', formattedAction);\n    }\n\n    if (error && errorLevel) {\n      if (colors.error) logger[errorLevel]('%c error', 'color: ' + colors.error(error, prevState) + '; font-weight: bold', error);else logger[errorLevel]('error', error);\n    }\n\n    if (nextStateLevel) {\n      if (colors.nextState) logger[nextStateLevel]('%c next state', 'color: ' + colors.nextState(nextState) + '; font-weight: bold', nextState);else logger[nextStateLevel]('next state', nextState);\n    }\n\n    if (diff) {\n      (0, _diff2.default)(prevState, nextState, logger, isCollapsed);\n    }\n\n    try {\n      logger.groupEnd();\n    } catch (e) {\n      logger.log('—— log end ——');\n    }\n  });\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/redux-logger/lib/core.js\n ** module id = 55\n ** module chunks = 0\n **/","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = {\n  level: \"log\",\n  logger: console,\n  logErrors: true,\n  collapsed: undefined,\n  predicate: undefined,\n  duration: false,\n  timestamp: true,\n  stateTransformer: function stateTransformer(state) {\n    return state;\n  },\n  actionTransformer: function actionTransformer(action) {\n    return action;\n  },\n  errorTransformer: function errorTransformer(error) {\n    return error;\n  },\n  colors: {\n    title: function title() {\n      return \"inherit\";\n    },\n    prevState: function prevState() {\n      return \"#9E9E9E\";\n    },\n    action: function action() {\n      return \"#03A9F4\";\n    },\n    nextState: function nextState() {\n      return \"#4CAF50\";\n    },\n    error: function error() {\n      return \"#F20404\";\n    }\n  },\n  diff: false,\n  diffPredicate: undefined,\n\n  // Deprecated options\n  transformer: undefined\n};\nmodule.exports = exports['default'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/redux-logger/lib/defaults.js\n ** module id = 56\n ** module chunks = 0\n **/","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = diffLogger;\n\nvar _deepDiff = require('deep-diff');\n\nvar _deepDiff2 = _interopRequireDefault(_deepDiff);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// https://github.com/flitbit/diff#differences\nvar dictionary = {\n  'E': {\n    color: '#2196F3',\n    text: 'CHANGED:'\n  },\n  'N': {\n    color: '#4CAF50',\n    text: 'ADDED:'\n  },\n  'D': {\n    color: '#F44336',\n    text: 'DELETED:'\n  },\n  'A': {\n    color: '#2196F3',\n    text: 'ARRAY:'\n  }\n};\n\nfunction style(kind) {\n  return 'color: ' + dictionary[kind].color + '; font-weight: bold';\n}\n\nfunction render(diff) {\n  var kind = diff.kind;\n  var path = diff.path;\n  var lhs = diff.lhs;\n  var rhs = diff.rhs;\n  var index = diff.index;\n  var item = diff.item;\n\n  switch (kind) {\n    case 'E':\n      return path.join('.') + ' ' + lhs + ' → ' + rhs;\n    case 'N':\n      return path.join('.') + ' ' + rhs;\n    case 'D':\n      return '' + path.join('.');\n    case 'A':\n      return [path.join('.') + '[' + index + ']', item];\n    default:\n      return null;\n  }\n}\n\nfunction diffLogger(prevState, newState, logger, isCollapsed) {\n  var diff = (0, _deepDiff2.default)(prevState, newState);\n\n  try {\n    if (isCollapsed) {\n      logger.groupCollapsed('diff');\n    } else {\n      logger.group('diff');\n    }\n  } catch (e) {\n    logger.log('diff');\n  }\n\n  if (diff) {\n    diff.forEach(function (elem) {\n      var kind = elem.kind;\n\n      var output = render(elem);\n\n      logger.log('%c ' + dictionary[kind].text, style(kind), output);\n    });\n  } else {\n    logger.log('—— no diff ——');\n  }\n\n  try {\n    logger.groupEnd();\n  } catch (e) {\n    logger.log('—— diff end —— ');\n  }\n}\nmodule.exports = exports['default'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/redux-logger/lib/diff.js\n ** module id = 57\n ** module chunks = 0\n **/","'use strict';\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _core = require('./core');\n\nvar _helpers = require('./helpers');\n\nvar _defaults = require('./defaults');\n\nvar _defaults2 = _interopRequireDefault(_defaults);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Creates logger with following options\n *\n * @namespace\n * @param {object} options - options for logger\n * @param {string | function | object} options.level - console[level]\n * @param {boolean} options.duration - print duration of each action?\n * @param {boolean} options.timestamp - print timestamp with each action?\n * @param {object} options.colors - custom colors\n * @param {object} options.logger - implementation of the `console` API\n * @param {boolean} options.logErrors - should errors in action execution be caught, logged, and re-thrown?\n * @param {boolean} options.collapsed - is group collapsed?\n * @param {boolean} options.predicate - condition which resolves logger behavior\n * @param {function} options.stateTransformer - transform state before print\n * @param {function} options.actionTransformer - transform action before print\n * @param {function} options.errorTransformer - transform error before print\n *\n * @returns {function} logger middleware\n */\nfunction createLogger() {\n  var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n  var loggerOptions = _extends({}, _defaults2.default, options);\n\n  var logger = loggerOptions.logger;\n  var transformer = loggerOptions.transformer;\n  var stateTransformer = loggerOptions.stateTransformer;\n  var errorTransformer = loggerOptions.errorTransformer;\n  var predicate = loggerOptions.predicate;\n  var logErrors = loggerOptions.logErrors;\n  var diffPredicate = loggerOptions.diffPredicate;\n\n  // Return if 'console' object is not defined\n\n  if (typeof logger === 'undefined') {\n    return function () {\n      return function (next) {\n        return function (action) {\n          return next(action);\n        };\n      };\n    };\n  }\n\n  if (transformer) {\n    console.error('Option \\'transformer\\' is deprecated, use \\'stateTransformer\\' instead!'); // eslint-disable-line no-console\n  }\n\n  var logBuffer = [];\n\n  return function (_ref) {\n    var getState = _ref.getState;\n    return function (next) {\n      return function (action) {\n        // Exit early if predicate function returns 'false'\n        if (typeof predicate === 'function' && !predicate(getState, action)) {\n          return next(action);\n        }\n\n        var logEntry = {};\n        logBuffer.push(logEntry);\n\n        logEntry.started = _helpers.timer.now();\n        logEntry.startedTime = new Date();\n        logEntry.prevState = stateTransformer(getState());\n        logEntry.action = action;\n\n        var returnedValue = undefined;\n        if (logErrors) {\n          try {\n            returnedValue = next(action);\n          } catch (e) {\n            logEntry.error = errorTransformer(e);\n          }\n        } else {\n          returnedValue = next(action);\n        }\n\n        logEntry.took = _helpers.timer.now() - logEntry.started;\n        logEntry.nextState = stateTransformer(getState());\n\n        var diff = loggerOptions.diff && typeof diffPredicate === 'function' ? diffPredicate(getState, action) : loggerOptions.diff;\n\n        (0, _core.printBuffer)(logBuffer, _extends({}, loggerOptions, { diff: diff }));\n        logBuffer.length = 0;\n\n        if (logEntry.error) throw logEntry.error;\n        return returnedValue;\n      };\n    };\n  };\n}\n\nexports.default = createLogger;\nmodule.exports = exports['default'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/redux-logger/lib/index.js\n ** module id = 58\n ** module chunks = 0\n **/","module.exports = require(\"body-parser\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"body-parser\"\n ** module id = 59\n ** module chunks = 0\n **/","module.exports = require(\"classnames\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"classnames\"\n ** module id = 60\n ** module chunks = 0\n **/","module.exports = require(\"compression\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"compression\"\n ** module id = 61\n ** module chunks = 0\n **/","module.exports = require(\"cookie-parser\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"cookie-parser\"\n ** module id = 62\n ** module chunks = 0\n **/","module.exports = require(\"csurf\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"csurf\"\n ** module id = 63\n ** module chunks = 0\n **/","module.exports = require(\"ejs\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"ejs\"\n ** module id = 64\n ** module chunks = 0\n **/","module.exports = require(\"express-session\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express-session\"\n ** module id = 65\n ** module chunks = 0\n **/","module.exports = require(\"helmet\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"helmet\"\n ** module id = 66\n ** module chunks = 0\n **/","module.exports = require(\"http\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"http\"\n ** module id = 67\n ** module chunks = 0\n **/","module.exports = require(\"morgan\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"morgan\"\n ** module id = 68\n ** module chunks = 0\n **/","module.exports = require(\"secure-filters\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"secure-filters\"\n ** module id = 69\n ** module chunks = 0\n **/","module.exports = require(\"socket.io\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"socket.io\"\n ** module id = 70\n ** module chunks = 0\n **/"],"sourceRoot":""}